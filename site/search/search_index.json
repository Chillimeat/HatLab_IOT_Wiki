{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"\u524d\u8a00 \u00b6 \u7269\u8054\u7f51\uff08IOT\uff09\u5b89\u5168\u77e5\u8bc6\u5e93\u662f\u7531\u5b89\u6052\u6d77\u7279\u5b9e\u9a8c\u5ba4\u6210\u5458\u7ecf\u8fc7\u957f\u671f\u6280\u672f\u6c89\u6dc0\uff0c\u603b\u7ed3\u3001\u6574\u7406\u7684\u4e00\u5957\u5173\u4e8e IOT \u786c\u4ef6\u5b89\u5168\u3001\u56fa\u4ef6\u5b89\u5168\u3001\u4ee5\u53ca\u65e0\u7ebf\u7535\u5b89\u5168\u65b9\u9762\u7684\u5171\u4eab\u77e5\u8bc6\u5e93\u548c\u5de5\u5177\u5e93\u3002 \u5728 IOT \u5b89\u5168\u77e5\u8bc6\u5e93\u4e2d\uff0c\u4f60\u53ef\u4ee5\u4e86\u89e3/\u83b7\u53d6\u5230\uff1a \u00b6 \u8986\u76d6 IOT \u667a\u80fd\u8bbe\u5907\u4e09\u4e2a\u653b\u51fb\u9762\u7684\u5b89\u5168\u77e5\u8bc6\uff1a\u786c\u4ef6\u5b89\u5168\u3001\u56fa\u4ef6\u5b89\u5168\u3001\u65e0\u7ebf\u7535\u5b89\u5168 \u8be6\u7ec6\u7684 IOT \u5b89\u5168\u77e5\u8bc6\u603b\u7ed3\u8981\u70b9 \u4e30\u5bcc\u7684\u653b\u51fb\u5b9e\u4f8b\u548c\u6848\u4f8b \u6709\u5173 IOT \u5b89\u5168\u76f8\u5173\u7684\u6280\u672f\u6587\u7ae0\u3001\u6280\u672f\u8d44\u6599 \u5b9e\u9a8c\u5ba4\u5185\u90e8\u6574\u5408\u3001\u5171\u4eab\u7684 IOT \u5de5\u5177\u5e93 ...","title":"\u57fa\u672c\u4ecb\u7ecd/Intro"},{"location":"#_1","text":"\u7269\u8054\u7f51\uff08IOT\uff09\u5b89\u5168\u77e5\u8bc6\u5e93\u662f\u7531\u5b89\u6052\u6d77\u7279\u5b9e\u9a8c\u5ba4\u6210\u5458\u7ecf\u8fc7\u957f\u671f\u6280\u672f\u6c89\u6dc0\uff0c\u603b\u7ed3\u3001\u6574\u7406\u7684\u4e00\u5957\u5173\u4e8e IOT \u786c\u4ef6\u5b89\u5168\u3001\u56fa\u4ef6\u5b89\u5168\u3001\u4ee5\u53ca\u65e0\u7ebf\u7535\u5b89\u5168\u65b9\u9762\u7684\u5171\u4eab\u77e5\u8bc6\u5e93\u548c\u5de5\u5177\u5e93\u3002","title":"\u524d\u8a00"},{"location":"#iot","text":"\u8986\u76d6 IOT \u667a\u80fd\u8bbe\u5907\u4e09\u4e2a\u653b\u51fb\u9762\u7684\u5b89\u5168\u77e5\u8bc6\uff1a\u786c\u4ef6\u5b89\u5168\u3001\u56fa\u4ef6\u5b89\u5168\u3001\u65e0\u7ebf\u7535\u5b89\u5168 \u8be6\u7ec6\u7684 IOT \u5b89\u5168\u77e5\u8bc6\u603b\u7ed3\u8981\u70b9 \u4e30\u5bcc\u7684\u653b\u51fb\u5b9e\u4f8b\u548c\u6848\u4f8b \u6709\u5173 IOT \u5b89\u5168\u76f8\u5173\u7684\u6280\u672f\u6587\u7ae0\u3001\u6280\u672f\u8d44\u6599 \u5b9e\u9a8c\u5ba4\u5185\u90e8\u6574\u5408\u3001\u5171\u4eab\u7684 IOT \u5de5\u5177\u5e93 ...","title":"\u5728 IOT \u5b89\u5168\u77e5\u8bc6\u5e93\u4e2d\uff0c\u4f60\u53ef\u4ee5\u4e86\u89e3/\u83b7\u53d6\u5230\uff1a"},{"location":"about/","text":"\u6280\u672f\u4ea4\u6d41 \u00b6 \u77e5\u8bc6\u661f\u7403 \u00b6 \u6d77\u7279\u5b9e\u9a8c\u5ba4\u5185\u90e8\u5efa\u7acb\u4e86\u4e00\u4e2a\u4e13\u6ce8\u4e8e IOT \u5b89\u5168\u7684\u77e5\u8bc6\u661f\u7403\uff0c\u5185\u90e8\u5206\u4eab\u4e00\u4e9b\u7269\u8054\u7f51\u76f8\u5173\u7684\u6280\u672f\u8d44\u6599\u548c\u7b2c\u4e09\u65b9\u5b66\u4e60\u8d44\u6e90\uff0c\u4ee5\u53ca\u5b9e\u9a8c\u5ba4\u5728\u8fd1\u4e9b\u5e74\u6765\u5728 IOT \u5b89\u5168\u9886\u57df\u7684\u6280\u672f\u6c89\u6dc0\u3002 \u661f\u7403\u5efa\u7acb\u7684\u76ee\u7684\u662f\u4e3a\u4e86\u8ba9\u66f4\u591a\u6709\u5fd7\u4e8e\u7814\u7a76 IOT \u5b89\u5168\u7684\u5c0f\u4f19\u4f34\u6709\u4e00\u4e2a\u66f4\u52a0\u7d27\u5bc6\u8054\u7cfb\u7684\u5e73\u53f0\u3002 \u52a0\u5165\u4e0d\u9700\u8981\u8d39\u7528\uff0c\u6b22\u8fce\u5927\u5bb6\u524d\u6765\u4ea4\u6d41\uff01 \u5b89\u6052\u4fe1\u606f\u5b89\u5168\u7814\u7a76\u9662\u516c\u4f17\u53f7 \u00b6 \u5b89\u6052\u4fe1\u606f\u5b89\u5168\u7814\u7a76\u9662\u4e8c\u7ef4\u7801\u3002 \u6b64\u516c\u4f17\u53f7\u4e3a\u5b89\u6052\u4fe1\u606f\u5b89\u5168\u7814\u7a76\u9662\u7684\u5b98\u65b9\u8d26\u53f7\uff0c\u7814\u7a76\u9662\u4e0b\u5c5e\u5b9e\u9a8c\u5ba4\u6709\uff1a \u730e\u5f71\u5b9e\u9a8c\u5ba4 \u6d77\u7279\u5b9e\u9a8c\u5ba4 \u536b\u5175\u5b9e\u9a8c\u5ba4 \u516c\u4f17\u53f7\u4e0d\u5b9a\u65f6\u53d1\u5e03\u4e00\u4e9b\u6280\u672f\u5e72\u8d27\u548c\u6280\u672f\u5b66\u4e60\u8d44\u6599\uff0c\u6587\u7ae0\u90fd\u662f\u7531\u5404\u4e2a\u5b89\u5168\u9886\u57df\u5185\u5b9e\u9a8c\u5ba4\u5927\u725b\u5b8c\u6210\u5e76\u6525\u5199\uff0c\u6587\u7ae0\u8d28\u91cf\u90fd\u975e\u5e38\u7684\u9ad8\uff01\u6b22\u8fce\u5927\u5bb6\u5173\u6ce8\u6211\u4eec\uff01 \u5173\u4e8e\u6211\u4eec \u00b6 \u4e86\u89e3\u6211\u4eec \u00b6 \u6d77\u7279\u5b9e\u9a8c\u5ba4\uff08HatLab\uff09\uff0c\u5bd3\u610f\u4e3a \u201cHack AnyThing\u201d\uff0c\u662f\u5b89\u6052\u4fe1\u606f\u5b89\u5168\u7814\u7a76\u9662\u6210\u7acb\u7684\u4e00\u652f\u81f4\u529b\u4e8e IOT \u5b89\u5168\u7814\u7a76\u7684\u56e2\u961f\uff0c\u4e13\u6ce8\u4e8e\u7269\u8054\u7f51\u786c\u4ef6\u3001\u56fa\u4ef6\u3001\u65e0\u7ebf\u7535\u76f8\u5173\u5b89\u5168\u7814\u7a76 \u3002 \u5b9e\u9a8c\u5ba4\u5148\u540e\u53d1\u73b0 Cisco\u3001Juniper\u3001PaloAlto\u3001TP-LINK\u3001GoAhead\u3001Lua \u7b49\u77e5\u540d\u5382\u5546\u4e0e\u76f8\u5173\u901a\u7528 IOT \u7ec4\u4ef6\u7684\u6f0f\u6d1e\u3002\u53c2\u4e0e HITB\u3001ZeroNights\u3001\u5f3a\u7f51\u676f\u3001GeekPwn \u7b49\u56fd\u5185\u5916\u77e5\u540d\u4f1a\u8bae\u548c\u6f14\u8bb2\uff0c\u5e76\u81ea\u4e3b\u7814\u53d1\u591a\u4e2a\u521b\u65b0\u6027\u786c\u4ef6\u8bbe\u5907\u3002 2017 \u5e74 GeekPwn - \u7834\u89e3\u667a\u80fd\u5bb6\u5c45\u3001\u5c0f\u7c73\u5e73\u8861\u8f66 2019 GeekPwn \u540d\u4eba\u5802 - \u4f01\u4e1a\u7ea7\u7f51\u5173\u7684\u6f0f\u6d1e\u5229\u7528 2019 ZeroNight \u4f1a\u8bae - CiscoASA: From Zero to ID=0 \u52a0\u5165\u6211\u4eec \u00b6 \u5b89\u6052\u4fe1\u606f\u5b89\u5168\u7814\u7a76\u9662\u7684\u6280\u672f\u6c1b\u56f4\u6d53\u539a\uff0c\u5404\u79cd\u85aa\u8d44\u5f85\u9047\u3001\u798f\u5229\u90fd\u5f88\u68d2! \u60f3\u8981\u8fdb\u4e00\u6b65\u4e86\u89e3\u6211\u4eec\u6216\u8005\u52a0\u5165\u6211\u4eec\uff0c\u53ef\u4ee5\u8054\u7cfb\u4e0b\u9762\u7684\u90ae\u7bb1\uff0c\u6295\u9012\u7b80\u5386\uff1a double.jiang@dbappsecurity.com.cn","title":"\u5173\u4e8e\u6211\u4eec/About"},{"location":"about/#_1","text":"","title":"\u6280\u672f\u4ea4\u6d41"},{"location":"about/#_2","text":"\u6d77\u7279\u5b9e\u9a8c\u5ba4\u5185\u90e8\u5efa\u7acb\u4e86\u4e00\u4e2a\u4e13\u6ce8\u4e8e IOT \u5b89\u5168\u7684\u77e5\u8bc6\u661f\u7403\uff0c\u5185\u90e8\u5206\u4eab\u4e00\u4e9b\u7269\u8054\u7f51\u76f8\u5173\u7684\u6280\u672f\u8d44\u6599\u548c\u7b2c\u4e09\u65b9\u5b66\u4e60\u8d44\u6e90\uff0c\u4ee5\u53ca\u5b9e\u9a8c\u5ba4\u5728\u8fd1\u4e9b\u5e74\u6765\u5728 IOT \u5b89\u5168\u9886\u57df\u7684\u6280\u672f\u6c89\u6dc0\u3002 \u661f\u7403\u5efa\u7acb\u7684\u76ee\u7684\u662f\u4e3a\u4e86\u8ba9\u66f4\u591a\u6709\u5fd7\u4e8e\u7814\u7a76 IOT \u5b89\u5168\u7684\u5c0f\u4f19\u4f34\u6709\u4e00\u4e2a\u66f4\u52a0\u7d27\u5bc6\u8054\u7cfb\u7684\u5e73\u53f0\u3002 \u52a0\u5165\u4e0d\u9700\u8981\u8d39\u7528\uff0c\u6b22\u8fce\u5927\u5bb6\u524d\u6765\u4ea4\u6d41\uff01","title":"\u77e5\u8bc6\u661f\u7403"},{"location":"about/#_3","text":"\u5b89\u6052\u4fe1\u606f\u5b89\u5168\u7814\u7a76\u9662\u4e8c\u7ef4\u7801\u3002 \u6b64\u516c\u4f17\u53f7\u4e3a\u5b89\u6052\u4fe1\u606f\u5b89\u5168\u7814\u7a76\u9662\u7684\u5b98\u65b9\u8d26\u53f7\uff0c\u7814\u7a76\u9662\u4e0b\u5c5e\u5b9e\u9a8c\u5ba4\u6709\uff1a \u730e\u5f71\u5b9e\u9a8c\u5ba4 \u6d77\u7279\u5b9e\u9a8c\u5ba4 \u536b\u5175\u5b9e\u9a8c\u5ba4 \u516c\u4f17\u53f7\u4e0d\u5b9a\u65f6\u53d1\u5e03\u4e00\u4e9b\u6280\u672f\u5e72\u8d27\u548c\u6280\u672f\u5b66\u4e60\u8d44\u6599\uff0c\u6587\u7ae0\u90fd\u662f\u7531\u5404\u4e2a\u5b89\u5168\u9886\u57df\u5185\u5b9e\u9a8c\u5ba4\u5927\u725b\u5b8c\u6210\u5e76\u6525\u5199\uff0c\u6587\u7ae0\u8d28\u91cf\u90fd\u975e\u5e38\u7684\u9ad8\uff01\u6b22\u8fce\u5927\u5bb6\u5173\u6ce8\u6211\u4eec\uff01","title":"\u5b89\u6052\u4fe1\u606f\u5b89\u5168\u7814\u7a76\u9662\u516c\u4f17\u53f7"},{"location":"about/#_4","text":"","title":"\u5173\u4e8e\u6211\u4eec"},{"location":"about/#_5","text":"\u6d77\u7279\u5b9e\u9a8c\u5ba4\uff08HatLab\uff09\uff0c\u5bd3\u610f\u4e3a \u201cHack AnyThing\u201d\uff0c\u662f\u5b89\u6052\u4fe1\u606f\u5b89\u5168\u7814\u7a76\u9662\u6210\u7acb\u7684\u4e00\u652f\u81f4\u529b\u4e8e IOT \u5b89\u5168\u7814\u7a76\u7684\u56e2\u961f\uff0c\u4e13\u6ce8\u4e8e\u7269\u8054\u7f51\u786c\u4ef6\u3001\u56fa\u4ef6\u3001\u65e0\u7ebf\u7535\u76f8\u5173\u5b89\u5168\u7814\u7a76 \u3002 \u5b9e\u9a8c\u5ba4\u5148\u540e\u53d1\u73b0 Cisco\u3001Juniper\u3001PaloAlto\u3001TP-LINK\u3001GoAhead\u3001Lua \u7b49\u77e5\u540d\u5382\u5546\u4e0e\u76f8\u5173\u901a\u7528 IOT \u7ec4\u4ef6\u7684\u6f0f\u6d1e\u3002\u53c2\u4e0e HITB\u3001ZeroNights\u3001\u5f3a\u7f51\u676f\u3001GeekPwn \u7b49\u56fd\u5185\u5916\u77e5\u540d\u4f1a\u8bae\u548c\u6f14\u8bb2\uff0c\u5e76\u81ea\u4e3b\u7814\u53d1\u591a\u4e2a\u521b\u65b0\u6027\u786c\u4ef6\u8bbe\u5907\u3002 2017 \u5e74 GeekPwn - \u7834\u89e3\u667a\u80fd\u5bb6\u5c45\u3001\u5c0f\u7c73\u5e73\u8861\u8f66 2019 GeekPwn \u540d\u4eba\u5802 - \u4f01\u4e1a\u7ea7\u7f51\u5173\u7684\u6f0f\u6d1e\u5229\u7528 2019 ZeroNight \u4f1a\u8bae - CiscoASA: From Zero to ID=0","title":"\u4e86\u89e3\u6211\u4eec"},{"location":"about/#_6","text":"\u5b89\u6052\u4fe1\u606f\u5b89\u5168\u7814\u7a76\u9662\u7684\u6280\u672f\u6c1b\u56f4\u6d53\u539a\uff0c\u5404\u79cd\u85aa\u8d44\u5f85\u9047\u3001\u798f\u5229\u90fd\u5f88\u68d2! \u60f3\u8981\u8fdb\u4e00\u6b65\u4e86\u89e3\u6211\u4eec\u6216\u8005\u52a0\u5165\u6211\u4eec\uff0c\u53ef\u4ee5\u8054\u7cfb\u4e0b\u9762\u7684\u90ae\u7bb1\uff0c\u6295\u9012\u7b80\u5386\uff1a double.jiang@dbappsecurity.com.cn","title":"\u52a0\u5165\u6211\u4eec"},{"location":"summary/","text":"\u5185\u5bb9\u6982\u8ff0\u3001\u5206\u7c7b \u00b6 \u786c\u4ef6\u5b89\u5168 \u00b6 \u786c\u4ef6\u5b89\u5168\u65b9\u9762\u7684\u57fa\u7840\u77e5\u8bc6\u4ee5\u53ca\u76f8\u5e94\u653b\u51fb\u65b9\u6cd5 \u56fa\u4ef6\u5b89\u5168 \u00b6 \u56fa\u4ef6\u5b89\u5168\u65b9\u9762\u57fa\u7840\u77e5\u8bc6 \u56fa\u4ef6\u6f0f\u6d1e\u7c7b\u578b \u56fa\u4ef6\u5904\u7406\u7684\u6280\u5de7 \u76f8\u5e94\u7684\u6f0f\u6d1e\u5206\u6790\u793a\u4f8b \u65e0\u7ebf\u7535\u5b89\u5168 \u00b6 \u65e0\u7ebf\u7535\u5b89\u5168\u65b9\u9762\u7684\u57fa\u7840\u77e5\u8bc6\u4ee5\u53ca\u76f8\u5e94\u653b\u51fb\u65b9\u6cd5 \u84dd\u7259\u5b89\u5168\u7684\u57fa\u7840\u77e5\u8bc6\u548c\u653b\u9632\u6280\u5de7 zigbee \u5b89\u5168\u7684\u57fa\u7840\u77e5\u8bc6\u548c\u653b\u9632\u6280\u5de7","title":"\u5185\u5bb9\u6982\u8ff0/Summary"},{"location":"summary/#_1","text":"","title":"\u5185\u5bb9\u6982\u8ff0\u3001\u5206\u7c7b"},{"location":"summary/#_2","text":"\u786c\u4ef6\u5b89\u5168\u65b9\u9762\u7684\u57fa\u7840\u77e5\u8bc6\u4ee5\u53ca\u76f8\u5e94\u653b\u51fb\u65b9\u6cd5","title":"\u786c\u4ef6\u5b89\u5168"},{"location":"summary/#_3","text":"\u56fa\u4ef6\u5b89\u5168\u65b9\u9762\u57fa\u7840\u77e5\u8bc6 \u56fa\u4ef6\u6f0f\u6d1e\u7c7b\u578b \u56fa\u4ef6\u5904\u7406\u7684\u6280\u5de7 \u76f8\u5e94\u7684\u6f0f\u6d1e\u5206\u6790\u793a\u4f8b","title":"\u56fa\u4ef6\u5b89\u5168"},{"location":"summary/#_4","text":"\u65e0\u7ebf\u7535\u5b89\u5168\u65b9\u9762\u7684\u57fa\u7840\u77e5\u8bc6\u4ee5\u53ca\u76f8\u5e94\u653b\u51fb\u65b9\u6cd5 \u84dd\u7259\u5b89\u5168\u7684\u57fa\u7840\u77e5\u8bc6\u548c\u653b\u9632\u6280\u5de7 zigbee \u5b89\u5168\u7684\u57fa\u7840\u77e5\u8bc6\u548c\u653b\u9632\u6280\u5de7","title":"\u65e0\u7ebf\u7535\u5b89\u5168"},{"location":"firmware_security/","text":"\u6982\u8ff0 \u00b6 \u56fa\u4ef6\u5b89\u5168\u4e3b\u8981\u7814\u7a76\u7684\u662f\u786c\u4ef6\u8bbe\u5907\u5185\u90e8\u7684\u56fa\u4ef6\uff0c\u901a\u8fc7\u5bf9\u56fa\u4ef6\u4e2d\u7a0b\u5e8f\u7684\u4ee3\u7801\u903b\u8f91\u8fdb\u884c\u9006\u5411\u5206\u6790\uff0c\u4ece\u800c\u4ece\u4e2d\u53d1\u5176\u4e2d\u7684\u5b89\u5168\u95ee\u9898\u3002 \u76ee\u5f55\u4e3b\u8981\u5206\u4e3a\u4ee5\u4e0b\u51e0\u90e8\u5206\u6765\u5f52\u7c7b\uff1a \u56fa\u4ef6\u7684\u83b7\u53d6 \u56fa\u4ef6\u7684\u5904\u7406 \u56fa\u4ef6\u7684\u6f0f\u6d1e\u5206\u6790\u548c\u6316\u6398 \u56fa\u4ef6\u5b89\u5168\u5b9e\u4f8b","title":"\u6982\u8ff0"},{"location":"firmware_security/#_1","text":"\u56fa\u4ef6\u5b89\u5168\u4e3b\u8981\u7814\u7a76\u7684\u662f\u786c\u4ef6\u8bbe\u5907\u5185\u90e8\u7684\u56fa\u4ef6\uff0c\u901a\u8fc7\u5bf9\u56fa\u4ef6\u4e2d\u7a0b\u5e8f\u7684\u4ee3\u7801\u903b\u8f91\u8fdb\u884c\u9006\u5411\u5206\u6790\uff0c\u4ece\u800c\u4ece\u4e2d\u53d1\u5176\u4e2d\u7684\u5b89\u5168\u95ee\u9898\u3002 \u76ee\u5f55\u4e3b\u8981\u5206\u4e3a\u4ee5\u4e0b\u51e0\u90e8\u5206\u6765\u5f52\u7c7b\uff1a \u56fa\u4ef6\u7684\u83b7\u53d6 \u56fa\u4ef6\u7684\u5904\u7406 \u56fa\u4ef6\u7684\u6f0f\u6d1e\u5206\u6790\u548c\u6316\u6398 \u56fa\u4ef6\u5b89\u5168\u5b9e\u4f8b","title":"\u6982\u8ff0"},{"location":"wireless_security/bluetooth_security/base_intro/Active_Scanning_vs_Passive_Scanning/","text":"Sourcell@\u6d77\u7279\u5b9e\u9a8c\u5ba4 BLE (Bluetooth Low Energy) \u8bbe\u5907\u53ef\u4ee5\u901a\u8fc7\u626b\u63cf\u53d1\u73b0\u5468\u56f4\u7684\u5176\u4ed6 BLE \u8bbe\u5907\u3002\u5f53 BLE \u8bbe\u5907\u6267\u884c\u626b\u63cf\u65f6\u4fbf\u5904\u5728 scanning state\u3002\u8be5\u72b6\u6001\u662f BLE \u8bbe\u5907\u5728 LL (Link Layer) \u7684\u72b6\u6001\u4e4b\u4e00\u3002\u5b83\u4e0e\u5176\u4ed6\u51e0\u79cd LL \u72b6\u6001\u6784\u6210\u4e86\u5982\u4e0b\u72b6\u6001\u673a\uff1a \u5904\u4e8e scanning state \u7684 BLE \u8bbe\u5907\u88ab\u79f0\u4e3a scanner\u3002\u5bf9\u5e94\u7684\uff0c\u5f53 BLE \u8bbe\u5907\u60f3\u8ba9\u5176\u4ed6\u8bbe\u5907\u53d1\u73b0\u81ea\u5df1\u65f6\u4f1a\u5904\u5728 advertising state\u3002\u6b64\u65f6 BLE \u8bbe\u5907\u88ab\u79f0\u4e3a advertiser\u3002 Scanning Type \u00b6 BLE \u8bbe\u5907\u4e3b\u8981\u53ef\u6267\u884c\u4e24\u79cd\u626b\u63cf active scanning \u548c passive scanning\uff08\u66f4\u590d\u6742\u7684\u626b\u63cf\u60c5\u51b5\u53ef\u53c2\u8003 ref 2\uff09\u3002\u5177\u4f53\u4f7f\u7528\u4f55\u79cd\u626b\u63cf\u65b9\u5f0f\u7531 HCI_LE_Set_Scan_Parameters command \u63a7\u5236\u3002\u8be5\u547d\u4ee4\u4e2d\u6709\u4e00\u4e2a LE_Scan_Type \u53c2\u6570\uff0c\u5f53\u8bbe\u4e3a 0x00 \u65f6\u6267\u884c passive scanning\uff1a Bluetooth HCI Command - LE Set Scan Parameters Command Opcode: LE Set Scan Parameters (0x200b) Parameter Total Length: 7 Scan Type: Passive (0x00) Scan Interval: 16 (10 msec) Scan Window: 16 (10 msec) Own Address Type: Public Device Address (0x00) Scan Filter Policy: Accept all advertisements, except directed advertisements not addressed to this device (0x00) \u5f53\u8bbe\u4e3a 0x01 \u65f6\u6267\u884c active scanning\uff1a Bluetooth HCI Command - LE Set Scan Parameters Command Opcode: LE Set Scan Parameters (0x200b) Parameter Total Length: 7 Scan Type: Active (0x01) Scan Interval: 16 (10 msec) Scan Window: 16 (10 msec) Own Address Type: Public Device Address (0x00) Scan Filter Policy: Accept all advertisements, except directed advertisements not addressed to this device (0x00) [Response in frame: 2] [Command-Response Delta: 1.784ms] \u5176\u4ed6\u7684\u503c\u76ee\u524d\u5747\u88ab\u4fdd\u7559\u3002 HCI_LE_Set_Scan_Parameters command \u53ea\u662f\u914d\u7f6e\u4e86\u626b\u63cf\u7684\u53c2\u6570\uff0c\u8981\u771f\u6b63\u5f00\u59cb\u626b\u63cf\u8fd8\u9700\u8981\u53d1\u9001 HCI_LE_Set_Scan_Enable command\uff1a Bluetooth HCI Command - LE Set Scan Enable Command Opcode: LE Set Scan Enable (0x200c) Parameter Total Length: 2 Scan Enable: true (0x01) Filter Duplicates: true (0x01) Passive scanning \u7684\u6570\u636e\u6d41\u5982\u4e0b[3]\uff1a Active scanning \u7684\u6570\u636e\u6d41\u5982\u4e0b[4]\uff1a Active Scanning \u4e0e Passive Scanning \u7684\u9690\u853d\u6027 \u00b6 \u5bf9\u4e8e passive scanning\uff0c\u5b83\u4ec5\u5728 LL \u4e0a\u5b89\u9759\u5730\u63a5\u6536\u7a7a\u4e2d\u98d8\u8fc7\u7684\u5404\u79cd advertising PDUs\uff0c\u7edd\u4e0d\u4f1a\u4e3b\u52a8\u53d1\u9001\u5176\u4ed6\u6570\u636e\u3002\u56e0\u6b64 passive scanning \u5f88\u9690\u853d\uff0c\u4e0d\u4f1a\u66b4\u9732 scanner \u7684\u4efb\u4f55\u4fe1\u606f\u3002 \u5bf9\u4e8e active scanning\uff0c\u5b83\u9664\u4e86\u50cf passive scanning \u4e00\u6837\u63a5\u6536\u7a7a\u4e2d\u7684 advertising PDUs\uff0c\u8fd8\u4f1a\u4e3b\u52a8\u5411 advertiser \u53d1\u9001 SCAN_REQ PDU\uff0c\u7136\u540e\u63a5\u6536 advertiser \u54cd\u5e94\u7684 SCAN_RSP PDU\uff0c\u4ece\u800c\u83b7\u53d6 advertiser \u66f4\u591a\u7684\u4fe1\u606f\uff1a \u4e0d\u8fc7 SCAN_REQ PDU \u4f1a\u643a\u5e26 scanner \u7684 address\uff0c\u5373\u4e0a\u56fe\u4e2d\u7684 ScanA \u5b57\u6bb5\u3002\u8fd9\u53ef\u80fd\u4f1a\u66b4\u9732 scanner \u7684\u8eab\u4efd\u3002\u56e0\u6b64\u5728\u6267\u884c active scanning \u65f6\uff0c\u6211\u4eec\u6700\u597d\u4f7f\u7528 spooftooph \u4f2a\u9020\u81ea\u5df1\u7684 BD_ADDR\uff0c\u9632\u6b62\u771f\u5b9e BD_ADDR \u88ab\u66b4\u9732\u3002 \u89e3\u6790\u626b\u63cf\u7ed3\u679c \u00b6 \u4e0d\u8bba\u662f active scanning \u8fd8\u662f passive scanning\uff0c\u626b\u63cf\u7684\u7ed3\u679c\u5747\u4ee5 HCI_LE_Advertising_Report event \u7684\u5f62\u5f0f\u8fd4\u56de\u7ed9 host\u3002\u8be5 event \u643a\u5e26\u7684 Event_Type parameter \u6709\u5982\u4e0b 5 \u79cd\u53d6\u503c[5]\uff0c\u8bf4\u660e\u4e86\u626b\u63cf\u7ed3\u679c\u6765\u81ea\u4e8e\u54ea\u4e00\u79cd advertising PDU\uff1a Value Description 0x00 ADV_IND PDU 0x01 ADV_DIRECT_IND PDU 0x02 ADV_SCAN_IND PDU 0x03 ADV_NONCONN_IND PDU 0x04 SCAN_RSP PDU All other values RFU \u5bf9\u4e8e\u8fd4\u56de\u7684\u7ed3\u679c\uff0cpassive scanning \u4e0e active scanning \u7684\u533a\u522b\u4f53\u73b0\u5728 SCAN_RSP PDU \u4e0a\u3002Active scanning \u6709\u80fd\u529b\u8fd4\u56de SCAN_RSP PDU\uff0c\u800c passive scanning \u4e0d\u53ef\u80fd\u8fd4\u56de SCAN_RSP PDU\u3002 \u5177\u4f53\u626b\u63cf\u5f97\u5230\u7684\u6570\u636e\u5b58\u50a8\u5728 Data \u53c2\u6570\u4e2d\u3002\u8be5\u53c2\u6570\u4e5f\u6709\u534f\u8bae\u5b9a\u4e49\u7684\u683c\u5f0f\uff0c\u7b80\u5355\u7684\u8bf4\u5b83\u662f\u4e00\u4e2a AD (Advertising Data) structure \u6570\u7ec4\u3002AD structure \u7684\u683c\u5f0f\u5982\u4e0b[6]\uff1a +--------+-------------------+ | Length | Data | +--------+-------------------+ | AD Type | AD Data | +-------------------+ \u5176\u4e2d AD Type \u7684\u542b\u4e49\u7531 GAP (Generic Access Profile) \u5b9a\u4e49\u3002 \u8fd9\u91cc\u4e3e\u4e24\u4e2a\u4f8b\u5b50\u3002\u6bd4\u5982 passive scanning \u8fd4\u56de\u7684\u626b\u63cf\u7ed3\u679c\u5982\u4e0b\uff1a Bluetooth HCI Event - LE Meta Event Code: LE Meta (0x3e) Parameter Total Length: 30 Sub Event: LE Advertising Report (0x02) Num Reports: 1 Event Type: Connectable Undirected Advertising (0x00) Peer Address Type: Public Device Address (0x00) BD_ADDR: Espressi_9c:07:06 (24:0a:c4:9c:07:06) Data Length: 18 Advertising Data Flags Length: 2 Type: Flags (0x01) 1. .... = Reserved: 0x0 ...0 .... = Simultaneous LE and BR/EDR to Same Device Capable (Host): false (0x0) .... 0... = Simultaneous LE and BR/EDR to Same Device Capable (Controller): false (0x0) .... .1.. = BR/EDR Not Supported: true (0x1) .... ..1. = LE General Discoverable Mode: true (0x1) .... ...0 = LE Limited Discoverable Mode: false (0x0) Tx Power Level Length: 2 Type: Tx Power Level (0x0a) Power Level (dBm): -21 16-bit Service Class UUIDs Length: 3 Type: 16-bit Service Class UUIDs (0x03) UUID 16: Unknown (0x00ff) Device Name: BLECTF Length: 7 Type: Device Name (0x09) Device Name: BLECTF RSSI: -65dBm \u518d\u6bd4\u5982 Active scanning \u56e0 SCAN_RSP PDU \u8fd4\u56de\u626b\u63cf\u7ed3\u679c\u5982\u4e0b\uff1a Bluetooth HCI Event - LE Meta Event Code: LE Meta (0x3e) Parameter Total Length: 22 Sub Event: LE Advertising Report (0x02) Num Reports: 1 Event Type: Scan Response (0x04) Peer Address Type: Public Device Address (0x00) BD_ADDR: Espressi_9c:07:06 (24:0a:c4:9c:07:06) Data Length: 10 Advertising Data Flags Length: 2 Type: Flags (0x01) 1. .... = Reserved: 0x0 ...0 .... = Simultaneous LE and BR/EDR to Same Device Capable (Host): false (0x0) .... 0... = Simultaneous LE and BR/EDR to Same Device Capable (Controller): false (0x0) .... .1.. = BR/EDR Not Supported: true (0x1) .... ..1. = LE General Discoverable Mode: true (0x1) .... ...0 = LE Limited Discoverable Mode: false (0x0) Tx Power Level Length: 2 Type: Tx Power Level (0x0a) Power Level (dBm): -21 16-bit Service Class UUIDs Length: 3 Type: 16-bit Service Class UUIDs (0x03) UUID 16: Unknown (0x00ff) RSSI: -68dBm \u5b9e\u6218\u4e2d Active Scanning \u4e0d\u4e00\u5b9a\u6bd4 Passive Scanning \u66f4\u6709\u6548 \u00b6 \u5728\u60c5\u62a5\u6536\u96c6\u9636\u6bb5\uff0c\u6211\u4eec\u5f88\u5173\u5fc3\u76ee\u6807\u8bbe\u5907\u7684\u540d\u5b57\u3002\u4f46\u662f\u5382\u5546\u7ed9\u51fa\u8bbe\u5907\u540d\u79f0\u7684\u4f4d\u7f6e\u662f\u4e0d\u786e\u5b9a\u7684\u3002\u8bbe\u5907\u540d\u79f0\u53ef\u80fd\u4f4d\u4e8e advertising data \u4e5f\u53ef\u80fd\u4f4d\u4e8e scan response data\u3002\u56e0\u6b64\u6709\u65f6\u4f7f\u7528 passive scanning \u4e5f\u80fd\u83b7\u53d6\u76ee\u6807\u8bbe\u5907\u7684\u540d\u5b57\u3002 \u53e6\u5916\uff0c\u5382\u5546\u4e0d\u4e00\u5b9a\u4f7f\u7528 GAP \u5b9a\u4e49\u7684 AD Type 0x09 (Complete Local Name) \u6765\u5b58\u50a8\u8bbe\u5907\u7684\u540d\u5b57\u3002\u56e0\u4e3a GAP \u8fd8\u5b9a\u4e49\u4e86 AD Type 0xFF (Manufacturer Specific Data)\uff0c\u5382\u5546\u4e5f\u53ef\u80fd\u628a\u8bbe\u5907\u7684\u540d\u5b57\u653e\u5728\u5176\u4e2d\u5e76\u5b9a\u4e49\u81ea\u5df1\u7684\u89e3\u6790\u89c4\u5219\u3002 \u56e0\u6b64\u5728\u65e0\u6cd5\u4f2a\u88c5 BD_ADDR \u65f6\uff0c\u53ef\u4ee5\u76f4\u63a5\u8bd5\u8bd5 passive scanning \u80fd\u5426\u89e3\u51b3\u95ee\u9898\u3002 References \u00b6 BLUETOOTH CORE SPECIFICATION Version 5.2 | Vol 6, Part B page 2857, Figure 1.1: State diagram of the Link Layer state machine BLUETOOTH CORE SPECIFICATION Version 5.2 | Vol 6, Part D page 3114, 4 SCANNING STATE BLUETOOTH CORE SPECIFICATION Version 5.2 | Vol 6, Part D page 3114, 4.1 PASSIVE SCANNING BLUETOOTH CORE SPECIFICATION Version 5.2 | Vol 6, Part D page 3115, 4.2 ACTIVE SCANNING BLUETOOTH CORE SPECIFICATION Version 5.2 | Vol 4, Part E page 2382, 7.7.65.2 LE Advertising Report event BLUETOOTH CORE SPECIFICATION Version 5.2 | Vol 3, Part C page 1392, BLUETOOTH CORE SPECIFICATION Version 5.2 | Vol 3, Part C page 1392 Assigned numbers and GAP","title":"\u4e3b\u52a8\u626b\u63cf\u548c\u88ab\u52a8\u626b\u63cf"},{"location":"wireless_security/bluetooth_security/base_intro/Active_Scanning_vs_Passive_Scanning/#scanning-type","text":"BLE \u8bbe\u5907\u4e3b\u8981\u53ef\u6267\u884c\u4e24\u79cd\u626b\u63cf active scanning \u548c passive scanning\uff08\u66f4\u590d\u6742\u7684\u626b\u63cf\u60c5\u51b5\u53ef\u53c2\u8003 ref 2\uff09\u3002\u5177\u4f53\u4f7f\u7528\u4f55\u79cd\u626b\u63cf\u65b9\u5f0f\u7531 HCI_LE_Set_Scan_Parameters command \u63a7\u5236\u3002\u8be5\u547d\u4ee4\u4e2d\u6709\u4e00\u4e2a LE_Scan_Type \u53c2\u6570\uff0c\u5f53\u8bbe\u4e3a 0x00 \u65f6\u6267\u884c passive scanning\uff1a Bluetooth HCI Command - LE Set Scan Parameters Command Opcode: LE Set Scan Parameters (0x200b) Parameter Total Length: 7 Scan Type: Passive (0x00) Scan Interval: 16 (10 msec) Scan Window: 16 (10 msec) Own Address Type: Public Device Address (0x00) Scan Filter Policy: Accept all advertisements, except directed advertisements not addressed to this device (0x00) \u5f53\u8bbe\u4e3a 0x01 \u65f6\u6267\u884c active scanning\uff1a Bluetooth HCI Command - LE Set Scan Parameters Command Opcode: LE Set Scan Parameters (0x200b) Parameter Total Length: 7 Scan Type: Active (0x01) Scan Interval: 16 (10 msec) Scan Window: 16 (10 msec) Own Address Type: Public Device Address (0x00) Scan Filter Policy: Accept all advertisements, except directed advertisements not addressed to this device (0x00) [Response in frame: 2] [Command-Response Delta: 1.784ms] \u5176\u4ed6\u7684\u503c\u76ee\u524d\u5747\u88ab\u4fdd\u7559\u3002 HCI_LE_Set_Scan_Parameters command \u53ea\u662f\u914d\u7f6e\u4e86\u626b\u63cf\u7684\u53c2\u6570\uff0c\u8981\u771f\u6b63\u5f00\u59cb\u626b\u63cf\u8fd8\u9700\u8981\u53d1\u9001 HCI_LE_Set_Scan_Enable command\uff1a Bluetooth HCI Command - LE Set Scan Enable Command Opcode: LE Set Scan Enable (0x200c) Parameter Total Length: 2 Scan Enable: true (0x01) Filter Duplicates: true (0x01) Passive scanning \u7684\u6570\u636e\u6d41\u5982\u4e0b[3]\uff1a Active scanning \u7684\u6570\u636e\u6d41\u5982\u4e0b[4]\uff1a","title":"Scanning Type"},{"location":"wireless_security/bluetooth_security/base_intro/Active_Scanning_vs_Passive_Scanning/#active-scanning-passive-scanning","text":"\u5bf9\u4e8e passive scanning\uff0c\u5b83\u4ec5\u5728 LL \u4e0a\u5b89\u9759\u5730\u63a5\u6536\u7a7a\u4e2d\u98d8\u8fc7\u7684\u5404\u79cd advertising PDUs\uff0c\u7edd\u4e0d\u4f1a\u4e3b\u52a8\u53d1\u9001\u5176\u4ed6\u6570\u636e\u3002\u56e0\u6b64 passive scanning \u5f88\u9690\u853d\uff0c\u4e0d\u4f1a\u66b4\u9732 scanner \u7684\u4efb\u4f55\u4fe1\u606f\u3002 \u5bf9\u4e8e active scanning\uff0c\u5b83\u9664\u4e86\u50cf passive scanning \u4e00\u6837\u63a5\u6536\u7a7a\u4e2d\u7684 advertising PDUs\uff0c\u8fd8\u4f1a\u4e3b\u52a8\u5411 advertiser \u53d1\u9001 SCAN_REQ PDU\uff0c\u7136\u540e\u63a5\u6536 advertiser \u54cd\u5e94\u7684 SCAN_RSP PDU\uff0c\u4ece\u800c\u83b7\u53d6 advertiser \u66f4\u591a\u7684\u4fe1\u606f\uff1a \u4e0d\u8fc7 SCAN_REQ PDU \u4f1a\u643a\u5e26 scanner \u7684 address\uff0c\u5373\u4e0a\u56fe\u4e2d\u7684 ScanA \u5b57\u6bb5\u3002\u8fd9\u53ef\u80fd\u4f1a\u66b4\u9732 scanner \u7684\u8eab\u4efd\u3002\u56e0\u6b64\u5728\u6267\u884c active scanning \u65f6\uff0c\u6211\u4eec\u6700\u597d\u4f7f\u7528 spooftooph \u4f2a\u9020\u81ea\u5df1\u7684 BD_ADDR\uff0c\u9632\u6b62\u771f\u5b9e BD_ADDR \u88ab\u66b4\u9732\u3002","title":"Active Scanning \u4e0e Passive Scanning \u7684\u9690\u853d\u6027"},{"location":"wireless_security/bluetooth_security/base_intro/Active_Scanning_vs_Passive_Scanning/#_1","text":"\u4e0d\u8bba\u662f active scanning \u8fd8\u662f passive scanning\uff0c\u626b\u63cf\u7684\u7ed3\u679c\u5747\u4ee5 HCI_LE_Advertising_Report event \u7684\u5f62\u5f0f\u8fd4\u56de\u7ed9 host\u3002\u8be5 event \u643a\u5e26\u7684 Event_Type parameter \u6709\u5982\u4e0b 5 \u79cd\u53d6\u503c[5]\uff0c\u8bf4\u660e\u4e86\u626b\u63cf\u7ed3\u679c\u6765\u81ea\u4e8e\u54ea\u4e00\u79cd advertising PDU\uff1a Value Description 0x00 ADV_IND PDU 0x01 ADV_DIRECT_IND PDU 0x02 ADV_SCAN_IND PDU 0x03 ADV_NONCONN_IND PDU 0x04 SCAN_RSP PDU All other values RFU \u5bf9\u4e8e\u8fd4\u56de\u7684\u7ed3\u679c\uff0cpassive scanning \u4e0e active scanning \u7684\u533a\u522b\u4f53\u73b0\u5728 SCAN_RSP PDU \u4e0a\u3002Active scanning \u6709\u80fd\u529b\u8fd4\u56de SCAN_RSP PDU\uff0c\u800c passive scanning \u4e0d\u53ef\u80fd\u8fd4\u56de SCAN_RSP PDU\u3002 \u5177\u4f53\u626b\u63cf\u5f97\u5230\u7684\u6570\u636e\u5b58\u50a8\u5728 Data \u53c2\u6570\u4e2d\u3002\u8be5\u53c2\u6570\u4e5f\u6709\u534f\u8bae\u5b9a\u4e49\u7684\u683c\u5f0f\uff0c\u7b80\u5355\u7684\u8bf4\u5b83\u662f\u4e00\u4e2a AD (Advertising Data) structure \u6570\u7ec4\u3002AD structure \u7684\u683c\u5f0f\u5982\u4e0b[6]\uff1a +--------+-------------------+ | Length | Data | +--------+-------------------+ | AD Type | AD Data | +-------------------+ \u5176\u4e2d AD Type \u7684\u542b\u4e49\u7531 GAP (Generic Access Profile) \u5b9a\u4e49\u3002 \u8fd9\u91cc\u4e3e\u4e24\u4e2a\u4f8b\u5b50\u3002\u6bd4\u5982 passive scanning \u8fd4\u56de\u7684\u626b\u63cf\u7ed3\u679c\u5982\u4e0b\uff1a Bluetooth HCI Event - LE Meta Event Code: LE Meta (0x3e) Parameter Total Length: 30 Sub Event: LE Advertising Report (0x02) Num Reports: 1 Event Type: Connectable Undirected Advertising (0x00) Peer Address Type: Public Device Address (0x00) BD_ADDR: Espressi_9c:07:06 (24:0a:c4:9c:07:06) Data Length: 18 Advertising Data Flags Length: 2 Type: Flags (0x01) 1. .... = Reserved: 0x0 ...0 .... = Simultaneous LE and BR/EDR to Same Device Capable (Host): false (0x0) .... 0... = Simultaneous LE and BR/EDR to Same Device Capable (Controller): false (0x0) .... .1.. = BR/EDR Not Supported: true (0x1) .... ..1. = LE General Discoverable Mode: true (0x1) .... ...0 = LE Limited Discoverable Mode: false (0x0) Tx Power Level Length: 2 Type: Tx Power Level (0x0a) Power Level (dBm): -21 16-bit Service Class UUIDs Length: 3 Type: 16-bit Service Class UUIDs (0x03) UUID 16: Unknown (0x00ff) Device Name: BLECTF Length: 7 Type: Device Name (0x09) Device Name: BLECTF RSSI: -65dBm \u518d\u6bd4\u5982 Active scanning \u56e0 SCAN_RSP PDU \u8fd4\u56de\u626b\u63cf\u7ed3\u679c\u5982\u4e0b\uff1a Bluetooth HCI Event - LE Meta Event Code: LE Meta (0x3e) Parameter Total Length: 22 Sub Event: LE Advertising Report (0x02) Num Reports: 1 Event Type: Scan Response (0x04) Peer Address Type: Public Device Address (0x00) BD_ADDR: Espressi_9c:07:06 (24:0a:c4:9c:07:06) Data Length: 10 Advertising Data Flags Length: 2 Type: Flags (0x01) 1. .... = Reserved: 0x0 ...0 .... = Simultaneous LE and BR/EDR to Same Device Capable (Host): false (0x0) .... 0... = Simultaneous LE and BR/EDR to Same Device Capable (Controller): false (0x0) .... .1.. = BR/EDR Not Supported: true (0x1) .... ..1. = LE General Discoverable Mode: true (0x1) .... ...0 = LE Limited Discoverable Mode: false (0x0) Tx Power Level Length: 2 Type: Tx Power Level (0x0a) Power Level (dBm): -21 16-bit Service Class UUIDs Length: 3 Type: 16-bit Service Class UUIDs (0x03) UUID 16: Unknown (0x00ff) RSSI: -68dBm","title":"\u89e3\u6790\u626b\u63cf\u7ed3\u679c"},{"location":"wireless_security/bluetooth_security/base_intro/Active_Scanning_vs_Passive_Scanning/#active-scanning-passive-scanning_1","text":"\u5728\u60c5\u62a5\u6536\u96c6\u9636\u6bb5\uff0c\u6211\u4eec\u5f88\u5173\u5fc3\u76ee\u6807\u8bbe\u5907\u7684\u540d\u5b57\u3002\u4f46\u662f\u5382\u5546\u7ed9\u51fa\u8bbe\u5907\u540d\u79f0\u7684\u4f4d\u7f6e\u662f\u4e0d\u786e\u5b9a\u7684\u3002\u8bbe\u5907\u540d\u79f0\u53ef\u80fd\u4f4d\u4e8e advertising data \u4e5f\u53ef\u80fd\u4f4d\u4e8e scan response data\u3002\u56e0\u6b64\u6709\u65f6\u4f7f\u7528 passive scanning \u4e5f\u80fd\u83b7\u53d6\u76ee\u6807\u8bbe\u5907\u7684\u540d\u5b57\u3002 \u53e6\u5916\uff0c\u5382\u5546\u4e0d\u4e00\u5b9a\u4f7f\u7528 GAP \u5b9a\u4e49\u7684 AD Type 0x09 (Complete Local Name) \u6765\u5b58\u50a8\u8bbe\u5907\u7684\u540d\u5b57\u3002\u56e0\u4e3a GAP \u8fd8\u5b9a\u4e49\u4e86 AD Type 0xFF (Manufacturer Specific Data)\uff0c\u5382\u5546\u4e5f\u53ef\u80fd\u628a\u8bbe\u5907\u7684\u540d\u5b57\u653e\u5728\u5176\u4e2d\u5e76\u5b9a\u4e49\u81ea\u5df1\u7684\u89e3\u6790\u89c4\u5219\u3002 \u56e0\u6b64\u5728\u65e0\u6cd5\u4f2a\u88c5 BD_ADDR \u65f6\uff0c\u53ef\u4ee5\u76f4\u63a5\u8bd5\u8bd5 passive scanning \u80fd\u5426\u89e3\u51b3\u95ee\u9898\u3002","title":"\u5b9e\u6218\u4e2d Active Scanning \u4e0d\u4e00\u5b9a\u6bd4 Passive Scanning \u66f4\u6709\u6548"},{"location":"wireless_security/bluetooth_security/base_intro/Active_Scanning_vs_Passive_Scanning/#references","text":"BLUETOOTH CORE SPECIFICATION Version 5.2 | Vol 6, Part B page 2857, Figure 1.1: State diagram of the Link Layer state machine BLUETOOTH CORE SPECIFICATION Version 5.2 | Vol 6, Part D page 3114, 4 SCANNING STATE BLUETOOTH CORE SPECIFICATION Version 5.2 | Vol 6, Part D page 3114, 4.1 PASSIVE SCANNING BLUETOOTH CORE SPECIFICATION Version 5.2 | Vol 6, Part D page 3115, 4.2 ACTIVE SCANNING BLUETOOTH CORE SPECIFICATION Version 5.2 | Vol 4, Part E page 2382, 7.7.65.2 LE Advertising Report event BLUETOOTH CORE SPECIFICATION Version 5.2 | Vol 3, Part C page 1392, BLUETOOTH CORE SPECIFICATION Version 5.2 | Vol 3, Part C page 1392 Assigned numbers and GAP","title":"References"},{"location":"wireless_security/bluetooth_security/base_intro/Class_of_Device/","text":"Sourcell@\u6d77\u7279\u5b9e\u9a8c\u5ba4 Class of device\uff0c\u7b80\u79f0 CoD\uff0c\u7528\u4e8e\u63cf\u8ff0\u4e00\u4e2a BR/EDR \u8bbe\u5907\u7684\u7c7b\u578b\u3002 \u672c\u5730\u8bbe\u5907\u53d1\u8d77 inquiry ( HCI_Inquiry command) \u540e\uff0c\u8fdc\u7aef\u5904\u4e8e inquiry scan \u72b6\u6001\u7684\u8bbe\u5907\u4f1a\u54cd\u5e94\u4e00\u4e9b\u57fa\u672c\u6570\u636e\u3002\u8fd9\u4e9b\u6570\u636e\u88ab controller \u5c01\u88c5\u5728 event \u4e2d\u8fd4\u56de\u7ed9 host\u3002CoD \u5219\u662f\u8fd9\u4e9b event \u4e2d\u7684\u4e00\u4e2a\u53c2\u6570\u3002\u6b64\u65f6\u5305\u542b\u53ef\u80fd CoD \u7684 event \u5982\u4e0b\uff1a HCI_Inquiry_Result event HCI_Inquiry_Result_with_RSSI event HCI_Extended_Inquiry_Result event \u53e6\u5916\u5f53\u672c\u5730\u8bbe\u5907\u6536\u5230\u8fdc\u7aef\u8bbe\u5907\u7684\u8fde\u63a5\u8bf7\u6c42\u65f6\uff0c\u5c06\u6536\u5230 HCI_Connection_Request event\u3002\u8be5 event \u4e5f\u4f1a\u643a\u5e26 CoD\u3002 \u89e3\u6790 CoD \u7ed3\u6784 \u00b6 CoD \u7684\u683c\u5f0f\u662f\u53ef\u53d8\u7684\uff0c\u5177\u4f53\u7684\u683c\u5f0f\u7531 Format Type \u5b57\u6bb5\u6307\u5b9a\u3002\u5176\u4e2d\u6700\u5e38\u89c1\u7684\u683c\u5f0f\u662f \"format #1\"\uff0c\u4e14\u5176\u4ed6\u683c\u5f0f\u6781\u5176\u7f55\u89c1\u3002\u6b64\u65f6 CoD \u662f\u4e00\u4e2a\u5927\u5c0f\u4e3a 3 bytes \u7684\u6570\u503c\uff0c\u5b83\u7684\u7ed3\u6784\u5982\u4e0b\u56fe\u6240\u793a\uff081st byte \u4e3a\u6700\u9ad8\u5b57\u8282\uff09\uff1a \u4e0b\u9762\u5c06\u5206\u522b\u89e3\u91ca\u7ec4\u6210 CoD \u7684 3 \u4e2a\u4e3b\u8981\u5b57\u6bb5 Service Class, Major Device Class \u4e0e Minor Device Class\u3002 Service Class \u00b6 \u4e0b\u9762\u4e3a 0 \u7684\u4f4d\u88ab\u4fdd\u7559\u4f7f\u7528 Flag Description Example 1... .... 00. Information WEB-server, WAP-server .1.. .... 00. Telephony Cordless telephony, Modem, Headset service ..1. .... 00. Audio Speaker, Microphone, Headset service ...1 .... 00. Object Transfer v-Inbox, v-Folder .... 1... 00. Capturing Scanner, Microphone .... .1.. 00. Rendering Printing, Speaker .... ..1. 00. Networking LAN, Ad hoc .... ...1 00. Positioning Location identification .... .... 001 Limited Discoverable Mode Major Device Class \u00b6 Value Description Example 0b00000 Miscellaneous 0b00001 Computer Desktop, Notebook, PDA, Organizers 0b00010 Phone Cellular, Cordless, Payphone, Modem 0b00011 LAN /Network Access point 0b00100 Audio/Video Headset, Speaker, Stereo, Video display, VCR 0b00101 Peripheral (HID) Mouse, Joystick, Keyboards 0b00110 Imaging Printing, Scanner, Camera, Display 0b00111 Wearable 0b01000 Toy 0b01001 Health 0b11111 Uncategorized Others Reserved Minor Device Class \u00b6 \u8be5\u5b57\u6bb5\u867d\u7136\u4ec5\u5360\u7528 8 bits\uff0c\u4f46\u662f\u5f53 major device class \u4e0d\u540c\u65f6\uff0c\u6bcf\u4e2a bit \u7684\u542b\u4e49\u4e5f\u4e0d\u540c\u3002\u56e0\u6b64\u8be5\u5b57\u6bb5\u7684\u5b9a\u4e49\u5f88\u7e41\u6742\uff0c\u4e0d\u5728\u8fd9\u91cc\u8d58\u8ff0\u3002\u5177\u4f53\u53ef\u4ee5\u53c2\u8003 ref [1]\u3002 \u4e00\u4e2a\u89e3\u6790 CoD \u7684\u4f8b\u5b50 \u00b6 \u5f53 CoD \u4e3a 0x002540 \u65f6\u6709\uff1a 0... .... .... .... .... .... = Service Classes: Information: False .0.. .... .... .... .... .... = Service Classes: Telephony: False ..0. .... .... .... .... .... = Service Classes: Audio: False ...0 .... .... .... .... .... = Service Classes: Object Transfer: False .... 0... .... .... .... .... = Service Classes: Capturing: False .... .0.. .... .... .... .... = Service Classes: Rendering: False .... ..0. .... .... .... .... = Service Classes: Networking: False .... ...0 .... .... .... .... = Service Classes: Positioning: False .... .... 00.. .... .... .... = Service Classes: Reserved: 0x0 .... .... ..1. .... .... .... = Service Classes: Limited Discoverable Mode: True .... .... ...0 0101 .... .... = Major Device Class: Peripheral (HID) (0x05) .... .... .... .... 01.. .... = Minor Device Class: Keyboard (0x1) .... .... .... .... ..00 00.. = Minor Device Class: Uncategorized device (0x0) .... .... .... .... .... ..00 = Format Type: 0x0 CoD \u7684\u4f2a\u88c5 \u00b6 CoD \u5e76\u4e0d\u662f\u5199\u6b7b\u5728 controller \u4e2d\u7684\u6570\u636e\uff0c\u5b9e\u9645\u4e0a\u5b83\u88ab host \u7ba1\u7406\u3002Host \u53ef\u4ee5\u4f7f\u7528 HCI_Write_Class_of_Device command \u4fee\u6539\u672c\u5730\u8bbe\u5907\u7684\u7c7b\u578b\uff0c\u4ece\u800c\u8fbe\u5230\u4f2a\u88c5\u7684\u76ee\u7684\u3002\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\u53ef\u4ee5\u8bfb\u53d6\u6216\u4fee\u6539\u672c\u5730 BR/EDR \u8bbe\u5907\u7684\u7c7b\u578b\uff1a hciconfig hci0 class # hci0: Type: Primary Bus: USB # BD Address: 11:22:33:44:55:19 ACL MTU: 310:10 SCO MTU: 64:8 # Class: 0x0c0000 # Service Classes: Rendering, Capturing # Device Class: Miscellaneous, sudo hciconfig hci0 class 0x002540 hciconfig hci0 class # hci0: Type: Primary Bus: USB # BD Address: 11:22:33:44:55:19 ACL MTU: 310:10 SCO MTU: 64:8 # Class: 0x002540 # Service Classes: Unspecified # Device Class: Peripheral, Keyboard \u53e6\u5916 ref [2] \u662f\u4e00\u4e2a\u5728\u7ebf\u7684 CoD \u751f\u6210\u5668\uff0c\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u6839\u636e\u9009\u5b9a\u7684\u8bbe\u5907\u7c7b\u578b\u81ea\u52a8\u751f\u6210 CoD \u6570\u503c\u3002 References \u00b6 Assigned Numbers for Baseband Bluetooth Class of Device/Service (CoD) Generator BLUETOOTH CORE SPECIFICATION Version 5.1 | Vol 3, Part C page 2107, 3.2.4 Class of device","title":"Class_of_Device"},{"location":"wireless_security/bluetooth_security/base_intro/Class_of_Device/#cod","text":"CoD \u7684\u683c\u5f0f\u662f\u53ef\u53d8\u7684\uff0c\u5177\u4f53\u7684\u683c\u5f0f\u7531 Format Type \u5b57\u6bb5\u6307\u5b9a\u3002\u5176\u4e2d\u6700\u5e38\u89c1\u7684\u683c\u5f0f\u662f \"format #1\"\uff0c\u4e14\u5176\u4ed6\u683c\u5f0f\u6781\u5176\u7f55\u89c1\u3002\u6b64\u65f6 CoD \u662f\u4e00\u4e2a\u5927\u5c0f\u4e3a 3 bytes \u7684\u6570\u503c\uff0c\u5b83\u7684\u7ed3\u6784\u5982\u4e0b\u56fe\u6240\u793a\uff081st byte \u4e3a\u6700\u9ad8\u5b57\u8282\uff09\uff1a \u4e0b\u9762\u5c06\u5206\u522b\u89e3\u91ca\u7ec4\u6210 CoD \u7684 3 \u4e2a\u4e3b\u8981\u5b57\u6bb5 Service Class, Major Device Class \u4e0e Minor Device Class\u3002","title":"\u89e3\u6790 CoD \u7ed3\u6784"},{"location":"wireless_security/bluetooth_security/base_intro/Class_of_Device/#service-class","text":"\u4e0b\u9762\u4e3a 0 \u7684\u4f4d\u88ab\u4fdd\u7559\u4f7f\u7528 Flag Description Example 1... .... 00. Information WEB-server, WAP-server .1.. .... 00. Telephony Cordless telephony, Modem, Headset service ..1. .... 00. Audio Speaker, Microphone, Headset service ...1 .... 00. Object Transfer v-Inbox, v-Folder .... 1... 00. Capturing Scanner, Microphone .... .1.. 00. Rendering Printing, Speaker .... ..1. 00. Networking LAN, Ad hoc .... ...1 00. Positioning Location identification .... .... 001 Limited Discoverable Mode","title":"Service Class"},{"location":"wireless_security/bluetooth_security/base_intro/Class_of_Device/#major-device-class","text":"Value Description Example 0b00000 Miscellaneous 0b00001 Computer Desktop, Notebook, PDA, Organizers 0b00010 Phone Cellular, Cordless, Payphone, Modem 0b00011 LAN /Network Access point 0b00100 Audio/Video Headset, Speaker, Stereo, Video display, VCR 0b00101 Peripheral (HID) Mouse, Joystick, Keyboards 0b00110 Imaging Printing, Scanner, Camera, Display 0b00111 Wearable 0b01000 Toy 0b01001 Health 0b11111 Uncategorized Others Reserved","title":"Major Device Class"},{"location":"wireless_security/bluetooth_security/base_intro/Class_of_Device/#minor-device-class","text":"\u8be5\u5b57\u6bb5\u867d\u7136\u4ec5\u5360\u7528 8 bits\uff0c\u4f46\u662f\u5f53 major device class \u4e0d\u540c\u65f6\uff0c\u6bcf\u4e2a bit \u7684\u542b\u4e49\u4e5f\u4e0d\u540c\u3002\u56e0\u6b64\u8be5\u5b57\u6bb5\u7684\u5b9a\u4e49\u5f88\u7e41\u6742\uff0c\u4e0d\u5728\u8fd9\u91cc\u8d58\u8ff0\u3002\u5177\u4f53\u53ef\u4ee5\u53c2\u8003 ref [1]\u3002","title":"Minor Device Class"},{"location":"wireless_security/bluetooth_security/base_intro/Class_of_Device/#cod_1","text":"\u5f53 CoD \u4e3a 0x002540 \u65f6\u6709\uff1a 0... .... .... .... .... .... = Service Classes: Information: False .0.. .... .... .... .... .... = Service Classes: Telephony: False ..0. .... .... .... .... .... = Service Classes: Audio: False ...0 .... .... .... .... .... = Service Classes: Object Transfer: False .... 0... .... .... .... .... = Service Classes: Capturing: False .... .0.. .... .... .... .... = Service Classes: Rendering: False .... ..0. .... .... .... .... = Service Classes: Networking: False .... ...0 .... .... .... .... = Service Classes: Positioning: False .... .... 00.. .... .... .... = Service Classes: Reserved: 0x0 .... .... ..1. .... .... .... = Service Classes: Limited Discoverable Mode: True .... .... ...0 0101 .... .... = Major Device Class: Peripheral (HID) (0x05) .... .... .... .... 01.. .... = Minor Device Class: Keyboard (0x1) .... .... .... .... ..00 00.. = Minor Device Class: Uncategorized device (0x0) .... .... .... .... .... ..00 = Format Type: 0x0","title":"\u4e00\u4e2a\u89e3\u6790 CoD \u7684\u4f8b\u5b50"},{"location":"wireless_security/bluetooth_security/base_intro/Class_of_Device/#cod_2","text":"CoD \u5e76\u4e0d\u662f\u5199\u6b7b\u5728 controller \u4e2d\u7684\u6570\u636e\uff0c\u5b9e\u9645\u4e0a\u5b83\u88ab host \u7ba1\u7406\u3002Host \u53ef\u4ee5\u4f7f\u7528 HCI_Write_Class_of_Device command \u4fee\u6539\u672c\u5730\u8bbe\u5907\u7684\u7c7b\u578b\uff0c\u4ece\u800c\u8fbe\u5230\u4f2a\u88c5\u7684\u76ee\u7684\u3002\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\u53ef\u4ee5\u8bfb\u53d6\u6216\u4fee\u6539\u672c\u5730 BR/EDR \u8bbe\u5907\u7684\u7c7b\u578b\uff1a hciconfig hci0 class # hci0: Type: Primary Bus: USB # BD Address: 11:22:33:44:55:19 ACL MTU: 310:10 SCO MTU: 64:8 # Class: 0x0c0000 # Service Classes: Rendering, Capturing # Device Class: Miscellaneous, sudo hciconfig hci0 class 0x002540 hciconfig hci0 class # hci0: Type: Primary Bus: USB # BD Address: 11:22:33:44:55:19 ACL MTU: 310:10 SCO MTU: 64:8 # Class: 0x002540 # Service Classes: Unspecified # Device Class: Peripheral, Keyboard \u53e6\u5916 ref [2] \u662f\u4e00\u4e2a\u5728\u7ebf\u7684 CoD \u751f\u6210\u5668\uff0c\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u6839\u636e\u9009\u5b9a\u7684\u8bbe\u5907\u7c7b\u578b\u81ea\u52a8\u751f\u6210 CoD \u6570\u503c\u3002","title":"CoD \u7684\u4f2a\u88c5"},{"location":"wireless_security/bluetooth_security/base_intro/Class_of_Device/#references","text":"Assigned Numbers for Baseband Bluetooth Class of Device/Service (CoD) Generator BLUETOOTH CORE SPECIFICATION Version 5.1 | Vol 3, Part C page 2107, 3.2.4 Class of device","title":"References"}]}