{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"\u524d\u8a00 \u00b6 \u7269\u8054\u7f51\uff08IOT\uff09\u5b89\u5168\u77e5\u8bc6\u5e93\uff08HatLab_IOT_Wiki\uff09\u662f\u7531\u5b89\u6052\u6d77\u7279\u5b9e\u9a8c\u5ba4\u6210\u5458\u7ecf\u8fc7\u957f\u671f\u6280\u672f\u6c89\u6dc0\uff0c\u603b\u7ed3\u3001\u6574\u7406\u7684\u4e00\u5957\u5173\u4e8e IOT \u786c\u4ef6\u5b89\u5168\u3001\u56fa\u4ef6\u5b89\u5168\u3001\u4ee5\u53ca\u65e0\u7ebf\u7535\u5b89\u5168\u65b9\u9762\u7684\u5171\u4eab\u77e5\u8bc6\u5e93\u548c\u5de5\u5177\u5e93\u3002 \u5728 IOT \u5b89\u5168\u77e5\u8bc6\u5e93\u4e2d\uff0c\u4f60\u53ef\u4ee5\u4e86\u89e3/\u83b7\u53d6\u5230\uff1a \u00b6 \u8986\u76d6 IOT \u667a\u80fd\u8bbe\u5907\u4e09\u4e2a\u653b\u51fb\u9762\u7684\u5b89\u5168\u77e5\u8bc6\uff1a\u786c\u4ef6\u5b89\u5168\u3001\u56fa\u4ef6\u5b89\u5168\u3001\u65e0\u7ebf\u7535\u5b89\u5168 \u8be6\u7ec6\u7684 IOT \u5b89\u5168\u77e5\u8bc6\u603b\u7ed3\u8981\u70b9 \u4e30\u5bcc\u7684\u653b\u51fb\u5b9e\u4f8b\u548c\u6848\u4f8b \u6709\u5173 IOT \u5b89\u5168\u76f8\u5173\u7684\u6280\u672f\u6587\u7ae0\u3001\u6280\u672f\u8d44\u6599 \u5b9e\u9a8c\u5ba4\u5185\u90e8\u6574\u5408\u3001\u5171\u4eab\u7684 IOT \u5de5\u5177\u5e93 ...","title":"\u57fa\u672c\u4ecb\u7ecd/Intro"},{"location":"#_1","text":"\u7269\u8054\u7f51\uff08IOT\uff09\u5b89\u5168\u77e5\u8bc6\u5e93\uff08HatLab_IOT_Wiki\uff09\u662f\u7531\u5b89\u6052\u6d77\u7279\u5b9e\u9a8c\u5ba4\u6210\u5458\u7ecf\u8fc7\u957f\u671f\u6280\u672f\u6c89\u6dc0\uff0c\u603b\u7ed3\u3001\u6574\u7406\u7684\u4e00\u5957\u5173\u4e8e IOT \u786c\u4ef6\u5b89\u5168\u3001\u56fa\u4ef6\u5b89\u5168\u3001\u4ee5\u53ca\u65e0\u7ebf\u7535\u5b89\u5168\u65b9\u9762\u7684\u5171\u4eab\u77e5\u8bc6\u5e93\u548c\u5de5\u5177\u5e93\u3002","title":"\u524d\u8a00"},{"location":"#iot","text":"\u8986\u76d6 IOT \u667a\u80fd\u8bbe\u5907\u4e09\u4e2a\u653b\u51fb\u9762\u7684\u5b89\u5168\u77e5\u8bc6\uff1a\u786c\u4ef6\u5b89\u5168\u3001\u56fa\u4ef6\u5b89\u5168\u3001\u65e0\u7ebf\u7535\u5b89\u5168 \u8be6\u7ec6\u7684 IOT \u5b89\u5168\u77e5\u8bc6\u603b\u7ed3\u8981\u70b9 \u4e30\u5bcc\u7684\u653b\u51fb\u5b9e\u4f8b\u548c\u6848\u4f8b \u6709\u5173 IOT \u5b89\u5168\u76f8\u5173\u7684\u6280\u672f\u6587\u7ae0\u3001\u6280\u672f\u8d44\u6599 \u5b9e\u9a8c\u5ba4\u5185\u90e8\u6574\u5408\u3001\u5171\u4eab\u7684 IOT \u5de5\u5177\u5e93 ...","title":"\u5728 IOT \u5b89\u5168\u77e5\u8bc6\u5e93\u4e2d\uff0c\u4f60\u53ef\u4ee5\u4e86\u89e3/\u83b7\u53d6\u5230\uff1a"},{"location":"about/","text":"\u6280\u672f\u4ea4\u6d41 \u00b6 \u77e5\u8bc6\u661f\u7403 \u00b6 \u6d77\u7279\u5b9e\u9a8c\u5ba4\u5185\u90e8\u5efa\u7acb\u4e86\u4e00\u4e2a\u4e13\u6ce8\u4e8e IOT \u5b89\u5168\u7684\u77e5\u8bc6\u661f\u7403\uff0c\u5185\u90e8\u5206\u4eab\u4e00\u4e9b\u7269\u8054\u7f51\u76f8\u5173\u7684\u6280\u672f\u8d44\u6599\u548c\u7b2c\u4e09\u65b9\u5b66\u4e60\u8d44\u6e90\uff0c\u4ee5\u53ca\u5b9e\u9a8c\u5ba4\u5728\u8fd1\u4e9b\u5e74\u6765\u5728 IOT \u5b89\u5168\u9886\u57df\u7684\u6280\u672f\u6c89\u6dc0\u3002**\u661f\u7403\u5efa\u7acb\u7684\u76ee\u7684\u662f\u4e3a\u4e86\u8ba9\u66f4\u591a\u6709\u5fd7\u4e8e\u7814\u7a76 IOT \u5b89\u5168\u7684\u5c0f\u4f19\u4f34\u6709\u4e00\u4e2a\u66f4\u52a0\u7d27\u5bc6\u8054\u7cfb\u7684\u5e73\u53f0\u3002**\u52a0\u5165\u4e0d\u9700\u8981\u8d39\u7528\uff0c\u6b22\u8fce\u5927\u5bb6\u524d\u6765\u4ea4\u6d41\uff01 \u5b89\u6052\u4fe1\u606f\u5b89\u5168\u7814\u7a76\u9662\u516c\u4f17\u53f7 \u00b6 \u5b89\u6052\u4fe1\u606f\u5b89\u5168\u7814\u7a76\u9662\u4e8c\u7ef4\u7801\u3002 \u6b64\u516c\u4f17\u53f7\u4e3a\u5b89\u6052\u4fe1\u606f\u5b89\u5168\u7814\u7a76\u9662\u7684\u5b98\u65b9\u8d26\u53f7\uff0c\u7814\u7a76\u9662\u4e0b\u5c5e\u5b9e\u9a8c\u5ba4\u6709\uff1a \u730e\u5f71\u5b9e\u9a8c\u5ba4 \u6d77\u7279\u5b9e\u9a8c\u5ba4 \u536b\u5175\u5b9e\u9a8c\u5ba4 \u516c\u4f17\u53f7\u4e0d\u5b9a\u65f6\u53d1\u5e03\u4e00\u4e9b\u6280\u672f\u5e72\u8d27\u548c\u6280\u672f\u5b66\u4e60\u8d44\u6599\uff0c\u6587\u7ae0\u90fd\u662f\u7531\u5404\u4e2a\u5b89\u5168\u9886\u57df\u5185\u5b9e\u9a8c\u5ba4\u5927\u725b\u5b8c\u6210\u5e76\u6525\u5199\uff0c\u6587\u7ae0\u8d28\u91cf\u90fd\u975e\u5e38\u7684\u9ad8\uff01\u6b22\u8fce\u5927\u5bb6\u5173\u6ce8\u6211\u4eec\uff01 \u5173\u4e8e\u6211\u4eec \u00b6 \u4e86\u89e3\u6211\u4eec \u00b6 \u6d77\u7279\u5b9e\u9a8c\u5ba4\uff08HatLab\uff09\uff0c\u5bd3\u610f\u4e3a \u201cHack AnyThing\u201d\uff0c\u662f\u5b89\u6052\u4fe1\u606f\u5b89\u5168\u7814\u7a76\u9662\u6210\u7acb\u7684\u4e00\u652f\u81f4\u529b\u4e8e IOT \u5b89\u5168\u7814\u7a76\u7684\u56e2\u961f\uff0c\u4e13\u6ce8\u4e8e\u7269\u8054\u7f51\u786c\u4ef6\u3001\u56fa\u4ef6\u3001\u65e0\u7ebf\u7535\u76f8\u5173\u5b89\u5168\u7814\u7a76 \u3002 \u5b9e\u9a8c\u5ba4\u5148\u540e\u53d1\u73b0 Cisco\u3001Juniper\u3001PaloAlto\u3001TP-LINK\u3001GoAhead\u3001Lua \u7b49\u77e5\u540d\u5382\u5546\u4e0e\u76f8\u5173\u901a\u7528 IOT \u7ec4\u4ef6\u7684\u6f0f\u6d1e\u3002\u53c2\u4e0e HITB\u3001ZeroNights\u3001\u5f3a\u7f51\u676f\u3001GeekPwn \u7b49\u56fd\u5185\u5916\u77e5\u540d\u4f1a\u8bae\u548c\u6f14\u8bb2\uff0c\u5e76\u81ea\u4e3b\u7814\u53d1\u591a\u4e2a\u521b\u65b0\u6027\u786c\u4ef6\u8bbe\u5907\u3002 \u52a0\u5165\u6211\u4eec \u00b6 ** \u5b89\u6052\u4fe1\u606f\u5b89\u5168\u7814\u7a76\u9662\u7684\u6280\u672f\u6c1b\u56f4\u6d53\u539a\uff0c\u5404\u79cd\u85aa\u8d44\u5f85\u9047\u3001\u798f\u5229\u90fd\u5f88\u68d2!** \u60f3\u8981\u8fdb\u4e00\u6b65\u4e86\u89e3\u6211\u4eec\u6216\u8005\u52a0\u5165\u6211\u4eec\uff0c\u53ef\u4ee5\u8054\u7cfb\u4e0b\u9762\u7684\u90ae\u7bb1\uff0c\u6295\u9012\u7b80\u5386\uff1a double.jiang@dbappsecurity.com.cn","title":"\u5173\u4e8e\u6211\u4eec/About"},{"location":"about/#_1","text":"","title":"\u6280\u672f\u4ea4\u6d41"},{"location":"about/#_2","text":"\u6d77\u7279\u5b9e\u9a8c\u5ba4\u5185\u90e8\u5efa\u7acb\u4e86\u4e00\u4e2a\u4e13\u6ce8\u4e8e IOT \u5b89\u5168\u7684\u77e5\u8bc6\u661f\u7403\uff0c\u5185\u90e8\u5206\u4eab\u4e00\u4e9b\u7269\u8054\u7f51\u76f8\u5173\u7684\u6280\u672f\u8d44\u6599\u548c\u7b2c\u4e09\u65b9\u5b66\u4e60\u8d44\u6e90\uff0c\u4ee5\u53ca\u5b9e\u9a8c\u5ba4\u5728\u8fd1\u4e9b\u5e74\u6765\u5728 IOT \u5b89\u5168\u9886\u57df\u7684\u6280\u672f\u6c89\u6dc0\u3002**\u661f\u7403\u5efa\u7acb\u7684\u76ee\u7684\u662f\u4e3a\u4e86\u8ba9\u66f4\u591a\u6709\u5fd7\u4e8e\u7814\u7a76 IOT \u5b89\u5168\u7684\u5c0f\u4f19\u4f34\u6709\u4e00\u4e2a\u66f4\u52a0\u7d27\u5bc6\u8054\u7cfb\u7684\u5e73\u53f0\u3002**\u52a0\u5165\u4e0d\u9700\u8981\u8d39\u7528\uff0c\u6b22\u8fce\u5927\u5bb6\u524d\u6765\u4ea4\u6d41\uff01","title":"\u77e5\u8bc6\u661f\u7403"},{"location":"about/#_3","text":"\u5b89\u6052\u4fe1\u606f\u5b89\u5168\u7814\u7a76\u9662\u4e8c\u7ef4\u7801\u3002 \u6b64\u516c\u4f17\u53f7\u4e3a\u5b89\u6052\u4fe1\u606f\u5b89\u5168\u7814\u7a76\u9662\u7684\u5b98\u65b9\u8d26\u53f7\uff0c\u7814\u7a76\u9662\u4e0b\u5c5e\u5b9e\u9a8c\u5ba4\u6709\uff1a \u730e\u5f71\u5b9e\u9a8c\u5ba4 \u6d77\u7279\u5b9e\u9a8c\u5ba4 \u536b\u5175\u5b9e\u9a8c\u5ba4 \u516c\u4f17\u53f7\u4e0d\u5b9a\u65f6\u53d1\u5e03\u4e00\u4e9b\u6280\u672f\u5e72\u8d27\u548c\u6280\u672f\u5b66\u4e60\u8d44\u6599\uff0c\u6587\u7ae0\u90fd\u662f\u7531\u5404\u4e2a\u5b89\u5168\u9886\u57df\u5185\u5b9e\u9a8c\u5ba4\u5927\u725b\u5b8c\u6210\u5e76\u6525\u5199\uff0c\u6587\u7ae0\u8d28\u91cf\u90fd\u975e\u5e38\u7684\u9ad8\uff01\u6b22\u8fce\u5927\u5bb6\u5173\u6ce8\u6211\u4eec\uff01","title":"\u5b89\u6052\u4fe1\u606f\u5b89\u5168\u7814\u7a76\u9662\u516c\u4f17\u53f7"},{"location":"about/#_4","text":"","title":"\u5173\u4e8e\u6211\u4eec"},{"location":"about/#_5","text":"\u6d77\u7279\u5b9e\u9a8c\u5ba4\uff08HatLab\uff09\uff0c\u5bd3\u610f\u4e3a \u201cHack AnyThing\u201d\uff0c\u662f\u5b89\u6052\u4fe1\u606f\u5b89\u5168\u7814\u7a76\u9662\u6210\u7acb\u7684\u4e00\u652f\u81f4\u529b\u4e8e IOT \u5b89\u5168\u7814\u7a76\u7684\u56e2\u961f\uff0c\u4e13\u6ce8\u4e8e\u7269\u8054\u7f51\u786c\u4ef6\u3001\u56fa\u4ef6\u3001\u65e0\u7ebf\u7535\u76f8\u5173\u5b89\u5168\u7814\u7a76 \u3002 \u5b9e\u9a8c\u5ba4\u5148\u540e\u53d1\u73b0 Cisco\u3001Juniper\u3001PaloAlto\u3001TP-LINK\u3001GoAhead\u3001Lua \u7b49\u77e5\u540d\u5382\u5546\u4e0e\u76f8\u5173\u901a\u7528 IOT \u7ec4\u4ef6\u7684\u6f0f\u6d1e\u3002\u53c2\u4e0e HITB\u3001ZeroNights\u3001\u5f3a\u7f51\u676f\u3001GeekPwn \u7b49\u56fd\u5185\u5916\u77e5\u540d\u4f1a\u8bae\u548c\u6f14\u8bb2\uff0c\u5e76\u81ea\u4e3b\u7814\u53d1\u591a\u4e2a\u521b\u65b0\u6027\u786c\u4ef6\u8bbe\u5907\u3002","title":"\u4e86\u89e3\u6211\u4eec"},{"location":"about/#_6","text":"** \u5b89\u6052\u4fe1\u606f\u5b89\u5168\u7814\u7a76\u9662\u7684\u6280\u672f\u6c1b\u56f4\u6d53\u539a\uff0c\u5404\u79cd\u85aa\u8d44\u5f85\u9047\u3001\u798f\u5229\u90fd\u5f88\u68d2!** \u60f3\u8981\u8fdb\u4e00\u6b65\u4e86\u89e3\u6211\u4eec\u6216\u8005\u52a0\u5165\u6211\u4eec\uff0c\u53ef\u4ee5\u8054\u7cfb\u4e0b\u9762\u7684\u90ae\u7bb1\uff0c\u6295\u9012\u7b80\u5386\uff1a double.jiang@dbappsecurity.com.cn","title":"\u52a0\u5165\u6211\u4eec"},{"location":"attach/","text":"30 - [2017 \u5e74 GeekPwn - \u7834\u89e3\u667a\u80fd\u5bb6\u5c45\u3001\u5c0f\u7c73\u5e73\u8861\u8f66 ] ( https://www.sohu.com/a/141137863_783750 \"2017 \u5e74 GeekPwn HatLab\") 31 - 2019 GeekPwn \u540d\u4eba\u5802 - \u4f01\u4e1a\u7ea7\u7f51\u5173\u7684\u6f0f\u6d1e\u5229\u7528 32 - 2019 ZeroNight \u4f1a\u8bae - CiscoASA: From Zero to ID=0","title":"Attach"},{"location":"summary/","text":"\u5185\u5bb9\u6982\u8ff0\u3001\u5206\u7c7b \u00b6 \u786c\u4ef6\u5b89\u5168 \u00b6 \u786c\u4ef6\u5b89\u5168\u65b9\u9762\u7684\u57fa\u7840\u77e5\u8bc6\u4ee5\u53ca\u76f8\u5e94\u653b\u51fb\u65b9\u6cd5 \u56fa\u4ef6\u5b89\u5168 \u00b6 \u56fa\u4ef6\u5b89\u5168\u65b9\u9762\u57fa\u7840\u77e5\u8bc6 \u56fa\u4ef6\u6f0f\u6d1e\u7c7b\u578b \u56fa\u4ef6\u5904\u7406\u7684\u6280\u5de7 \u76f8\u5e94\u7684\u6f0f\u6d1e\u5206\u6790\u793a\u4f8b \u65e0\u7ebf\u7535\u5b89\u5168 \u00b6 \u65e0\u7ebf\u7535\u5b89\u5168\u65b9\u9762\u7684\u57fa\u7840\u77e5\u8bc6\u4ee5\u53ca\u76f8\u5e94\u653b\u51fb\u65b9\u6cd5 \u84dd\u7259\u5b89\u5168\u7684\u57fa\u7840\u77e5\u8bc6\u548c\u653b\u9632\u6280\u5de7 zigbee \u5b89\u5168\u7684\u57fa\u7840\u77e5\u8bc6\u548c\u653b\u9632\u6280\u5de7","title":"\u5185\u5bb9\u6982\u8ff0/Summary"},{"location":"summary/#_1","text":"","title":"\u5185\u5bb9\u6982\u8ff0\u3001\u5206\u7c7b"},{"location":"summary/#_2","text":"\u786c\u4ef6\u5b89\u5168\u65b9\u9762\u7684\u57fa\u7840\u77e5\u8bc6\u4ee5\u53ca\u76f8\u5e94\u653b\u51fb\u65b9\u6cd5","title":"\u786c\u4ef6\u5b89\u5168"},{"location":"summary/#_3","text":"\u56fa\u4ef6\u5b89\u5168\u65b9\u9762\u57fa\u7840\u77e5\u8bc6 \u56fa\u4ef6\u6f0f\u6d1e\u7c7b\u578b \u56fa\u4ef6\u5904\u7406\u7684\u6280\u5de7 \u76f8\u5e94\u7684\u6f0f\u6d1e\u5206\u6790\u793a\u4f8b","title":"\u56fa\u4ef6\u5b89\u5168"},{"location":"summary/#_4","text":"\u65e0\u7ebf\u7535\u5b89\u5168\u65b9\u9762\u7684\u57fa\u7840\u77e5\u8bc6\u4ee5\u53ca\u76f8\u5e94\u653b\u51fb\u65b9\u6cd5 \u84dd\u7259\u5b89\u5168\u7684\u57fa\u7840\u77e5\u8bc6\u548c\u653b\u9632\u6280\u5de7 zigbee \u5b89\u5168\u7684\u57fa\u7840\u77e5\u8bc6\u548c\u653b\u9632\u6280\u5de7","title":"\u65e0\u7ebf\u7535\u5b89\u5168"},{"location":"firmware_security/","text":"\u6982\u8ff0 \u00b6 \u56fa\u4ef6\u5b89\u5168\u4e3b\u8981\u7814\u7a76\u7684\u662f\u786c\u4ef6\u8bbe\u5907\u5185\u90e8\u7684\u56fa\u4ef6\uff0c\u901a\u8fc7\u5bf9\u56fa\u4ef6\u4e2d\u7a0b\u5e8f\u7684\u4ee3\u7801\u903b\u8f91\u8fdb\u884c\u9006\u5411\u5206\u6790\uff0c\u4ece\u800c\u4ece\u4e2d\u53d1\u5176\u4e2d\u7684\u5b89\u5168\u95ee\u9898\u3002 \u76ee\u5f55\u4e3b\u8981\u5206\u4e3a\u4ee5\u4e0b\u51e0\u90e8\u5206\u6765\u5f52\u7c7b\uff1a \u56fa\u4ef6\u7684\u83b7\u53d6 \u56fa\u4ef6\u7684\u5904\u7406 \u56fa\u4ef6\u7684\u6f0f\u6d1e\u5206\u6790\u548c\u6316\u6398 \u56fa\u4ef6\u5b89\u5168\u5b9e\u4f8b","title":"\u6982\u8ff0"},{"location":"firmware_security/#_1","text":"\u56fa\u4ef6\u5b89\u5168\u4e3b\u8981\u7814\u7a76\u7684\u662f\u786c\u4ef6\u8bbe\u5907\u5185\u90e8\u7684\u56fa\u4ef6\uff0c\u901a\u8fc7\u5bf9\u56fa\u4ef6\u4e2d\u7a0b\u5e8f\u7684\u4ee3\u7801\u903b\u8f91\u8fdb\u884c\u9006\u5411\u5206\u6790\uff0c\u4ece\u800c\u4ece\u4e2d\u53d1\u5176\u4e2d\u7684\u5b89\u5168\u95ee\u9898\u3002 \u76ee\u5f55\u4e3b\u8981\u5206\u4e3a\u4ee5\u4e0b\u51e0\u90e8\u5206\u6765\u5f52\u7c7b\uff1a \u56fa\u4ef6\u7684\u83b7\u53d6 \u56fa\u4ef6\u7684\u5904\u7406 \u56fa\u4ef6\u7684\u6f0f\u6d1e\u5206\u6790\u548c\u6316\u6398 \u56fa\u4ef6\u5b89\u5168\u5b9e\u4f8b","title":"\u6982\u8ff0"},{"location":"firmware_security/firmware_sort/","text":"\u6982\u8ff0 \u00b6 \u9488\u5bf9\u4e8e\u56fa\u4ef6\u7c7b\u578b\u7684\u4e0d\u540c\uff0c\u53ef\u4ee5\u5c06\u7269\u8054\u7f51\u8bbe\u5907\u8fdb\u5206\u7c7b\u3002 \u5206\u7c7b \u00b6 \u53ef\u4ee5\u5206\u4e3a\u4e0b\u9762\u4e09\u7c7b\uff1a \u901a\u7528\u578b\u64cd\u4f5c\u7cfb\u7edf \u3002\u5728\u5d4c\u5165\u5f0f\u7684\u8bbe\u5907\u56fa\u4ef6\u4e2d\uff0c\u4e00\u822c\u90fd\u662f\u4f7f\u7528\u7684 linux \u5185\u6838\u7684\u64cd\u4f5c\u7cfb\u7edf\uff0clibc \u5e93\u4e5f\u662f\u4f7f\u7528\u7684\u7cbe\u7b80\u7684 uClibc\u3002 IOT \u8bbe\u5907\u4e2d\u6700\u5e38\u89c1\u7684\u7cfb\u7edf\u4e5f\u4e3a\u8fd9\u79cd\u3002\u5177\u6709\u7684\u4ee3\u8868\u6027\u7684\u8bbe\u5907\u6709\u667a\u80fd\u8def\u7531\u5668\u3001\u667a\u80fd\u6444\u50cf\u5934\u56fa\u4ef6\u7b49\u3002 \u5b9e\u65f6\u64cd\u4f5c\u7cfb\u7edf \u3002\u4f8b\u5982 VxWorks \u548c FreeRTOS \u7b49\u4e3a\u5e38\u89c1\u7684\u5b9e\u65f6\u64cd\u4f5c\u7cfb\u7edf\u3002\u8bb8\u591a\u8def\u7531\u5668\u5382\u5546\u4e5f\u4f1a\u4f7f\u7528 VxWorks \u4f5c\u4e3a\u5176\u6587\u4ef6\u7cfb\u7edf\uff0c\u5982 TPLINK \u8def\u7531\u5668\u56fa\u4ef6\u3002 \u65e0\u64cd\u4f5c\u7cfb\u7edf/\u88f8\u673a \u3002\u8fd9\u7c7b\u7684\u8bbe\u5907\u53ef\u4ee5\u770b\u4f5c\u662f \"\u5355\u7247\u673a\u8bbe\u5907\"\uff0c\u8bbe\u5907\u56fa\u4ef6\u4e2d\u662f\u6bd4\u8f83\u7b80\u5355\u7684\u63a7\u5236\u3001\u5faa\u73af\u903b\u8f91\uff0c\u5904\u7406\u5916\u90e8\u4e16\u754c\u7684\u5404\u79cd\u4e8b\u4ef6\uff0c\u5982\u5e38\u89c1\u7684\u667a\u80fd\u95e8\u9501\u5185\u90e8\u56fa\u4ef6\u3002 \u5982\u4e0b\u56fe\u4e2d\u4e3a\u67d0\u4e2a\u95e8\u9501\u7684\u56fa\u4ef6\uff0c\u56fa\u4ef6\u4e2d\u7684\u6c47\u7f16\u4ee3\u7801\u4e0d\u5b58\u5728\u7b26\u53f7\u8868\u3001got \u8868\u7b49\u4fe1\u606f\uff0c\u76f4\u63a5\u9759\u6001\u9006\u5411\u5206\u6790\u7684\u96be\u5ea6\u5927\u3002 \u4e0d\u540c\u7c7b\u578b\u56fa\u4ef6\u7684\u8bbe\u5907\u7279\u70b9 \u00b6 \u901a\u7528\u578b\u64cd\u4f5c\u7cfb\u7edf\u7684\u7279\u70b9\u662f\u9002\u5408\u5904\u7406\u5927\u91cf\u7684\u6570\u636e\u3001\u9ad8\u8ba1\u7b97\u91cf\u7684\u8bbe\u5907\u3002\u56fa\u4ef6\u4e00\u822c\u5b58\u5728\u7b26\u53f7\u8868\uff0c\u9006\u5411\u96be\u5ea6\u8f83\u5c0f\u3002 \u65e0\u64cd\u4f5c\u7cfb\u7edf/\u88f8\u673a\u7684\u8bbe\u5907\u7684\u80fd\u8017\u4f4e\uff0c\u8d44\u6e90\u7ba1\u7406\u9ad8\u6548\uff0c\u9002\u5408\u957f\u65f6\u95f4\u7eed\u822a\u3002\u56fa\u4ef6\u4ee3\u7801\u90fd\u662f\u9759\u6001\u7f16\u8bd1\uff0c\u5bf9\u4e8e\u5e93\u51fd\u6570\u4e5f\u6ca1\u6709\u76f8\u5e94\u7684\u7b26\u53f7\u540d\u79f0\u3002 \u540e\u4e24\u79cd\u64cd\u4f5c\u7cfb\u7edf\u53ef\u4ee5\u7edf\u79f0\u4e3a\u8f7b\u91cf\u7ea7\u7269\u8054\u7f51\u8bbe\u5907\u3002 \u53c2\u8003\u6587\u732e \u00b6 \u8f7b\u91cf\u7ea7\u7269\u8054\u7f51\u8bbe\u5907\u56fa\u4ef6\u5185\u5b58\u6f0f\u6d1e\u6316\u6398\u7814\u7a76","title":"\u56fa\u4ef6\u5206\u7c7b"},{"location":"firmware_security/firmware_sort/#_1","text":"\u9488\u5bf9\u4e8e\u56fa\u4ef6\u7c7b\u578b\u7684\u4e0d\u540c\uff0c\u53ef\u4ee5\u5c06\u7269\u8054\u7f51\u8bbe\u5907\u8fdb\u5206\u7c7b\u3002","title":"\u6982\u8ff0"},{"location":"firmware_security/firmware_sort/#_2","text":"\u53ef\u4ee5\u5206\u4e3a\u4e0b\u9762\u4e09\u7c7b\uff1a \u901a\u7528\u578b\u64cd\u4f5c\u7cfb\u7edf \u3002\u5728\u5d4c\u5165\u5f0f\u7684\u8bbe\u5907\u56fa\u4ef6\u4e2d\uff0c\u4e00\u822c\u90fd\u662f\u4f7f\u7528\u7684 linux \u5185\u6838\u7684\u64cd\u4f5c\u7cfb\u7edf\uff0clibc \u5e93\u4e5f\u662f\u4f7f\u7528\u7684\u7cbe\u7b80\u7684 uClibc\u3002 IOT \u8bbe\u5907\u4e2d\u6700\u5e38\u89c1\u7684\u7cfb\u7edf\u4e5f\u4e3a\u8fd9\u79cd\u3002\u5177\u6709\u7684\u4ee3\u8868\u6027\u7684\u8bbe\u5907\u6709\u667a\u80fd\u8def\u7531\u5668\u3001\u667a\u80fd\u6444\u50cf\u5934\u56fa\u4ef6\u7b49\u3002 \u5b9e\u65f6\u64cd\u4f5c\u7cfb\u7edf \u3002\u4f8b\u5982 VxWorks \u548c FreeRTOS \u7b49\u4e3a\u5e38\u89c1\u7684\u5b9e\u65f6\u64cd\u4f5c\u7cfb\u7edf\u3002\u8bb8\u591a\u8def\u7531\u5668\u5382\u5546\u4e5f\u4f1a\u4f7f\u7528 VxWorks \u4f5c\u4e3a\u5176\u6587\u4ef6\u7cfb\u7edf\uff0c\u5982 TPLINK \u8def\u7531\u5668\u56fa\u4ef6\u3002 \u65e0\u64cd\u4f5c\u7cfb\u7edf/\u88f8\u673a \u3002\u8fd9\u7c7b\u7684\u8bbe\u5907\u53ef\u4ee5\u770b\u4f5c\u662f \"\u5355\u7247\u673a\u8bbe\u5907\"\uff0c\u8bbe\u5907\u56fa\u4ef6\u4e2d\u662f\u6bd4\u8f83\u7b80\u5355\u7684\u63a7\u5236\u3001\u5faa\u73af\u903b\u8f91\uff0c\u5904\u7406\u5916\u90e8\u4e16\u754c\u7684\u5404\u79cd\u4e8b\u4ef6\uff0c\u5982\u5e38\u89c1\u7684\u667a\u80fd\u95e8\u9501\u5185\u90e8\u56fa\u4ef6\u3002 \u5982\u4e0b\u56fe\u4e2d\u4e3a\u67d0\u4e2a\u95e8\u9501\u7684\u56fa\u4ef6\uff0c\u56fa\u4ef6\u4e2d\u7684\u6c47\u7f16\u4ee3\u7801\u4e0d\u5b58\u5728\u7b26\u53f7\u8868\u3001got \u8868\u7b49\u4fe1\u606f\uff0c\u76f4\u63a5\u9759\u6001\u9006\u5411\u5206\u6790\u7684\u96be\u5ea6\u5927\u3002","title":"\u5206\u7c7b"},{"location":"firmware_security/firmware_sort/#_3","text":"\u901a\u7528\u578b\u64cd\u4f5c\u7cfb\u7edf\u7684\u7279\u70b9\u662f\u9002\u5408\u5904\u7406\u5927\u91cf\u7684\u6570\u636e\u3001\u9ad8\u8ba1\u7b97\u91cf\u7684\u8bbe\u5907\u3002\u56fa\u4ef6\u4e00\u822c\u5b58\u5728\u7b26\u53f7\u8868\uff0c\u9006\u5411\u96be\u5ea6\u8f83\u5c0f\u3002 \u65e0\u64cd\u4f5c\u7cfb\u7edf/\u88f8\u673a\u7684\u8bbe\u5907\u7684\u80fd\u8017\u4f4e\uff0c\u8d44\u6e90\u7ba1\u7406\u9ad8\u6548\uff0c\u9002\u5408\u957f\u65f6\u95f4\u7eed\u822a\u3002\u56fa\u4ef6\u4ee3\u7801\u90fd\u662f\u9759\u6001\u7f16\u8bd1\uff0c\u5bf9\u4e8e\u5e93\u51fd\u6570\u4e5f\u6ca1\u6709\u76f8\u5e94\u7684\u7b26\u53f7\u540d\u79f0\u3002 \u540e\u4e24\u79cd\u64cd\u4f5c\u7cfb\u7edf\u53ef\u4ee5\u7edf\u79f0\u4e3a\u8f7b\u91cf\u7ea7\u7269\u8054\u7f51\u8bbe\u5907\u3002","title":"\u4e0d\u540c\u7c7b\u578b\u56fa\u4ef6\u7684\u8bbe\u5907\u7279\u70b9"},{"location":"firmware_security/firmware_sort/#_4","text":"\u8f7b\u91cf\u7ea7\u7269\u8054\u7f51\u8bbe\u5907\u56fa\u4ef6\u5185\u5b58\u6f0f\u6d1e\u6316\u6398\u7814\u7a76","title":"\u53c2\u8003\u6587\u732e"},{"location":"firmware_security/IOT_instructions_charac/found_danger_func/","text":"IOT \u8bbe\u5907\u6f0f\u6d1e\u6316\u6398-MIPS \u6307\u4ee4\u96c6\u9006\u5411\u6280\u5de7 \u00b6 MIPS \u53cd\u6c47\u7f16\u5de5\u5177 \u00b6 IDA \u65e0\u6cd5\u76f4\u63a5\u53cd\u6c47\u7f16 mips \u4ee3\u7801\uff0c\u4f46\u662f\u6709\u4e24\u4e2a\u63d2\u4ef6\u53ef\u4ee5\u8f85\u52a9\u6211\u4eec\u8fdb\u884c\u4f2a\u4ee3\u7801\u7684\u751f\u6210\u3002 IDA \u63d2\u4ef6\u4e4b retdec \u00b6 \u9879\u76ee\u5730\u5740\uff1a https://github.com/avast/retdec \u5b89\u88c5\u8fc7\u7a0b\u8f83\u4e3a\u7b80\u5355\uff0c\u53ef\u4ee5\u53c2\u8003\u7f51\u4e0a\u7684\u76f8\u5173\u6559\u7a0b\uff0c\u4e0d\u5728\u6b64\u8d58\u8ff0\u4e86\uff0c\u4ee5\u4e0b\u662f\u4e24\u5f20\u5206\u6790\u65f6\u5019\u7684\u622a\u56fe\uff0c\u7b2c\u4e00\u5f20\u662f\u5206\u6790\u8fc7\u7a0b\u4e2d\u7684\u622a\u56fe\uff0c\u7b2c\u4e8c\u5f20\u662f\u5206\u6790\u7684\u7ed3\u679c\u3002 Ghidra \u00b6 Ghidra\u662f\u7531\u7f8e\u56fd\u56fd\u5bb6\u5b89\u5168\u5c40\uff08NSA\uff09\u7814\u7a76\u90e8\u95e8\u5f00\u53d1\u7684\u8f6f\u4ef6\u9006\u5411\u5de5\u7a0b\uff08SRE\uff09\u5957\u4ef6\uff0c\u662f\u4e00\u4e2a\u8f6f\u4ef6\u9006\u5411\u5de5\u7a0b\uff08SRE\uff09\u6846\u67b6\uff0c\u5305\u62ec\u4e00\u5957\u529f\u80fd\u9f50\u5168\u7684\u9ad8\u7aef\u8f6f\u4ef6\u5206\u6790\u5de5\u5177\uff0c\u4f7f\u7528\u6237\u80fd\u591f\u5728\u5404\u79cd\u5e73\u53f0\u4e0a\u5206\u6790\u7f16\u8bd1\u540e\u7684\u4ee3\u7801\uff0c\u5305\u62ecWindows\u3001Mac OS\u548cLinux\u3002\u529f\u80fd\u5305\u62ec\u53cd\u6c47\u7f16\uff0c\u6c47\u7f16\uff0c\u53cd\u7f16\u8bd1\uff0c\u7ed8\u56fe\u548c\u811a\u672c\uff0c\u4ee5\u53ca\u6570\u767e\u4e2a\u5176\u4ed6\u529f\u80fd\u3002Ghidra\u652f\u6301\u5404\u79cd\u5904\u7406\u5668\u6307\u4ee4\u96c6\u548c\u53ef\u6267\u884c\u683c\u5f0f\uff0c\u53ef\u4ee5\u5728\u7528\u6237\u4ea4\u4e92\u6a21\u5f0f\u548c\u81ea\u52a8\u6a21\u5f0f\u4e0b\u8fd0\u884c\u3002\u7528\u6237\u8fd8\u53ef\u4ee5\u4f7f\u7528\u516c\u5f00\u7684API\u5f00\u53d1\u81ea\u5df1\u7684Ghidra\u63d2\u4ef6\u548c\u811a\u672c\u3002 \u603b\u4e4b\u8fd9\u4e2a\u4e00\u4e2a\u529f\u80fd\u975e\u5e38\u5f3a\u5927\u7684\u53cd\u6c47\u7f16\u5de5\u5177\uff0c\u57fa\u4e8e java \u5f00\u53d1\uff0c\u53ef\u4ee5\u53cd\u6c47\u7f16\u5f88\u591a\u79cd\u7684\u6c47\u7f16\u4ee3\u7801\u7c7b\u578b\u3002\u800c\u6211\u4eec\u4f7f\u7528\u8fd9\u4e2a\u5de5\u5177\u7684\u76ee\u7684\u5c31\u662f\u56e0\u4e3a\u8fd9\u4e2a\u5de5\u5177\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u751f\u6210 mips \u7684\u4f2a C \u4ee3\u7801\u3002\u4ece\u800c\u65b9\u4fbf\u6211\u4eec\u8fdb\u884c\u4ee3\u7801\u9006\u5411\u3002 \u6709\u4e00\u6b3eGhrida\u7684\u63d2\u4ef6\u6bd4\u8f83\u9002\u7528\u4e8e\u4e60\u60ef\u4e8e\u7528IDA\u7684\u540c\u5b66\uff0c\u4f1a\u628aGhrida\u91cc\u9762\u7684\u5feb\u6377\u952e\u6620\u5c04\u6210IDA\u91cc\u9762\u7684\u5feb\u6377\u952e\uff0c\u8fd9\u6837\u7528\u8d77\u6765\u5c31\u597d\u591a\u4e86\u3002 \u63d2\u4ef6\u5730\u5740\uff1a https://github.com/enovella/ida2ghidra-kb \u63d2\u4ef6\u7684\u5b89\u88c5\u65b9\u6cd5\u8f83\u4e3a\u7b80\u5355\uff0c\u4f9d\u7167\u8bf4\u660e\u5373\u53ef\u3002\u5b9e\u73b0\u4e86\u5305\u62ecx\u3001g\u7b49IDA\u4e2d\u5feb\u6377\u952e\u529f\u80fd\u3002 \u53e6\u5916\uff0c\u9700\u8981\u4e3b\u8981\uff0c\u5728\u4f7f\u7528Ghrida\u5206\u6790MIPS\u7684\u65f6\u5019\uff0cPLT\u548cGOT\u7684\u65f6\u5019\u7ecf\u5e38\u4f1a\u51fa\u73b0\u95ee\u9898\uff0c\u5982\u56fe\u6240\u793a\uff1a \u5982\u679c\u4f60\u9700\u8981\u5b9a\u4f4dGOT\u8868\uff0c\u8fd8\u662f\u9700\u8981\u4f7f\u7528IDA\u67e5\u627e\u66f4\u4e3a\u76f4\u89c2\u65b9\u4fbf\u3002 xxxkkk@\u6d77\u7279\u5b9e\u9a8c\u5ba4 \u654f\u611f\u51fd\u6570\u5b9a\u4f4d \u00b6 \u6211\u4eec\u5728\u9006\u5411\u5206\u6790\u4e00\u4e2a mips \u6307\u4ee4\u96c6\u67b6\u6784\u7684\u4e8c\u8fdb\u5236\u7a0b\u5e8f\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528\u654f\u611f\u51fd\u6570\u5b9a\u4f4d\u7684\u65b9\u6cd5\uff0c\u5feb\u901f\u5b9a\u4f4d\u654f\u611f\u51fd\u6570\uff0c\u5982 system\u3001sprintf\u3001strcpy \u7b49\u547d\u4ee4\u6267\u884c\u548c\u5bb9\u6613\u53d1\u751f\u6808\u6ea2\u51fa\u7684\u51fd\u6570\u3002 \u5e38\u89c1\u654f\u611f\u51fd\u6570\u7c7b\u522b \u00b6 \u5185\u5b58\u7c7b\u578b\u7684\u654f\u611f\u51fd\u6570 \u00b6 \u6808\u6ea2\u51fa\u654f\u611f\u51fd\u6570 \u5728 MIPS \u6307\u4ee4\u96c6\u4e2d\uff0c\u7279\u522b\u662f\u667a\u80fd\u8bbe\u5907\uff0c\u4e00\u822c\u6765\u8bf4\u6808\u6ea2\u51fa\u6f0f\u6d1e\u8f83\u4e3a\u5e38\u89c1\uff0c\u4e5f\u662f\u6bd4\u8f83\u5bb9\u6613\u5229\u7528\u7684\u4e00\u7c7b\u6f0f\u6d1e\uff0c\u53d1\u751f\u6808\u6ea2\u51fa\u53ef\u80fd\u7684\u51fd\u6570\u6709 strcpy\uff0csprintf\uff0csnprint, strchr \u7b49\u3002 1\uff09 strcpy \u7c7b\u51fd\u6570\u5982\u4e0b\u6240\u793a\uff0c\u76f4\u63a5\u4ece http \u6570\u636e\u5305\u53c2\u6570\u4e2d\u7684\u6570\u636e\u5185\u5bb9\uff0c\u76f4\u63a5\u590d\u5236\u5230\u6808\u4e0a\uff0c\u6ca1\u6709\u7ecf\u8fc7\u4efb\u4f55\u7684\u5224\u65ad\u4e0e\u5904\u7406\uff0c\u56e0\u6b64\u53ef\u4ee5\u901a\u8fc7\u6808\u6ea2\u51fa\u8d8a\u754c\u7684 buffer \u8986\u76d6\u5f53\u524d\u51fd\u6570\u7684\u8fd4\u56de\u5730\u5740\uff0c\u53ef\u4ee5\u8fdb\u4e00\u6b65\u5229\u7528 ROP \u6280\u672f\u6765\u83b7\u53d6\u76ee\u6807\u7a0b\u5e8f\u7684 shell\u3002 strcpy(stack, buf_from_http); 2\uff09sprintf\u7c7b\uff0c\u5982\u679c\u683c\u5f0f\u5316\u4e2d\u6709\u201c%s\u201d\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\uff0c\u540c\u65f6\u6ca1\u6709\u5bf9\u8f93\u5165\u7684\u6570\u636e\u8fdb\u884c\u957f\u5ea6\u5224\u65ad\u7684\u8bdd\uff0c\u5219\u4e5f\u6709\u53ef\u80fd\u9020\u6210\u6808\u6ea2\u51fa\u6f0f\u6d1e\u3002 sprintf(stack, \"%s\", buf_from_http); 3) snprintf\u7c7b\uff0csnprintf \u7684\u8fd4\u56de\u503c\u662f\u8f93\u5165\u7684\u957f\u5ea6\uff0c\u800c\u4e0d\u662f\u8f93\u51fa\u7684\u957f\u5ea6\uff0c\u56e0\u6b64\u4e0b\u9762\u7684\u4ee3\u7801\u5219\u6709\u53ef\u80fd\u5b58\u5728\u6f0f\u6d1e\uff0c\u5927\u81f4\u7684\u5229\u7528\u539f\u7406\u56e0\u4e3a\uff0c\u7b2c\u4e00\u4e2asnprinf\u8fd4\u56de\u503c\u662f\u8f93\u5165\u7684\u957f\u5ea6\uff0c\u4e00\u822c\u8f93\u5165\u7684\u957f\u5ea6\u5927\u4e8esizeof(stack)\uff0c\u5219\u7b2c\u4e8c\u4e2a snprintf \u7684 size \u5219\u53d8\u4e3a\u8d1f\u6570\uff0csnprintf \u7684\u5927\u5c0f\u662f\u65e0\u7b26\u53f7\u7684\uff0c\u56e0\u6b64\u53d8\u6210\u4e86\u4e00\u4e2a\u8d85\u5927\u7684size\uff0c\u5bfc\u81f4\u7b2c\u4e8c\u4e2a\u53ef\u4ee5\u7528\u6765\u8986\u76d6\u8fd4\u56de\u5730\u5740\u3002\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u8fd9\u6837\u7c7b\u578b\u7684 overflow \u8fd8\u53ef\u4ee5\u7528\u6765bypass canary\u3002 int left = snprintf(stack, sizeof(stack),\"%s\", buf_from_http1); snprintf(stack+left, sizeof(stack)-left, \"%s\", buf_from_http2); 4\uff09 strchr\u7c7b\uff0c\u5982\u4e0b\u6240\u793a\uff0c\u4e4d\u4e00\u770b\u597d\u50cf\u4f7f\u7528\u4e86strncpy\u89c4\u5b9a\u4e86\u590d\u5236\u7684\u957f\u5ea6\uff0c\u4f46\u4ed4\u7ec6\u770b\u5c31\u4f1a\u53d1\u73b0\uff0c\u590d\u5236\u7684\u957f\u5ea6\u4e5f\u662f\u7531\u8f93\u5165\u7684\u5b57\u7b26\u4e32\u6765\u51b3\u5b9a\u7684\uff0c\u56e0\u6b64\u76f4\u63a5\u5728\uff1f\u524d\u9762\u8f93\u5165\u8d85\u957f\u7684\u5b57\u7b26\u5373\u53ef\u5b9e\u73b0overflow char *query = strchr(url, '?'); strncpy(stack, url, quey - url -1); \u5982\uff1a index.phpaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa?a=1 \u3002\u53ea\u8981 QURTY_STRING \u591f\u957f\u5c31\u53ef\u4ee5\u5bfc\u81f4\u6808\u6ea2\u51fa\u3002 \u6ce8\u5165\u7c7b\u578b\u7684\u654f\u611f\u51fd\u6570\uff08\u903b\u8f91\uff09 \u00b6 \u6ce8\u5165\u7c7b\u578b\u7684\u6f0f\u6d1e\u76f8\u5bf9\u6765\u8bf4\u5c31\u7b80\u5355\u5f88\u591a\uff0c\u53ea\u8981\u770b\u6570\u636e\u6d41\u7684\u5904\u7406\u6d41\u7a0b\uff0c\u786e\u5b9a\u8f93\u5165\u80fd\u5426\u63a7\u5236\u654f\u611f\u51fd\u6570\u5373\u53ef\u3002 \u5e38\u89c1\u7684\u654f\u611f\u51fd\u6570\u5982system\u3001popen\u3001exec\u3001execve\u7b49\uff0c\u5728\u6ce8\u5165\u7c7b\u578b\u6f0f\u6d1e\u4e2d\uff0c\u5bf9\u4e8e\u8fc7\u6ee4\u7684\u5173\u952e\u8bcd\u7ed5\u8fc7\u662f\u6bd4\u8f83\u5173\u952e\u7684\uff0c\u4f8b\u5982\u6ca1\u6709\u7a7a\u683c\u7684\u65f6\u5019\u53ef\u4ee5\u4f7f\u7528 $IFS\u8fdb\u884c\u7ed5\u8fc7\u3002\u4e5f\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e9b\u7f16\u7801\u6bd4\u5982xxd\uff0cbase64\u7b49\u3002 IDA \u81ea\u52a8\u5b9a\u4f4d\u654f\u611f\u51fd\u6570\u63d2\u4ef6 \u00b6 \u8fd9\u91cc\u63a8\u8350\u4e00\u4e2a\u6bd4\u8f83\u65b9\u4fbf\u5b9a\u4f4d\u4e8c\u8fdb\u5236\u7a0b\u5e8f\u654f\u611f\u51fd\u6570\u7684 python \u63d2\u4ef6\uff1aMipsAduit\uff0c\u9879\u76ee\u5730\u5740\uff1a https://github.com/giantbranch/mipsAudit \u8be5\u5de5\u5177\u662f\u4e00\u4e2a MIPS \u9759\u6001\u6c47\u7f16\u5ba1\u8ba1\u8f85\u52a9\u811a\u672c\uff0c\u901a\u8fc7\u654f\u611f\u51fd\u6570\u56de\u6eaf\u7684\u65b9\u6cd5\uff0c\u53ef\u4ee5\u8f83\u65b9\u4fbf\u7684\u5ba1\u8ba1\u51fa C \u8bed\u8a00\u4e2d\u7684\u5371\u9669\u51fd\u6570\u3002 \u63d2\u4ef6\u7684\u5b89\u88c5\u65b9\u6cd5 \u00b6 \u5728 IDA -> file -> Script File \u4e2d\u52a0\u8f7d\u5373\u53ef\uff0c\u52a0\u8f7d\u5b8c\u6210\u540e\u4f1a\u5728\u63a7\u5236\u53f0\u4e2d\u8f93\u51fa\u76f8\u5e94\u7684\u4fe1\u606f\u3002 \u70b9\u51fb\u76f8\u5e94\u7684\u5730\u5740\u5c31\u53ef\u4ee5\u8df3\u8f6c\u8fc7\u53bb\uff0c\u5bf9\u5e94\u7684\u4f4d\u7f6e\u4f1a\u88ab\u9ad8\u4eae\u663e\u793a\uff1a \u4f7f\u7528 IDAPython \u81ea\u5e26\u51fd\u6570\u6765\u5b9a\u4f4d\u654f\u611f\u51fd\u6570 \u00b6 IDAPython \u81ea\u5e26\u5f88\u591a\u7684 API\uff0c\u53ef\u4ee5\u4f7f\u7528\u8fd9\u8fd9\u4e9b API \u51fd\u6570\u6765\u8f85\u52a9\u6211\u4eec\u8fdb\u884c\u51fd\u6570\u7684\u5b9a\u4f4d\u3002 \u5982\uff0c\u5b9a\u4f4d\u51fa\u8c03\u7528 sprintf \u51fd\u6570\u7684\u5730\u5740\u5217\u8868\u7684\u4ee3\u7801\uff1a sprintf_list = set() for loc,name in Names(): if \"sprintf\" == name: for addr in XrefsTo(loc): # \u5217\u51fa\u8c03\u7528 sprintf \u7684\u51fd\u6570\u5730\u5740 sprintf_list.add(GetFunctionName(addr.frm)) print(\"\\n\\n\") print(sprintf_list) # \u6253\u5370\u8f93\u51fa - \u53ef\u4ee5\u76f4\u63a5\u5728 IDA \u4e2d\uff0cFile -> Script command... \u7684\u8f93\u5165\u6846\u4e2d\u8f93\u5165\u8fd9\u4e9b\u4ee3\u7801\uff0c\u70b9\u51fb run \u5c31\u53ef\u4ee5\u6267\u884c\uff1a \u8fd0\u884c\u5b8c\u6210\u4e4b\u540e\u7684\u7ed3\u679c\u4f7f\u7528 print \u51fd\u6570\u8f93\u51fa\u4e4b\u540e\uff0c\u4f1a\u6253\u5370\u5728 Output window \u4e2d\uff1a \u8fd9\u4e9b\u8f93\u51fa\u7684\u5730\u5740\u5c31\u662f\u5f15\u7528\u4e86 sprintf \u65b9\u6cd5\u7684\u51fd\u6570\uff0c\u540c\u6837\u53cc\u51fb\u51fd\u6570\u540d\u53ef\u4ee5\u76f4\u63a5\u8df3\u8f6c\u5230\u76f8\u5e94\u7684\u5730\u5740\u3002 \u8bfb\u8005\u53ef\u4ee5\u5728\u81ea\u884c\u5728 for addr in XrefsTo(loc): \u8bed\u53e5\u4e0b\u52a0\u5165\u5176\u4ed6\u8fc7\u6ee4\u8bed\u53e5\uff0c\u4ee5\u8fbe\u5230\u66f4\u51c6\u786e\u5b9a\u5236\u81ea\u5df1\u60f3\u8981\u7684\u529f\u80fd\u3002 \u5982\u8fd9\u91cc\u60f3\u8981\u6392\u9664 sytem \u654f\u611f\u51fd\u6570\u7b2c\u4e00\u4e2a\u53c2\u6570\u4e3a .data \u6bb5\u4e2d\u7684\u5b57\u7b26\uff0c\u4e14\u4e0d\u5305\u542b %s \u5b57\u7b26\u7684\u8bdd\uff08\u8bf4\u660e\u683c\u5f0f\u5316\u53c2\u6570\u4e0d\u53ef\u63a7\uff09\uff0c\u5982\u6211\u4eec\u9700\u8981\u6392\u9664\u8fd9\u79cd\u60c5\u51b5\uff1a system(\"rm -f /tmp/auth_engineer\"); \u90a3\u4e48\uff0c\u6761\u4ef6\u53ef\u4ee5\u5199\u6210\u8fd9\u6837\uff1a system_list = set() for loc,name in Names(): if \"system\" == name: for addr in XrefsTo(loc): # \u5217\u51fa\u8c03\u7528 system \u7684\u51fd\u6570\u5730\u5740 system_list.add(addr.frm) print(\"\\n\\n\") system_args_list = set() for addr in system_list: arg2_addr = 0 arg2_addr = RfirstB(addr) # \u83b7\u53d6\u5bf9 a0 \u8bed\u53e5\u8d4b\u503c\u7684\u8bed\u53e5 arg2_str = GetString(Dword(GetOperandValue(arg2_addr,1))) # \u83b7\u53d6 a0 \u53c2\u6570\u7684\u503c\u7684\u5b57\u7b26\u4e32 try: if \"%s\" not in arg2_str: system_args_list.add(addr) # \u6392\u9664\u8fd9\u79cd\u60c5\u51b5 else: pass except: pass result_list = system_list-system_args_list # \u53d6\u5dee\u96c6\uff0c\u5f97\u5230\u6700\u7ec8\u7ed3\u679c for addr in result_list: print(hex(addr)) \u5f97\u5230\u7684\u7ed3\u679c\u4e5f\u66f4\u7cbe\u786e\u4e00\u4e9b\uff1a","title":"\u654f\u611f\u51fd\u6570\u5b9a\u4f4d\u6280\u5de7"},{"location":"firmware_security/IOT_instructions_charac/found_danger_func/#iot-mips","text":"","title":"IOT \u8bbe\u5907\u6f0f\u6d1e\u6316\u6398-MIPS \u6307\u4ee4\u96c6\u9006\u5411\u6280\u5de7"},{"location":"firmware_security/IOT_instructions_charac/found_danger_func/#mips","text":"IDA \u65e0\u6cd5\u76f4\u63a5\u53cd\u6c47\u7f16 mips \u4ee3\u7801\uff0c\u4f46\u662f\u6709\u4e24\u4e2a\u63d2\u4ef6\u53ef\u4ee5\u8f85\u52a9\u6211\u4eec\u8fdb\u884c\u4f2a\u4ee3\u7801\u7684\u751f\u6210\u3002","title":"MIPS \u53cd\u6c47\u7f16\u5de5\u5177"},{"location":"firmware_security/IOT_instructions_charac/found_danger_func/#ida-retdec","text":"\u9879\u76ee\u5730\u5740\uff1a https://github.com/avast/retdec \u5b89\u88c5\u8fc7\u7a0b\u8f83\u4e3a\u7b80\u5355\uff0c\u53ef\u4ee5\u53c2\u8003\u7f51\u4e0a\u7684\u76f8\u5173\u6559\u7a0b\uff0c\u4e0d\u5728\u6b64\u8d58\u8ff0\u4e86\uff0c\u4ee5\u4e0b\u662f\u4e24\u5f20\u5206\u6790\u65f6\u5019\u7684\u622a\u56fe\uff0c\u7b2c\u4e00\u5f20\u662f\u5206\u6790\u8fc7\u7a0b\u4e2d\u7684\u622a\u56fe\uff0c\u7b2c\u4e8c\u5f20\u662f\u5206\u6790\u7684\u7ed3\u679c\u3002","title":"IDA \u63d2\u4ef6\u4e4b retdec"},{"location":"firmware_security/IOT_instructions_charac/found_danger_func/#ghidra","text":"Ghidra\u662f\u7531\u7f8e\u56fd\u56fd\u5bb6\u5b89\u5168\u5c40\uff08NSA\uff09\u7814\u7a76\u90e8\u95e8\u5f00\u53d1\u7684\u8f6f\u4ef6\u9006\u5411\u5de5\u7a0b\uff08SRE\uff09\u5957\u4ef6\uff0c\u662f\u4e00\u4e2a\u8f6f\u4ef6\u9006\u5411\u5de5\u7a0b\uff08SRE\uff09\u6846\u67b6\uff0c\u5305\u62ec\u4e00\u5957\u529f\u80fd\u9f50\u5168\u7684\u9ad8\u7aef\u8f6f\u4ef6\u5206\u6790\u5de5\u5177\uff0c\u4f7f\u7528\u6237\u80fd\u591f\u5728\u5404\u79cd\u5e73\u53f0\u4e0a\u5206\u6790\u7f16\u8bd1\u540e\u7684\u4ee3\u7801\uff0c\u5305\u62ecWindows\u3001Mac OS\u548cLinux\u3002\u529f\u80fd\u5305\u62ec\u53cd\u6c47\u7f16\uff0c\u6c47\u7f16\uff0c\u53cd\u7f16\u8bd1\uff0c\u7ed8\u56fe\u548c\u811a\u672c\uff0c\u4ee5\u53ca\u6570\u767e\u4e2a\u5176\u4ed6\u529f\u80fd\u3002Ghidra\u652f\u6301\u5404\u79cd\u5904\u7406\u5668\u6307\u4ee4\u96c6\u548c\u53ef\u6267\u884c\u683c\u5f0f\uff0c\u53ef\u4ee5\u5728\u7528\u6237\u4ea4\u4e92\u6a21\u5f0f\u548c\u81ea\u52a8\u6a21\u5f0f\u4e0b\u8fd0\u884c\u3002\u7528\u6237\u8fd8\u53ef\u4ee5\u4f7f\u7528\u516c\u5f00\u7684API\u5f00\u53d1\u81ea\u5df1\u7684Ghidra\u63d2\u4ef6\u548c\u811a\u672c\u3002 \u603b\u4e4b\u8fd9\u4e2a\u4e00\u4e2a\u529f\u80fd\u975e\u5e38\u5f3a\u5927\u7684\u53cd\u6c47\u7f16\u5de5\u5177\uff0c\u57fa\u4e8e java \u5f00\u53d1\uff0c\u53ef\u4ee5\u53cd\u6c47\u7f16\u5f88\u591a\u79cd\u7684\u6c47\u7f16\u4ee3\u7801\u7c7b\u578b\u3002\u800c\u6211\u4eec\u4f7f\u7528\u8fd9\u4e2a\u5de5\u5177\u7684\u76ee\u7684\u5c31\u662f\u56e0\u4e3a\u8fd9\u4e2a\u5de5\u5177\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u751f\u6210 mips \u7684\u4f2a C \u4ee3\u7801\u3002\u4ece\u800c\u65b9\u4fbf\u6211\u4eec\u8fdb\u884c\u4ee3\u7801\u9006\u5411\u3002 \u6709\u4e00\u6b3eGhrida\u7684\u63d2\u4ef6\u6bd4\u8f83\u9002\u7528\u4e8e\u4e60\u60ef\u4e8e\u7528IDA\u7684\u540c\u5b66\uff0c\u4f1a\u628aGhrida\u91cc\u9762\u7684\u5feb\u6377\u952e\u6620\u5c04\u6210IDA\u91cc\u9762\u7684\u5feb\u6377\u952e\uff0c\u8fd9\u6837\u7528\u8d77\u6765\u5c31\u597d\u591a\u4e86\u3002 \u63d2\u4ef6\u5730\u5740\uff1a https://github.com/enovella/ida2ghidra-kb \u63d2\u4ef6\u7684\u5b89\u88c5\u65b9\u6cd5\u8f83\u4e3a\u7b80\u5355\uff0c\u4f9d\u7167\u8bf4\u660e\u5373\u53ef\u3002\u5b9e\u73b0\u4e86\u5305\u62ecx\u3001g\u7b49IDA\u4e2d\u5feb\u6377\u952e\u529f\u80fd\u3002 \u53e6\u5916\uff0c\u9700\u8981\u4e3b\u8981\uff0c\u5728\u4f7f\u7528Ghrida\u5206\u6790MIPS\u7684\u65f6\u5019\uff0cPLT\u548cGOT\u7684\u65f6\u5019\u7ecf\u5e38\u4f1a\u51fa\u73b0\u95ee\u9898\uff0c\u5982\u56fe\u6240\u793a\uff1a \u5982\u679c\u4f60\u9700\u8981\u5b9a\u4f4dGOT\u8868\uff0c\u8fd8\u662f\u9700\u8981\u4f7f\u7528IDA\u67e5\u627e\u66f4\u4e3a\u76f4\u89c2\u65b9\u4fbf\u3002 xxxkkk@\u6d77\u7279\u5b9e\u9a8c\u5ba4","title":"Ghidra"},{"location":"firmware_security/IOT_instructions_charac/found_danger_func/#_1","text":"\u6211\u4eec\u5728\u9006\u5411\u5206\u6790\u4e00\u4e2a mips \u6307\u4ee4\u96c6\u67b6\u6784\u7684\u4e8c\u8fdb\u5236\u7a0b\u5e8f\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528\u654f\u611f\u51fd\u6570\u5b9a\u4f4d\u7684\u65b9\u6cd5\uff0c\u5feb\u901f\u5b9a\u4f4d\u654f\u611f\u51fd\u6570\uff0c\u5982 system\u3001sprintf\u3001strcpy \u7b49\u547d\u4ee4\u6267\u884c\u548c\u5bb9\u6613\u53d1\u751f\u6808\u6ea2\u51fa\u7684\u51fd\u6570\u3002","title":"\u654f\u611f\u51fd\u6570\u5b9a\u4f4d"},{"location":"firmware_security/IOT_instructions_charac/found_danger_func/#_2","text":"","title":"\u5e38\u89c1\u654f\u611f\u51fd\u6570\u7c7b\u522b"},{"location":"firmware_security/IOT_instructions_charac/found_danger_func/#_3","text":"\u6808\u6ea2\u51fa\u654f\u611f\u51fd\u6570 \u5728 MIPS \u6307\u4ee4\u96c6\u4e2d\uff0c\u7279\u522b\u662f\u667a\u80fd\u8bbe\u5907\uff0c\u4e00\u822c\u6765\u8bf4\u6808\u6ea2\u51fa\u6f0f\u6d1e\u8f83\u4e3a\u5e38\u89c1\uff0c\u4e5f\u662f\u6bd4\u8f83\u5bb9\u6613\u5229\u7528\u7684\u4e00\u7c7b\u6f0f\u6d1e\uff0c\u53d1\u751f\u6808\u6ea2\u51fa\u53ef\u80fd\u7684\u51fd\u6570\u6709 strcpy\uff0csprintf\uff0csnprint, strchr \u7b49\u3002 1\uff09 strcpy \u7c7b\u51fd\u6570\u5982\u4e0b\u6240\u793a\uff0c\u76f4\u63a5\u4ece http \u6570\u636e\u5305\u53c2\u6570\u4e2d\u7684\u6570\u636e\u5185\u5bb9\uff0c\u76f4\u63a5\u590d\u5236\u5230\u6808\u4e0a\uff0c\u6ca1\u6709\u7ecf\u8fc7\u4efb\u4f55\u7684\u5224\u65ad\u4e0e\u5904\u7406\uff0c\u56e0\u6b64\u53ef\u4ee5\u901a\u8fc7\u6808\u6ea2\u51fa\u8d8a\u754c\u7684 buffer \u8986\u76d6\u5f53\u524d\u51fd\u6570\u7684\u8fd4\u56de\u5730\u5740\uff0c\u53ef\u4ee5\u8fdb\u4e00\u6b65\u5229\u7528 ROP \u6280\u672f\u6765\u83b7\u53d6\u76ee\u6807\u7a0b\u5e8f\u7684 shell\u3002 strcpy(stack, buf_from_http); 2\uff09sprintf\u7c7b\uff0c\u5982\u679c\u683c\u5f0f\u5316\u4e2d\u6709\u201c%s\u201d\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\uff0c\u540c\u65f6\u6ca1\u6709\u5bf9\u8f93\u5165\u7684\u6570\u636e\u8fdb\u884c\u957f\u5ea6\u5224\u65ad\u7684\u8bdd\uff0c\u5219\u4e5f\u6709\u53ef\u80fd\u9020\u6210\u6808\u6ea2\u51fa\u6f0f\u6d1e\u3002 sprintf(stack, \"%s\", buf_from_http); 3) snprintf\u7c7b\uff0csnprintf \u7684\u8fd4\u56de\u503c\u662f\u8f93\u5165\u7684\u957f\u5ea6\uff0c\u800c\u4e0d\u662f\u8f93\u51fa\u7684\u957f\u5ea6\uff0c\u56e0\u6b64\u4e0b\u9762\u7684\u4ee3\u7801\u5219\u6709\u53ef\u80fd\u5b58\u5728\u6f0f\u6d1e\uff0c\u5927\u81f4\u7684\u5229\u7528\u539f\u7406\u56e0\u4e3a\uff0c\u7b2c\u4e00\u4e2asnprinf\u8fd4\u56de\u503c\u662f\u8f93\u5165\u7684\u957f\u5ea6\uff0c\u4e00\u822c\u8f93\u5165\u7684\u957f\u5ea6\u5927\u4e8esizeof(stack)\uff0c\u5219\u7b2c\u4e8c\u4e2a snprintf \u7684 size \u5219\u53d8\u4e3a\u8d1f\u6570\uff0csnprintf \u7684\u5927\u5c0f\u662f\u65e0\u7b26\u53f7\u7684\uff0c\u56e0\u6b64\u53d8\u6210\u4e86\u4e00\u4e2a\u8d85\u5927\u7684size\uff0c\u5bfc\u81f4\u7b2c\u4e8c\u4e2a\u53ef\u4ee5\u7528\u6765\u8986\u76d6\u8fd4\u56de\u5730\u5740\u3002\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u8fd9\u6837\u7c7b\u578b\u7684 overflow \u8fd8\u53ef\u4ee5\u7528\u6765bypass canary\u3002 int left = snprintf(stack, sizeof(stack),\"%s\", buf_from_http1); snprintf(stack+left, sizeof(stack)-left, \"%s\", buf_from_http2); 4\uff09 strchr\u7c7b\uff0c\u5982\u4e0b\u6240\u793a\uff0c\u4e4d\u4e00\u770b\u597d\u50cf\u4f7f\u7528\u4e86strncpy\u89c4\u5b9a\u4e86\u590d\u5236\u7684\u957f\u5ea6\uff0c\u4f46\u4ed4\u7ec6\u770b\u5c31\u4f1a\u53d1\u73b0\uff0c\u590d\u5236\u7684\u957f\u5ea6\u4e5f\u662f\u7531\u8f93\u5165\u7684\u5b57\u7b26\u4e32\u6765\u51b3\u5b9a\u7684\uff0c\u56e0\u6b64\u76f4\u63a5\u5728\uff1f\u524d\u9762\u8f93\u5165\u8d85\u957f\u7684\u5b57\u7b26\u5373\u53ef\u5b9e\u73b0overflow char *query = strchr(url, '?'); strncpy(stack, url, quey - url -1); \u5982\uff1a index.phpaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa?a=1 \u3002\u53ea\u8981 QURTY_STRING \u591f\u957f\u5c31\u53ef\u4ee5\u5bfc\u81f4\u6808\u6ea2\u51fa\u3002","title":"\u5185\u5b58\u7c7b\u578b\u7684\u654f\u611f\u51fd\u6570"},{"location":"firmware_security/IOT_instructions_charac/found_danger_func/#_4","text":"\u6ce8\u5165\u7c7b\u578b\u7684\u6f0f\u6d1e\u76f8\u5bf9\u6765\u8bf4\u5c31\u7b80\u5355\u5f88\u591a\uff0c\u53ea\u8981\u770b\u6570\u636e\u6d41\u7684\u5904\u7406\u6d41\u7a0b\uff0c\u786e\u5b9a\u8f93\u5165\u80fd\u5426\u63a7\u5236\u654f\u611f\u51fd\u6570\u5373\u53ef\u3002 \u5e38\u89c1\u7684\u654f\u611f\u51fd\u6570\u5982system\u3001popen\u3001exec\u3001execve\u7b49\uff0c\u5728\u6ce8\u5165\u7c7b\u578b\u6f0f\u6d1e\u4e2d\uff0c\u5bf9\u4e8e\u8fc7\u6ee4\u7684\u5173\u952e\u8bcd\u7ed5\u8fc7\u662f\u6bd4\u8f83\u5173\u952e\u7684\uff0c\u4f8b\u5982\u6ca1\u6709\u7a7a\u683c\u7684\u65f6\u5019\u53ef\u4ee5\u4f7f\u7528 $IFS\u8fdb\u884c\u7ed5\u8fc7\u3002\u4e5f\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e9b\u7f16\u7801\u6bd4\u5982xxd\uff0cbase64\u7b49\u3002","title":"\u6ce8\u5165\u7c7b\u578b\u7684\u654f\u611f\u51fd\u6570\uff08\u903b\u8f91\uff09"},{"location":"firmware_security/IOT_instructions_charac/found_danger_func/#ida","text":"\u8fd9\u91cc\u63a8\u8350\u4e00\u4e2a\u6bd4\u8f83\u65b9\u4fbf\u5b9a\u4f4d\u4e8c\u8fdb\u5236\u7a0b\u5e8f\u654f\u611f\u51fd\u6570\u7684 python \u63d2\u4ef6\uff1aMipsAduit\uff0c\u9879\u76ee\u5730\u5740\uff1a https://github.com/giantbranch/mipsAudit \u8be5\u5de5\u5177\u662f\u4e00\u4e2a MIPS \u9759\u6001\u6c47\u7f16\u5ba1\u8ba1\u8f85\u52a9\u811a\u672c\uff0c\u901a\u8fc7\u654f\u611f\u51fd\u6570\u56de\u6eaf\u7684\u65b9\u6cd5\uff0c\u53ef\u4ee5\u8f83\u65b9\u4fbf\u7684\u5ba1\u8ba1\u51fa C \u8bed\u8a00\u4e2d\u7684\u5371\u9669\u51fd\u6570\u3002","title":"IDA \u81ea\u52a8\u5b9a\u4f4d\u654f\u611f\u51fd\u6570\u63d2\u4ef6"},{"location":"firmware_security/IOT_instructions_charac/found_danger_func/#_5","text":"\u5728 IDA -> file -> Script File \u4e2d\u52a0\u8f7d\u5373\u53ef\uff0c\u52a0\u8f7d\u5b8c\u6210\u540e\u4f1a\u5728\u63a7\u5236\u53f0\u4e2d\u8f93\u51fa\u76f8\u5e94\u7684\u4fe1\u606f\u3002 \u70b9\u51fb\u76f8\u5e94\u7684\u5730\u5740\u5c31\u53ef\u4ee5\u8df3\u8f6c\u8fc7\u53bb\uff0c\u5bf9\u5e94\u7684\u4f4d\u7f6e\u4f1a\u88ab\u9ad8\u4eae\u663e\u793a\uff1a","title":"\u63d2\u4ef6\u7684\u5b89\u88c5\u65b9\u6cd5"},{"location":"firmware_security/IOT_instructions_charac/found_danger_func/#idapython","text":"IDAPython \u81ea\u5e26\u5f88\u591a\u7684 API\uff0c\u53ef\u4ee5\u4f7f\u7528\u8fd9\u8fd9\u4e9b API \u51fd\u6570\u6765\u8f85\u52a9\u6211\u4eec\u8fdb\u884c\u51fd\u6570\u7684\u5b9a\u4f4d\u3002 \u5982\uff0c\u5b9a\u4f4d\u51fa\u8c03\u7528 sprintf \u51fd\u6570\u7684\u5730\u5740\u5217\u8868\u7684\u4ee3\u7801\uff1a sprintf_list = set() for loc,name in Names(): if \"sprintf\" == name: for addr in XrefsTo(loc): # \u5217\u51fa\u8c03\u7528 sprintf \u7684\u51fd\u6570\u5730\u5740 sprintf_list.add(GetFunctionName(addr.frm)) print(\"\\n\\n\") print(sprintf_list) # \u6253\u5370\u8f93\u51fa - \u53ef\u4ee5\u76f4\u63a5\u5728 IDA \u4e2d\uff0cFile -> Script command... \u7684\u8f93\u5165\u6846\u4e2d\u8f93\u5165\u8fd9\u4e9b\u4ee3\u7801\uff0c\u70b9\u51fb run \u5c31\u53ef\u4ee5\u6267\u884c\uff1a \u8fd0\u884c\u5b8c\u6210\u4e4b\u540e\u7684\u7ed3\u679c\u4f7f\u7528 print \u51fd\u6570\u8f93\u51fa\u4e4b\u540e\uff0c\u4f1a\u6253\u5370\u5728 Output window \u4e2d\uff1a \u8fd9\u4e9b\u8f93\u51fa\u7684\u5730\u5740\u5c31\u662f\u5f15\u7528\u4e86 sprintf \u65b9\u6cd5\u7684\u51fd\u6570\uff0c\u540c\u6837\u53cc\u51fb\u51fd\u6570\u540d\u53ef\u4ee5\u76f4\u63a5\u8df3\u8f6c\u5230\u76f8\u5e94\u7684\u5730\u5740\u3002 \u8bfb\u8005\u53ef\u4ee5\u5728\u81ea\u884c\u5728 for addr in XrefsTo(loc): \u8bed\u53e5\u4e0b\u52a0\u5165\u5176\u4ed6\u8fc7\u6ee4\u8bed\u53e5\uff0c\u4ee5\u8fbe\u5230\u66f4\u51c6\u786e\u5b9a\u5236\u81ea\u5df1\u60f3\u8981\u7684\u529f\u80fd\u3002 \u5982\u8fd9\u91cc\u60f3\u8981\u6392\u9664 sytem \u654f\u611f\u51fd\u6570\u7b2c\u4e00\u4e2a\u53c2\u6570\u4e3a .data \u6bb5\u4e2d\u7684\u5b57\u7b26\uff0c\u4e14\u4e0d\u5305\u542b %s \u5b57\u7b26\u7684\u8bdd\uff08\u8bf4\u660e\u683c\u5f0f\u5316\u53c2\u6570\u4e0d\u53ef\u63a7\uff09\uff0c\u5982\u6211\u4eec\u9700\u8981\u6392\u9664\u8fd9\u79cd\u60c5\u51b5\uff1a system(\"rm -f /tmp/auth_engineer\"); \u90a3\u4e48\uff0c\u6761\u4ef6\u53ef\u4ee5\u5199\u6210\u8fd9\u6837\uff1a system_list = set() for loc,name in Names(): if \"system\" == name: for addr in XrefsTo(loc): # \u5217\u51fa\u8c03\u7528 system \u7684\u51fd\u6570\u5730\u5740 system_list.add(addr.frm) print(\"\\n\\n\") system_args_list = set() for addr in system_list: arg2_addr = 0 arg2_addr = RfirstB(addr) # \u83b7\u53d6\u5bf9 a0 \u8bed\u53e5\u8d4b\u503c\u7684\u8bed\u53e5 arg2_str = GetString(Dword(GetOperandValue(arg2_addr,1))) # \u83b7\u53d6 a0 \u53c2\u6570\u7684\u503c\u7684\u5b57\u7b26\u4e32 try: if \"%s\" not in arg2_str: system_args_list.add(addr) # \u6392\u9664\u8fd9\u79cd\u60c5\u51b5 else: pass except: pass result_list = system_list-system_args_list # \u53d6\u5dee\u96c6\uff0c\u5f97\u5230\u6700\u7ec8\u7ed3\u679c for addr in result_list: print(hex(addr)) \u5f97\u5230\u7684\u7ed3\u679c\u4e5f\u66f4\u7cbe\u786e\u4e00\u4e9b\uff1a","title":"\u4f7f\u7528 IDAPython \u81ea\u5e26\u51fd\u6570\u6765\u5b9a\u4f4d\u654f\u611f\u51fd\u6570"},{"location":"firmware_security/IOT_instructions_charac/stackoverflow_exploit/","text":"xxxkkk@\u6d77\u7279\u5b9e\u9a8c\u5ba4 \u6982\u8ff0 \u00b6 \u56e0\u4e3a MIPS \u6307\u4ee4\u96c6\u4e0d\u540c\u4e8e X86 \u6307\u4ee4\u96c6\u67b6\u6784\uff0c\u6240\u4ee5\u5728\u6808\u6ea2\u51fa\u7684\u5229\u7528\u65b9\u5f0f\u4e0a\u6709\u6240\u5dee\u522b\uff0cROP \u94fe\u7684\u6784\u9020\u4e5f\u4e0d\u5c3d\u76f8\u540c\uff0c\u8fd9\u91cc\u6982\u8ff0\u4e00\u4e0b\u5173\u4e8e MIPS \u6808\u6ea2\u51fa\u5229\u7528\u7684\u6280\u5de7\u548c\u7279\u70b9\u3002 \u5e38\u89c1\u5bfb\u627eMIPS Gardget\u5de5\u5177 \u00b6 ROPgardget \u6700\u5e38\u89c1\uff0c\u6700\u901a\u7528\u7684\u5168\u5e73\u53f0\u5bfb\u627eGardget\u5de5\u5177 > ROPgadget --binary libc.so.6 ...... 0x00049298 : xori $v0, $v0, 2 ; sw $v0, 0x1c($sp) ; lw $t9, -0x6d14($gp) ; jalr $t9 ; addiu $a0, $sp, 0x20 0x000492f0 : xori $v0, $v0, 2 ; sw $v0, 8($s1) ; lw $v0, 0x38($sp) ; sw $v0, 4($s1) ; move $v0, $v1 ; lw $ra, 0x54($sp) ; lw $s2, 0x50($sp) ; lw $s1, 0x4c($sp) ; lw $s0, 0x48($sp) ; jr $ra ; addiu $sp, $sp, 0x58 0x000b03a4 : xori $v0, $v1, 0x1f ; movn $a3, $zero, $v0 ; addiu $a0, $zero, 4 ; lw $a1, -0x7fd8($gp) ; addiu $a1, $a1, 0x6c08 ; lw $a2, -0x7fd8($gp) ; lw $t9, -0x7940($gp) ; jalr $t9 ; addiu $a2, $a2, 0x6c40 0x00040708 : xori $v0, $v1, 1 ; addiu $v1, $zero, 1 ; xori $v0, $v1, 1 ; andi $v0, $v0, 0xff ; b 0x40780 ; andi $v1, $v0, 0xff ; move $a0, $a1 ; lw $t9, -0x6ebc($gp) ; jalr $t9 ; move $a1, $s1 0x00040710 : xori $v0, $v1, 1 ; andi $v0, $v0, 0xff ; b 0x40778 ; andi $v1, $v0, 0xff ; move $a0, $a1 ; lw $t9, -0x6ebc($gp) ; jalr $t9 ; move $a1, $s1 0x000d2dc4 : xori $v1, $a3, 8 ; lw $t9, -0x75f4($gp) ; jalr $t9 ; nop 0x000accbc : xori $v1, $fp, 1 ; addiu $a0, $zero, 0x1c ; addiu $v0, $zero, 2 ; movz $a0, $v0, $v1 ; lw $t9, -0x7fa4($gp) ; addiu $t9, $t9, -0x4748 ; jalr $t9 ; sw $a0, 0x44($sp) 0x000b941c : xori $v1, $v0, 1 ; addiu $v0, $zero, -1 ; movz $v0, $zero, $v1 ; lw $ra, 0x28($sp) ; jr $ra ; addiu $sp, $sp, 0x30 0x000b93ac : xori $v1, $v0, 1 ; addiu $v0, $zero, -1 ; movz $v0, $zero, $v1 ; lw $ra, 0x30($sp) ; jr $ra ; addiu $sp, $sp, 0x38 Unique gadgets found: 114925 \u4f18\u70b9\uff1a\u901a\u7528\uff0c\u5404\u5e73\u53f0\u90fd\u80fd\u4e00\u952e\u627e\uff0c\u627e\u7279\u5b9a\u5730\u5740\u7684Gardget\u4e5f\u8fd8\u7528 \u7f3a\u70b9\uff1a\u627eMIPS\u7684\u65f6\u5019\u7a0d\u5fae\u9700\u8981\u4e00\u70b9\u7279\u522b\u7684\u6280\u5de7 MIPSROP ( https://github.com/devttys0/ida/tree/master/plugins/mipsrop ) IDA\u91cc\u9762\u7684\u63d2\u4ef6\uff0c\u4e13\u95e8\u9488\u5bf9MIPS \u4f18\u70b9\uff1a\u9488\u5bf9\u6027\u5f3a\uff0c\u6709\u5f88\u591a\u9009\u9879\u80fd\u627e\u6ee1\u8db3ROP\u8981\u6c42\u7684\u7279\u5b9a\u7684Gardget \u7f3a\u70b9\uff1a\u5176\u4ed6\u67b6\u6784\u4e0d\u884c\uff08\u540d\u5b57\u5c31\u53ebMIPS\uff09 \u5e38\u89c1Gardget\u5206\u6790 \u00b6 \u4e3a\u4e86\u4e86\u89e3MIPS\u4e0b\u6808\u6ea2\u51fa\u7684\u5229\u7528\uff0c\u9996\u5148\u5f97\u5bf9MIPS\u7684\u4f20\u53c2\u7ea6\u5b9a\u6709\u4e00\u4e2a\u57fa\u672c\u7684\u4e86\u89e3\u3002 MIPS\u670932\u4e2a\u901a\u7528\u5bc4\u5b58\u5668\uff08 0- 0- 31\uff09\uff0c\u5404\u5bc4\u5b58\u5668\u7684\u529f\u80fd\u53ca\u6c47\u7f16\u7a0b\u5e8f\u4e2d\u4f7f\u7528\u7ea6\u5b9a\u5982\u4e0b \u5176\u4e2d\u6bd4\u8f83\u91cd\u8981\u7684\u662f v0\u4e3a\u51fd\u6570\u8fd4\u56de\u503c\u5b58\u653e\u7684\u5bc4\u5b58\u5668\uff0c v0\u4e3a\u51fd\u6570\u8fd4\u56de\u503c\u5b58\u653e\u7684\u5bc4\u5b58\u5668\uff0c ra\u5b58\u5728\u8fd4\u56de\u5730\u5740\uff0c a0- a0- a3\u5b58\u5728\u51fd\u6570\u7684\u56db\u4e2a\u8c03\u7528\u53c2\u6570\uff0c\u5f53\u9700\u8981\u4f7f\u7528\u66f4\u591a\u7684\u5bc4\u5b58\u5668\u65f6\uff0c\u5c31\u9700\u8981\u5806\u6808\uff08stack)\u4e86,\u9700\u8981\u6ce8\u610f\u7684\u662fMIPS\u7f16\u8bd1\u5668\u603b\u662f\u4e3a\u53c2\u6570\u5728\u5806\u6808\u4e2d\u7559\u6709\u7a7a\u95f4\u4ee5\u9632\u6709\u53c2\u6570\u9700\u8981\u5b58\u50a8\u3002 \u56e0\u6b64\u5bf9\u4e8e\u4f7f\u7528ROP\u8fdb\u884c\u4e00\u822c\u7684\u51fd\u6570\u64cd\u4f5c\u6765\u8bf4\uff0c\u5bc4\u5b58\u5668\u7684\u56db\u4e2a\u53c2\u6570\u5df2\u7ecf\u8db3\u591f\u4e86\uff0c\u56e0\u6b64\u63a7\u5236\u8fd9\u4e2a\u56db\u4e2a\u5bc4\u5b58\u5668\u5bf9\u4e8eROP\u6765\u8bf4\u6bd4\u8f83\u5173\u952e\u3002 \u901a\u7528\u7684 gadget \u6bb5 \u00b6 \u5728uclibc\u5e93\u4e2d\uff0c\u6709\u51e0\u4e2a\u6bd4\u8f83\u5173\u952e\u7684gadget\uff0c\u5728 scandir \u7684\u5c3e\u90e8\u6216\u8005 scandir64 \u7684\u5c3e\u90e8\uff0c\u4ece\u56fe\u4e0a\u770b\u57fa\u672c\u4e0a\u53ef\u4ee5\u8bbe\u7f6e\u6240\u6709\u5bc4\u5b58\u5668\u503c\uff0c\u4eces0-s7 \u6709\u4e00\u6761\u6bd4\u8f83\u5e38\u89c4\u7684ROP\u94fe\uff0c\u6267\u884c\u7684\u6574\u4f53\u6d41\u7a0b\u4e3a sleep(1) -> read_value_from_stack -> jump to stack(shellcode) \u5229\u7528\u6d41\u7a0b \u00b6 \u9996\u5148\u5bfb\u627e\u4e00\u4e2a\u8bbe\u7f6ea0\u4e3a\u5e38\u91cf\u7684Gardget\uff0c\u53ef\u4ee5\u4f7f\u7528MIPSRop\u5bfb\u627e\u8bbe\u7f6ea0\u5bc4\u5b58\u5668\u7684Gardget Python>mipsrop.find(\"li $a0,\") ---------------------------------------------------------------------------------------------------------------- | Address | Action | Control Jump | ---------------------------------------------------------------------------------------------------------------- | 0x004608C0 | li $a0,0xE10 | jalr $v0 | | 0x0042F5B0 | li $a0,0xE | jr 0x28+var_8($sp) | | 0x004314B8 | li $a0,4 | jr 0x20+var_8($sp) | | 0x00437E90 | li $a0,0xFFFFFFFF | jr 0x20+var_8($sp) | | 0x00439F68 | li $a0,8 | jr 0x20+var_8($sp) | ---------------------------------------------------------------------------------------------------------------- Found 5 matching gadgets \u5176\u6b21\uff0c\u4ece\u5185\u5b58\u52a0\u8f7d\u6570\u636e\u5230\u5bc4\u5b58\u5668 LOAD:0001E20C move $t9, $s1 LOAD:0001E210 lw $ra, 0x28+var_4($sp) LOAD:0001E214 lw $s2, 0x28+var_8($sp) LOAD:0001E218 lw $s1, 0x28+var_C($sp) LOAD:0001E21C lw $s0, 0x28+var_10($sp) LOAD:0001E220 jr $t9 LOAD:0001E224 addiu $sp, 0x28 \u7136\u540e\uff0c\u628a\u6808\u5730\u5740\u653e\u5230\u5bc4\u5b58\u5668\u4e2d mipsrop.stackfinder() ---------------------------------------------------------------------------------------------------------------- | Address | Action | Control Jump | ---------------------------------------------------------------------------------------------------------------- | 0x0041FF7C | addiu $s0,$sp,0xA10+var_9F0 | jalr $s5 | | 0x00436D80 | addiu $s2,$sp,0x448+var_430 | jalr $s0 | | 0x00437B7C | addiu $s1,$sp,0x458+var_438 | jalr $s0 | | 0x0043FE54 | addiu $a1,$sp,0x478+var_448 | jalr $s7 | | 0x00451B18 | addiu $v0,$sp,0x88+var_78 | jalr $v0 | | 0x00451B8C | addiu $v0,$sp,0x98+var_88 | jalr $v0 | | 0x00451C00 | addiu $v0,$sp,0xA8+var_98 | jalr $v0 | | 0x004520D4 | addiu $v0,$sp,0xB8+var_A8 | jalr $v0 | | 0x0045215C | addiu $v0,$sp,0xB8+var_A8 | jalr $v0 | | 0x004521D0 | addiu $v0,$sp,0xD8+var_C8 | jalr $v0 | | 0x00452240 | addiu $v0,$sp,0xD8+var_C8 | jalr $v0 | | 0x004522B0 | addiu $v0,$sp,0xB8+var_A8 | jalr $v0 | | 0x00452340 | addiu $v0,$sp,0xB8+var_A8 | jalr $v0 | | 0x004523CC | addiu $v0,$sp,0xB8+var_A8 | jalr $v0 | | 0x004529C4 | addiu $v0,$sp,0x918+var_900 | jalr $v0 | | 0x00452A44 | addiu $v0,$sp,0x928+var_910 | jalr $v0 | | 0x00452AB8 | addiu $v0,$sp,0x938+src | jalr $v0 | | 0x00452B48 | addiu $v0,$sp,0x948+var_930 | jalr $v0 | | 0x00452BBC | addiu $v0,$sp,0x968+var_950 | jalr $v0 | | 0x00452C2C | addiu $v0,$sp,0x968+var_950 | jalr $v0 | | 0x00452C9C | addiu $v0,$sp,0x948+var_930 | jalr $v0 | | 0x00452D1C | addiu $v0,$sp,0x948+var_930 | jalr $v0 | | 0x00452DAC | addiu $v0,$sp,0x948+var_930 | jalr $v0 | | 0x00452E38 | addiu $v0,$sp,0x948+var_930 | jalr $v0 | | 0x004559D4 | addiu $v0,$sp,0x278+var_268 | jalr $v0 | | 0x00455A3C | addiu $v0,$sp,0x288+var_278 | jalr $v0 | | 0x00455AD0 | addiu $v0,$sp,0x288+var_278 | jalr $v0 | | 0x00455B48 | addiu $v0,$sp,0x298+var_288 | jalr $v0 | | 0x00455BC8 | addiu $v0,$sp,0x298+var_288 | jalr $v0 | | 0x00455C58 | addiu $v0,$sp,0x298+var_288 | jalr $v0 | | 0x00455D0C | addiu $v0,$sp,0x298+var_288 | jalr $v0 | | 0x00414E6C | addiu $a0,$sp,0x138+arg_0 | jr 0x138+var_4($sp) | | 0x00416584 | addiu $a0,$sp,0x340+var_328 | jr 0x340+var_8($sp) | | 0x00416680 | addiu $a0,$sp,0x340+var_328 | jr 0x340+var_8($sp) | | 0x0041677C | addiu $a0,$sp,0x340+var_328 | jr 0x340+var_8($sp) | | 0x00416878 | addiu $a0,$sp,0x340+var_328 | jr 0x340+var_8($sp) | | 0x004169AC | addiu $a0,$sp,0x348+var_330 | jr 0x348+var_8($sp) | | 0x00417728 | addiu $a0,$sp,0x138+var_11C | jr 0x138+var_4($sp) | | 0x0041C928 | addiu $a1,$sp,0x28+var_10 | jr 0x28+var_8($sp) | | 0x0042C3B8 | addiu $a0,$sp,0xB0+var_48 | jr 0xB0+var_4($sp) | | 0x00438C3C | addiu $a2,$sp,0x428+var_410 | jr 0x428+var_8($sp) | | 0x0043FB8C | addiu $a0,$sp,0x50+var_30 | jr 0x50+var_8($sp) | | 0x004403DC | addiu $a0,$sp,0x850+var_830 | jr 0x850+var_8($sp) | ---------------------------------------------------------------------------------------------------------------- Found 43 matching gadgets \u6700\u540e\u8df3\u5230shellcode\u4e2d mipsrop.find(\"move $t9, $s2\") ---------------------------------------------------------------------------------------------------------------- | Address | Action | Control Jump | ---------------------------------------------------------------------------------------------------------------- | 0x0001C890 | move $t9,$s2 | jalr $s2 | | 0x0001C8AC | move $t9,$s2 | jalr $s2 | | 0x0001C8E0 | move $t9,$s2 | jalr $s2 | | 0x0001C914 | move $t9,$s2 | jalr $s2 | | 0x0001CB40 | move $t9,$s2 | jalr $s2 | | 0x0001DC58 | move $t9,$s2 | jalr $s2 | | 0x0001DC6C | move $t9,$s2 | jalr $s2 | | 0x0002A89C | move $t9,$s2 | jalr $s2 | | 0x0002A8B4 | move $t9,$s2 | jalr $s2 | | 0x00043398 | move $t9,$s2 | jalr $s2 | | 0x00047458 | move $t9,$s2 | jalr $s2 | | 0x00047474 | move $t9,$s2 | jalr $s2 | | 0x00053110 | move $t9,$s2 | jalr $s2 | | 0x00053648 | move $t9,$s2 | jalr $s2 | | 0x0005371C | move $t9,$s2 | jalr $s2 | | 0x000556A8 | move $t9,$s2 | jalr $s2 | | 0x000556CC | move $t9,$s2 | jalr $s2 | | 0x00055768 | move $t9,$s2 | jalr $s2 | | 0x0005578C | move $t9,$s2 | jalr $s2 | | 0x0005674C | move $t9,$s2 | jalr $s2 | | 0x00056770 | move $t9,$s2 | jalr $s2 | | 0x0005680C | move $t9,$s2 | jalr $s2 | | 0x00056830 | move $t9,$s2 | jalr $s2 | | 0x00057B24 | move $t9,$s2 | jalr $s2 | | 0x000580C4 | move $t9,$s2 | jalr $s2 | | 0x00058E9C | move $t9,$s2 | jalr $s2 | | 0x00058EC0 | move $t9,$s2 | jalr $s2 | | 0x00058F5C | move $t9,$s2 | jalr $s2 | | 0x00058F80 | move $t9,$s2 | jalr $s2 | | 0x0005A064 | move $t9,$s2 | jalr $s2 | | 0x0005A4C0 | move $t9,$s2 | jalr $s2 | | 0x0005AA4C | move $t9,$s2 | jalr $s2 | | 0x0005AF30 | move $t9,$s2 | jalr $s2 | | 0x0005BD14 | move $t9,$s2 | jalr $s2 | | 0x0005BD40 | move $t9,$s2 | jalr $s2 | | 0x0005D4AC | move $t9,$s2 | jalr $s2 | | 0x0005D4F0 | move $t9,$s2 | jalr $s2 | | 0x0005DDCC | move $t9,$s2 | jalr $s2 | | 0x0005DDF8 | move $t9,$s2 | jalr $s2 | | 0x0005E37C | move $t9,$s2 | jalr $s2 | | 0x0006052C | move $t9,$s2 | jalr $s2 | | 0x00060548 | move $t9,$s2 | jalr $s2 | | 0x00060564 | move $t9,$s2 | jalr $s2 | | 0x00062888 | move $t9,$s2 | jalr $s2 | | 0x0006D8F8 | move $t9,$s2 | jalr $s2 | | 0x000765E4 | move $t9,$s2 | jalr $s2 | | 0x000766B0 | move $t9,$s2 | jalr $s2 | | 0x00078720 | move $t9,$s2 | jalr $s2 | | 0x0007A23C | move $t9,$s2 | jalr $s2 | | 0x0007A2C4 | move $t9,$s2 | jalr $s2 | | 0x0008EE68 | move $t9,$s2 | jalr $s2 | | 0x0008F30C | move $t9,$s2 | jalr $s2 | | 0x0009453C | move $t9,$s2 | jalr $s2 | | 0x0009457C | move $t9,$s2 | jalr $s2 | | 0x00098264 | move $t9,$s2 | jalr $s2 | | 0x000AF9E8 | move $t9,$s2 | jalr $s2 | | 0x000B088C | move $t9,$s2 | jalr $s2 | | 0x000B4148 | move $t9,$s2 | jalr $s2 | | 0x000B46BC | move $t9,$s2 | jalr $s2 | | 0x000B471C | move $t9,$s2 | jalr $s2 | | 0x000BCF18 | move $t9,$s2 | jalr $s2 | | 0x000BCFF0 | move $t9,$s2 | jalr $s2 | | 0x000BD01C | move $t9,$s2 | jalr $s2 | | 0x000DB248 | move $t9,$s2 | jalr $s2 | | 0x000DB3F4 | move $t9,$s2 | jalr $s2 | | 0x000DB4C8 | move $t9,$s2 | jalr $s2 | | 0x000DB6DC | move $t9,$s2 | jalr $s2 | | 0x000DB838 | move $t9,$s2 | jalr $s2 | | 0x000DBA34 | move $t9,$s2 | jalr $s2 | | 0x000DBC24 | move $t9,$s2 | jalr $s2 | | 0x000DBDE8 | move $t9,$s2 | jalr $s2 | | 0x000DBF74 | move $t9,$s2 | jalr $s2 | | 0x000E5D88 | move $t9,$s2 | jalr $s2 | | 0x000E5DA0 | move $t9,$s2 | jalr $s2 | ---------------------------------------------------------------------------------------------------------------- \u8fd9\u4e2a\u94fe\u662f\u76f8\u5bf9\u6765\u8bf4\u6700\u901a\u7528\u7684\u4e00\u4e2a\u94fe\uff0c\u7531\u4e8eMIPS\u7684\u7279\u6027\uff0c\u5bf9\u4e8e\u9700\u8981Sleep\u4e2d\u65ad\u4e00\u4e0b\uff0c\u624d\u53ef\u4ee5\u76f4\u63a5\u8df3\u5230stack\u4e2d\u7684shellcode\uff0c\u4f46\u662f\u8981\u6c42nx\u6ca1\u5f00\uff0clibc\u7684\u5730\u5740\u4e5f\u662f\u77e5\u9053\u7684\uff0c\u901a\u8fc7\u5b9e\u6218\u7f16\u5199\u53d1\u73b0HTTP\u5305\u4e2d\u53d1\u51fa\u7684shellcode\u5bb9\u6613\u88ab\u5404\u79cd\u5947\u602a\u7684\u5b57\u7b26\u622a\u65ad\uff0c\u53ef\u4ee5\u8fdb\u884c\u7ed5\u8fc7\u4f46\u662f\u6bd4\u8f83\u7e41\u7410\u3002 \u56e0\u6b64\u8fd8\u6709\u53e6\u5916\u4e00\u79cd\u94fe\uff0c\u4e2a\u4eba\u611f\u89c9\u6bd4\u8f83\u597d\u7528\uff0c\u5176\u5b9e\u5f88\u7b80\u5355\uff0c\u5c31\u662fsystem(cmd) \u7528RopGardget\u641c ROPgadget --binary libc.so.6 | grep \"move \\$t9, \\$s\" \uff0c\u53ef\u4ee5\u770b\u5230\u7c7b\u4f3c\u8fd9\u4e9b\u7684gardget move $t9, $s0 ; jalr $t9 ; addiu $a0, $sp, 0x38 move $t9, $s0 ; jalr $t9 ; addiu $a0, $sp, 0x34 \u6216\u8005\u8fd9\u6837\u7684 move $t9, $s1 ; jalr $t9 ; move $a0, $s0 \u7b2c\u4e00\u7c7b\u7528\u4e4b\u524d\u8bf4\u7684scandir\u90a3\u8fb9\u7684gardget\u8bbe\u7f6e\u597ds0\u5c31\u76f4\u63a5\u53ef\u4ee5\u8df3system\u4e86\uff0c\u547d\u4ee4\u653e\u6808\u4e0a\u5373\u53ef \u7b2c\u4e8c\u7c7b\u7a0d\u5fae\u590d\u6742\u4e00\u4e9b\uff0c\u518d\u627e\u4e00\u4e2a addiu $s0, $sp, 0x94 ; \u5373\u53ef \u8fd8\u6709\u6bd4\u8f83\u597d\u7684\u662f\u7c7b\u4f3c\u8fd9\u6837\u7684\uff1a addiu $s0, $sp, 0x94 ; lw $t9, -0x7718($gp) ; jalr $t9 ; move $a0, $s0 \u4f46\u662f\u4e2a\u4eba\u63a8\u8350\u4f7f\u7528\u524d\u4e00\u79cd\u901a\u8fc7\u6267\u884c shellcode \u6765\u53cd\u5f39 shell \u7684\u65b9\u5f0f\uff0cMIPS \u6307\u4ee4\u96c6\u65e0\u6cd5\u5f00\u542f NX\uff0c\u6240\u4ee5\u4f7f\u7528\u8fd9\u79cd\u65b9\u5f0f\u6bd4\u8f83\u65b9\u4fbf\u3002\u4f7f\u7528\u7b2c\u4e8c\u79cd\u6267\u884c system \u547d\u4ee4\uff0c\u5982 sysetm(\"telentd -p 123 -l /bin/sh\") \u7684\u65b9\u6cd5\uff0c\u53ef\u80fd\u56e0\u4e3a\u53c2\u6570\u63a7\u5236\u4e0d\u597d\u7684\u539f\u56e0\u51fa\u73b0\u5404\u79cd\u5404\u6837\u7684\u95ee\u9898\u3002 \u5173\u4e8e\u8c03\u7528 sleep \u51fd\u6570\u7684\u539f\u56e0 \u00b6 \u56e0\u4e3a MIPS \u6d41\u6c34\u7ebf\u6307\u4ee4\u96c6\u7684\u7279\u70b9\uff0c\u5b58\u5728 cache incoherency \u7684\u7279\u6027\uff0c\u9700\u8981\u624b\u52a8\u8c03\u7528 sleep \u51fd\u6570\uff0c\u5c06\u6570\u636e\u533a\u5237\u65b0\u5230\u6307\u4ee4\u533a\u5f53\u4e2d\u53bb\uff0c\u4ece\u800c\u53ef\u4ee5\u6b63\u5e38\u6267\u884c shellcode\u3002\u5982\u4e0b\u56fe\uff1a \u53c2\u8003\u6587\u7ae0 \u00b6 exploiting buffer overflows on mips architectures","title":"\u6808\u6ea2\u51fa\u5229\u7528\u6280\u5de7"},{"location":"firmware_security/IOT_instructions_charac/stackoverflow_exploit/#_1","text":"\u56e0\u4e3a MIPS \u6307\u4ee4\u96c6\u4e0d\u540c\u4e8e X86 \u6307\u4ee4\u96c6\u67b6\u6784\uff0c\u6240\u4ee5\u5728\u6808\u6ea2\u51fa\u7684\u5229\u7528\u65b9\u5f0f\u4e0a\u6709\u6240\u5dee\u522b\uff0cROP \u94fe\u7684\u6784\u9020\u4e5f\u4e0d\u5c3d\u76f8\u540c\uff0c\u8fd9\u91cc\u6982\u8ff0\u4e00\u4e0b\u5173\u4e8e MIPS \u6808\u6ea2\u51fa\u5229\u7528\u7684\u6280\u5de7\u548c\u7279\u70b9\u3002","title":"\u6982\u8ff0"},{"location":"firmware_security/IOT_instructions_charac/stackoverflow_exploit/#mips-gardget","text":"ROPgardget \u6700\u5e38\u89c1\uff0c\u6700\u901a\u7528\u7684\u5168\u5e73\u53f0\u5bfb\u627eGardget\u5de5\u5177 > ROPgadget --binary libc.so.6 ...... 0x00049298 : xori $v0, $v0, 2 ; sw $v0, 0x1c($sp) ; lw $t9, -0x6d14($gp) ; jalr $t9 ; addiu $a0, $sp, 0x20 0x000492f0 : xori $v0, $v0, 2 ; sw $v0, 8($s1) ; lw $v0, 0x38($sp) ; sw $v0, 4($s1) ; move $v0, $v1 ; lw $ra, 0x54($sp) ; lw $s2, 0x50($sp) ; lw $s1, 0x4c($sp) ; lw $s0, 0x48($sp) ; jr $ra ; addiu $sp, $sp, 0x58 0x000b03a4 : xori $v0, $v1, 0x1f ; movn $a3, $zero, $v0 ; addiu $a0, $zero, 4 ; lw $a1, -0x7fd8($gp) ; addiu $a1, $a1, 0x6c08 ; lw $a2, -0x7fd8($gp) ; lw $t9, -0x7940($gp) ; jalr $t9 ; addiu $a2, $a2, 0x6c40 0x00040708 : xori $v0, $v1, 1 ; addiu $v1, $zero, 1 ; xori $v0, $v1, 1 ; andi $v0, $v0, 0xff ; b 0x40780 ; andi $v1, $v0, 0xff ; move $a0, $a1 ; lw $t9, -0x6ebc($gp) ; jalr $t9 ; move $a1, $s1 0x00040710 : xori $v0, $v1, 1 ; andi $v0, $v0, 0xff ; b 0x40778 ; andi $v1, $v0, 0xff ; move $a0, $a1 ; lw $t9, -0x6ebc($gp) ; jalr $t9 ; move $a1, $s1 0x000d2dc4 : xori $v1, $a3, 8 ; lw $t9, -0x75f4($gp) ; jalr $t9 ; nop 0x000accbc : xori $v1, $fp, 1 ; addiu $a0, $zero, 0x1c ; addiu $v0, $zero, 2 ; movz $a0, $v0, $v1 ; lw $t9, -0x7fa4($gp) ; addiu $t9, $t9, -0x4748 ; jalr $t9 ; sw $a0, 0x44($sp) 0x000b941c : xori $v1, $v0, 1 ; addiu $v0, $zero, -1 ; movz $v0, $zero, $v1 ; lw $ra, 0x28($sp) ; jr $ra ; addiu $sp, $sp, 0x30 0x000b93ac : xori $v1, $v0, 1 ; addiu $v0, $zero, -1 ; movz $v0, $zero, $v1 ; lw $ra, 0x30($sp) ; jr $ra ; addiu $sp, $sp, 0x38 Unique gadgets found: 114925 \u4f18\u70b9\uff1a\u901a\u7528\uff0c\u5404\u5e73\u53f0\u90fd\u80fd\u4e00\u952e\u627e\uff0c\u627e\u7279\u5b9a\u5730\u5740\u7684Gardget\u4e5f\u8fd8\u7528 \u7f3a\u70b9\uff1a\u627eMIPS\u7684\u65f6\u5019\u7a0d\u5fae\u9700\u8981\u4e00\u70b9\u7279\u522b\u7684\u6280\u5de7 MIPSROP ( https://github.com/devttys0/ida/tree/master/plugins/mipsrop ) IDA\u91cc\u9762\u7684\u63d2\u4ef6\uff0c\u4e13\u95e8\u9488\u5bf9MIPS \u4f18\u70b9\uff1a\u9488\u5bf9\u6027\u5f3a\uff0c\u6709\u5f88\u591a\u9009\u9879\u80fd\u627e\u6ee1\u8db3ROP\u8981\u6c42\u7684\u7279\u5b9a\u7684Gardget \u7f3a\u70b9\uff1a\u5176\u4ed6\u67b6\u6784\u4e0d\u884c\uff08\u540d\u5b57\u5c31\u53ebMIPS\uff09","title":"\u5e38\u89c1\u5bfb\u627eMIPS Gardget\u5de5\u5177"},{"location":"firmware_security/IOT_instructions_charac/stackoverflow_exploit/#gardget","text":"\u4e3a\u4e86\u4e86\u89e3MIPS\u4e0b\u6808\u6ea2\u51fa\u7684\u5229\u7528\uff0c\u9996\u5148\u5f97\u5bf9MIPS\u7684\u4f20\u53c2\u7ea6\u5b9a\u6709\u4e00\u4e2a\u57fa\u672c\u7684\u4e86\u89e3\u3002 MIPS\u670932\u4e2a\u901a\u7528\u5bc4\u5b58\u5668\uff08 0- 0- 31\uff09\uff0c\u5404\u5bc4\u5b58\u5668\u7684\u529f\u80fd\u53ca\u6c47\u7f16\u7a0b\u5e8f\u4e2d\u4f7f\u7528\u7ea6\u5b9a\u5982\u4e0b \u5176\u4e2d\u6bd4\u8f83\u91cd\u8981\u7684\u662f v0\u4e3a\u51fd\u6570\u8fd4\u56de\u503c\u5b58\u653e\u7684\u5bc4\u5b58\u5668\uff0c v0\u4e3a\u51fd\u6570\u8fd4\u56de\u503c\u5b58\u653e\u7684\u5bc4\u5b58\u5668\uff0c ra\u5b58\u5728\u8fd4\u56de\u5730\u5740\uff0c a0- a0- a3\u5b58\u5728\u51fd\u6570\u7684\u56db\u4e2a\u8c03\u7528\u53c2\u6570\uff0c\u5f53\u9700\u8981\u4f7f\u7528\u66f4\u591a\u7684\u5bc4\u5b58\u5668\u65f6\uff0c\u5c31\u9700\u8981\u5806\u6808\uff08stack)\u4e86,\u9700\u8981\u6ce8\u610f\u7684\u662fMIPS\u7f16\u8bd1\u5668\u603b\u662f\u4e3a\u53c2\u6570\u5728\u5806\u6808\u4e2d\u7559\u6709\u7a7a\u95f4\u4ee5\u9632\u6709\u53c2\u6570\u9700\u8981\u5b58\u50a8\u3002 \u56e0\u6b64\u5bf9\u4e8e\u4f7f\u7528ROP\u8fdb\u884c\u4e00\u822c\u7684\u51fd\u6570\u64cd\u4f5c\u6765\u8bf4\uff0c\u5bc4\u5b58\u5668\u7684\u56db\u4e2a\u53c2\u6570\u5df2\u7ecf\u8db3\u591f\u4e86\uff0c\u56e0\u6b64\u63a7\u5236\u8fd9\u4e2a\u56db\u4e2a\u5bc4\u5b58\u5668\u5bf9\u4e8eROP\u6765\u8bf4\u6bd4\u8f83\u5173\u952e\u3002","title":"\u5e38\u89c1Gardget\u5206\u6790"},{"location":"firmware_security/IOT_instructions_charac/stackoverflow_exploit/#gadget","text":"\u5728uclibc\u5e93\u4e2d\uff0c\u6709\u51e0\u4e2a\u6bd4\u8f83\u5173\u952e\u7684gadget\uff0c\u5728 scandir \u7684\u5c3e\u90e8\u6216\u8005 scandir64 \u7684\u5c3e\u90e8\uff0c\u4ece\u56fe\u4e0a\u770b\u57fa\u672c\u4e0a\u53ef\u4ee5\u8bbe\u7f6e\u6240\u6709\u5bc4\u5b58\u5668\u503c\uff0c\u4eces0-s7 \u6709\u4e00\u6761\u6bd4\u8f83\u5e38\u89c4\u7684ROP\u94fe\uff0c\u6267\u884c\u7684\u6574\u4f53\u6d41\u7a0b\u4e3a sleep(1) -> read_value_from_stack -> jump to stack(shellcode)","title":"\u901a\u7528\u7684 gadget \u6bb5"},{"location":"firmware_security/IOT_instructions_charac/stackoverflow_exploit/#_2","text":"\u9996\u5148\u5bfb\u627e\u4e00\u4e2a\u8bbe\u7f6ea0\u4e3a\u5e38\u91cf\u7684Gardget\uff0c\u53ef\u4ee5\u4f7f\u7528MIPSRop\u5bfb\u627e\u8bbe\u7f6ea0\u5bc4\u5b58\u5668\u7684Gardget Python>mipsrop.find(\"li $a0,\") ---------------------------------------------------------------------------------------------------------------- | Address | Action | Control Jump | ---------------------------------------------------------------------------------------------------------------- | 0x004608C0 | li $a0,0xE10 | jalr $v0 | | 0x0042F5B0 | li $a0,0xE | jr 0x28+var_8($sp) | | 0x004314B8 | li $a0,4 | jr 0x20+var_8($sp) | | 0x00437E90 | li $a0,0xFFFFFFFF | jr 0x20+var_8($sp) | | 0x00439F68 | li $a0,8 | jr 0x20+var_8($sp) | ---------------------------------------------------------------------------------------------------------------- Found 5 matching gadgets \u5176\u6b21\uff0c\u4ece\u5185\u5b58\u52a0\u8f7d\u6570\u636e\u5230\u5bc4\u5b58\u5668 LOAD:0001E20C move $t9, $s1 LOAD:0001E210 lw $ra, 0x28+var_4($sp) LOAD:0001E214 lw $s2, 0x28+var_8($sp) LOAD:0001E218 lw $s1, 0x28+var_C($sp) LOAD:0001E21C lw $s0, 0x28+var_10($sp) LOAD:0001E220 jr $t9 LOAD:0001E224 addiu $sp, 0x28 \u7136\u540e\uff0c\u628a\u6808\u5730\u5740\u653e\u5230\u5bc4\u5b58\u5668\u4e2d mipsrop.stackfinder() ---------------------------------------------------------------------------------------------------------------- | Address | Action | Control Jump | ---------------------------------------------------------------------------------------------------------------- | 0x0041FF7C | addiu $s0,$sp,0xA10+var_9F0 | jalr $s5 | | 0x00436D80 | addiu $s2,$sp,0x448+var_430 | jalr $s0 | | 0x00437B7C | addiu $s1,$sp,0x458+var_438 | jalr $s0 | | 0x0043FE54 | addiu $a1,$sp,0x478+var_448 | jalr $s7 | | 0x00451B18 | addiu $v0,$sp,0x88+var_78 | jalr $v0 | | 0x00451B8C | addiu $v0,$sp,0x98+var_88 | jalr $v0 | | 0x00451C00 | addiu $v0,$sp,0xA8+var_98 | jalr $v0 | | 0x004520D4 | addiu $v0,$sp,0xB8+var_A8 | jalr $v0 | | 0x0045215C | addiu $v0,$sp,0xB8+var_A8 | jalr $v0 | | 0x004521D0 | addiu $v0,$sp,0xD8+var_C8 | jalr $v0 | | 0x00452240 | addiu $v0,$sp,0xD8+var_C8 | jalr $v0 | | 0x004522B0 | addiu $v0,$sp,0xB8+var_A8 | jalr $v0 | | 0x00452340 | addiu $v0,$sp,0xB8+var_A8 | jalr $v0 | | 0x004523CC | addiu $v0,$sp,0xB8+var_A8 | jalr $v0 | | 0x004529C4 | addiu $v0,$sp,0x918+var_900 | jalr $v0 | | 0x00452A44 | addiu $v0,$sp,0x928+var_910 | jalr $v0 | | 0x00452AB8 | addiu $v0,$sp,0x938+src | jalr $v0 | | 0x00452B48 | addiu $v0,$sp,0x948+var_930 | jalr $v0 | | 0x00452BBC | addiu $v0,$sp,0x968+var_950 | jalr $v0 | | 0x00452C2C | addiu $v0,$sp,0x968+var_950 | jalr $v0 | | 0x00452C9C | addiu $v0,$sp,0x948+var_930 | jalr $v0 | | 0x00452D1C | addiu $v0,$sp,0x948+var_930 | jalr $v0 | | 0x00452DAC | addiu $v0,$sp,0x948+var_930 | jalr $v0 | | 0x00452E38 | addiu $v0,$sp,0x948+var_930 | jalr $v0 | | 0x004559D4 | addiu $v0,$sp,0x278+var_268 | jalr $v0 | | 0x00455A3C | addiu $v0,$sp,0x288+var_278 | jalr $v0 | | 0x00455AD0 | addiu $v0,$sp,0x288+var_278 | jalr $v0 | | 0x00455B48 | addiu $v0,$sp,0x298+var_288 | jalr $v0 | | 0x00455BC8 | addiu $v0,$sp,0x298+var_288 | jalr $v0 | | 0x00455C58 | addiu $v0,$sp,0x298+var_288 | jalr $v0 | | 0x00455D0C | addiu $v0,$sp,0x298+var_288 | jalr $v0 | | 0x00414E6C | addiu $a0,$sp,0x138+arg_0 | jr 0x138+var_4($sp) | | 0x00416584 | addiu $a0,$sp,0x340+var_328 | jr 0x340+var_8($sp) | | 0x00416680 | addiu $a0,$sp,0x340+var_328 | jr 0x340+var_8($sp) | | 0x0041677C | addiu $a0,$sp,0x340+var_328 | jr 0x340+var_8($sp) | | 0x00416878 | addiu $a0,$sp,0x340+var_328 | jr 0x340+var_8($sp) | | 0x004169AC | addiu $a0,$sp,0x348+var_330 | jr 0x348+var_8($sp) | | 0x00417728 | addiu $a0,$sp,0x138+var_11C | jr 0x138+var_4($sp) | | 0x0041C928 | addiu $a1,$sp,0x28+var_10 | jr 0x28+var_8($sp) | | 0x0042C3B8 | addiu $a0,$sp,0xB0+var_48 | jr 0xB0+var_4($sp) | | 0x00438C3C | addiu $a2,$sp,0x428+var_410 | jr 0x428+var_8($sp) | | 0x0043FB8C | addiu $a0,$sp,0x50+var_30 | jr 0x50+var_8($sp) | | 0x004403DC | addiu $a0,$sp,0x850+var_830 | jr 0x850+var_8($sp) | ---------------------------------------------------------------------------------------------------------------- Found 43 matching gadgets \u6700\u540e\u8df3\u5230shellcode\u4e2d mipsrop.find(\"move $t9, $s2\") ---------------------------------------------------------------------------------------------------------------- | Address | Action | Control Jump | ---------------------------------------------------------------------------------------------------------------- | 0x0001C890 | move $t9,$s2 | jalr $s2 | | 0x0001C8AC | move $t9,$s2 | jalr $s2 | | 0x0001C8E0 | move $t9,$s2 | jalr $s2 | | 0x0001C914 | move $t9,$s2 | jalr $s2 | | 0x0001CB40 | move $t9,$s2 | jalr $s2 | | 0x0001DC58 | move $t9,$s2 | jalr $s2 | | 0x0001DC6C | move $t9,$s2 | jalr $s2 | | 0x0002A89C | move $t9,$s2 | jalr $s2 | | 0x0002A8B4 | move $t9,$s2 | jalr $s2 | | 0x00043398 | move $t9,$s2 | jalr $s2 | | 0x00047458 | move $t9,$s2 | jalr $s2 | | 0x00047474 | move $t9,$s2 | jalr $s2 | | 0x00053110 | move $t9,$s2 | jalr $s2 | | 0x00053648 | move $t9,$s2 | jalr $s2 | | 0x0005371C | move $t9,$s2 | jalr $s2 | | 0x000556A8 | move $t9,$s2 | jalr $s2 | | 0x000556CC | move $t9,$s2 | jalr $s2 | | 0x00055768 | move $t9,$s2 | jalr $s2 | | 0x0005578C | move $t9,$s2 | jalr $s2 | | 0x0005674C | move $t9,$s2 | jalr $s2 | | 0x00056770 | move $t9,$s2 | jalr $s2 | | 0x0005680C | move $t9,$s2 | jalr $s2 | | 0x00056830 | move $t9,$s2 | jalr $s2 | | 0x00057B24 | move $t9,$s2 | jalr $s2 | | 0x000580C4 | move $t9,$s2 | jalr $s2 | | 0x00058E9C | move $t9,$s2 | jalr $s2 | | 0x00058EC0 | move $t9,$s2 | jalr $s2 | | 0x00058F5C | move $t9,$s2 | jalr $s2 | | 0x00058F80 | move $t9,$s2 | jalr $s2 | | 0x0005A064 | move $t9,$s2 | jalr $s2 | | 0x0005A4C0 | move $t9,$s2 | jalr $s2 | | 0x0005AA4C | move $t9,$s2 | jalr $s2 | | 0x0005AF30 | move $t9,$s2 | jalr $s2 | | 0x0005BD14 | move $t9,$s2 | jalr $s2 | | 0x0005BD40 | move $t9,$s2 | jalr $s2 | | 0x0005D4AC | move $t9,$s2 | jalr $s2 | | 0x0005D4F0 | move $t9,$s2 | jalr $s2 | | 0x0005DDCC | move $t9,$s2 | jalr $s2 | | 0x0005DDF8 | move $t9,$s2 | jalr $s2 | | 0x0005E37C | move $t9,$s2 | jalr $s2 | | 0x0006052C | move $t9,$s2 | jalr $s2 | | 0x00060548 | move $t9,$s2 | jalr $s2 | | 0x00060564 | move $t9,$s2 | jalr $s2 | | 0x00062888 | move $t9,$s2 | jalr $s2 | | 0x0006D8F8 | move $t9,$s2 | jalr $s2 | | 0x000765E4 | move $t9,$s2 | jalr $s2 | | 0x000766B0 | move $t9,$s2 | jalr $s2 | | 0x00078720 | move $t9,$s2 | jalr $s2 | | 0x0007A23C | move $t9,$s2 | jalr $s2 | | 0x0007A2C4 | move $t9,$s2 | jalr $s2 | | 0x0008EE68 | move $t9,$s2 | jalr $s2 | | 0x0008F30C | move $t9,$s2 | jalr $s2 | | 0x0009453C | move $t9,$s2 | jalr $s2 | | 0x0009457C | move $t9,$s2 | jalr $s2 | | 0x00098264 | move $t9,$s2 | jalr $s2 | | 0x000AF9E8 | move $t9,$s2 | jalr $s2 | | 0x000B088C | move $t9,$s2 | jalr $s2 | | 0x000B4148 | move $t9,$s2 | jalr $s2 | | 0x000B46BC | move $t9,$s2 | jalr $s2 | | 0x000B471C | move $t9,$s2 | jalr $s2 | | 0x000BCF18 | move $t9,$s2 | jalr $s2 | | 0x000BCFF0 | move $t9,$s2 | jalr $s2 | | 0x000BD01C | move $t9,$s2 | jalr $s2 | | 0x000DB248 | move $t9,$s2 | jalr $s2 | | 0x000DB3F4 | move $t9,$s2 | jalr $s2 | | 0x000DB4C8 | move $t9,$s2 | jalr $s2 | | 0x000DB6DC | move $t9,$s2 | jalr $s2 | | 0x000DB838 | move $t9,$s2 | jalr $s2 | | 0x000DBA34 | move $t9,$s2 | jalr $s2 | | 0x000DBC24 | move $t9,$s2 | jalr $s2 | | 0x000DBDE8 | move $t9,$s2 | jalr $s2 | | 0x000DBF74 | move $t9,$s2 | jalr $s2 | | 0x000E5D88 | move $t9,$s2 | jalr $s2 | | 0x000E5DA0 | move $t9,$s2 | jalr $s2 | ---------------------------------------------------------------------------------------------------------------- \u8fd9\u4e2a\u94fe\u662f\u76f8\u5bf9\u6765\u8bf4\u6700\u901a\u7528\u7684\u4e00\u4e2a\u94fe\uff0c\u7531\u4e8eMIPS\u7684\u7279\u6027\uff0c\u5bf9\u4e8e\u9700\u8981Sleep\u4e2d\u65ad\u4e00\u4e0b\uff0c\u624d\u53ef\u4ee5\u76f4\u63a5\u8df3\u5230stack\u4e2d\u7684shellcode\uff0c\u4f46\u662f\u8981\u6c42nx\u6ca1\u5f00\uff0clibc\u7684\u5730\u5740\u4e5f\u662f\u77e5\u9053\u7684\uff0c\u901a\u8fc7\u5b9e\u6218\u7f16\u5199\u53d1\u73b0HTTP\u5305\u4e2d\u53d1\u51fa\u7684shellcode\u5bb9\u6613\u88ab\u5404\u79cd\u5947\u602a\u7684\u5b57\u7b26\u622a\u65ad\uff0c\u53ef\u4ee5\u8fdb\u884c\u7ed5\u8fc7\u4f46\u662f\u6bd4\u8f83\u7e41\u7410\u3002 \u56e0\u6b64\u8fd8\u6709\u53e6\u5916\u4e00\u79cd\u94fe\uff0c\u4e2a\u4eba\u611f\u89c9\u6bd4\u8f83\u597d\u7528\uff0c\u5176\u5b9e\u5f88\u7b80\u5355\uff0c\u5c31\u662fsystem(cmd) \u7528RopGardget\u641c ROPgadget --binary libc.so.6 | grep \"move \\$t9, \\$s\" \uff0c\u53ef\u4ee5\u770b\u5230\u7c7b\u4f3c\u8fd9\u4e9b\u7684gardget move $t9, $s0 ; jalr $t9 ; addiu $a0, $sp, 0x38 move $t9, $s0 ; jalr $t9 ; addiu $a0, $sp, 0x34 \u6216\u8005\u8fd9\u6837\u7684 move $t9, $s1 ; jalr $t9 ; move $a0, $s0 \u7b2c\u4e00\u7c7b\u7528\u4e4b\u524d\u8bf4\u7684scandir\u90a3\u8fb9\u7684gardget\u8bbe\u7f6e\u597ds0\u5c31\u76f4\u63a5\u53ef\u4ee5\u8df3system\u4e86\uff0c\u547d\u4ee4\u653e\u6808\u4e0a\u5373\u53ef \u7b2c\u4e8c\u7c7b\u7a0d\u5fae\u590d\u6742\u4e00\u4e9b\uff0c\u518d\u627e\u4e00\u4e2a addiu $s0, $sp, 0x94 ; \u5373\u53ef \u8fd8\u6709\u6bd4\u8f83\u597d\u7684\u662f\u7c7b\u4f3c\u8fd9\u6837\u7684\uff1a addiu $s0, $sp, 0x94 ; lw $t9, -0x7718($gp) ; jalr $t9 ; move $a0, $s0 \u4f46\u662f\u4e2a\u4eba\u63a8\u8350\u4f7f\u7528\u524d\u4e00\u79cd\u901a\u8fc7\u6267\u884c shellcode \u6765\u53cd\u5f39 shell \u7684\u65b9\u5f0f\uff0cMIPS \u6307\u4ee4\u96c6\u65e0\u6cd5\u5f00\u542f NX\uff0c\u6240\u4ee5\u4f7f\u7528\u8fd9\u79cd\u65b9\u5f0f\u6bd4\u8f83\u65b9\u4fbf\u3002\u4f7f\u7528\u7b2c\u4e8c\u79cd\u6267\u884c system \u547d\u4ee4\uff0c\u5982 sysetm(\"telentd -p 123 -l /bin/sh\") \u7684\u65b9\u6cd5\uff0c\u53ef\u80fd\u56e0\u4e3a\u53c2\u6570\u63a7\u5236\u4e0d\u597d\u7684\u539f\u56e0\u51fa\u73b0\u5404\u79cd\u5404\u6837\u7684\u95ee\u9898\u3002","title":"\u5229\u7528\u6d41\u7a0b"},{"location":"firmware_security/IOT_instructions_charac/stackoverflow_exploit/#sleep","text":"\u56e0\u4e3a MIPS \u6d41\u6c34\u7ebf\u6307\u4ee4\u96c6\u7684\u7279\u70b9\uff0c\u5b58\u5728 cache incoherency \u7684\u7279\u6027\uff0c\u9700\u8981\u624b\u52a8\u8c03\u7528 sleep \u51fd\u6570\uff0c\u5c06\u6570\u636e\u533a\u5237\u65b0\u5230\u6307\u4ee4\u533a\u5f53\u4e2d\u53bb\uff0c\u4ece\u800c\u53ef\u4ee5\u6b63\u5e38\u6267\u884c shellcode\u3002\u5982\u4e0b\u56fe\uff1a","title":"\u5173\u4e8e\u8c03\u7528 sleep \u51fd\u6570\u7684\u539f\u56e0"},{"location":"firmware_security/IOT_instructions_charac/stackoverflow_exploit/#_3","text":"exploiting buffer overflows on mips architectures","title":"\u53c2\u8003\u6587\u7ae0"},{"location":"firmware_security/firmware_obtain/","text":"\u6982\u8ff0 \u00b6 \u5bf9\u56fa\u4ef6\u8fdb\u884c\u9006\u5411\u548c\u5b89\u5168\u5206\u6790\u7684\u524d\u63d0\uff0c\u662f\u9700\u8981\u83b7\u53d6\u5230\u76f8\u5e94\u7684\u56fa\u4ef6\u6587\u4ef6\u3002\u9996\u5148\u6d89\u53ca\u5230\u56fa\u4ef6\u7684\u83b7\u53d6\uff0c\u83b7\u53d6\u5230\u7684\u56fa\u4ef6\u9700\u8981\u4f7f\u7528\u5de5\u5177\u8fdb\u884c\u89e3\u6790\uff0c\u5f97\u5230\u76f8\u5e94\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u6216\u8005\u6587\u4ef6\u7cfb\u7edf\uff0c\u4ee5\u4fbf\u8fdb\u884c\u4e0b\u4e00\u6b65\u7684\u5b89\u5168\u5206\u6790\u548c\u6f0f\u6d1e\u6316\u6398\u3002 \u8fd9\u91cc\u5217\u51fa\u4e3b\u8981\u7684\u51e0\u79cd\u6bd4\u8f83\u5e38\u89c1\u7684\u9014\u5f84\u6765\u83b7\u53d6\u56fa\u4ef6\uff1a \u5b98\u7f51\u83b7\u53d6 \u786c\u4ef6\u83b7\u53d6 \u8bbe\u5907\u56fa\u4ef6\u66f4\u65b0\u94fe\u63a5\u4e2d\u83b7\u53d6 ...","title":"\u6982\u8ff0"},{"location":"firmware_security/firmware_obtain/#_1","text":"\u5bf9\u56fa\u4ef6\u8fdb\u884c\u9006\u5411\u548c\u5b89\u5168\u5206\u6790\u7684\u524d\u63d0\uff0c\u662f\u9700\u8981\u83b7\u53d6\u5230\u76f8\u5e94\u7684\u56fa\u4ef6\u6587\u4ef6\u3002\u9996\u5148\u6d89\u53ca\u5230\u56fa\u4ef6\u7684\u83b7\u53d6\uff0c\u83b7\u53d6\u5230\u7684\u56fa\u4ef6\u9700\u8981\u4f7f\u7528\u5de5\u5177\u8fdb\u884c\u89e3\u6790\uff0c\u5f97\u5230\u76f8\u5e94\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u6216\u8005\u6587\u4ef6\u7cfb\u7edf\uff0c\u4ee5\u4fbf\u8fdb\u884c\u4e0b\u4e00\u6b65\u7684\u5b89\u5168\u5206\u6790\u548c\u6f0f\u6d1e\u6316\u6398\u3002 \u8fd9\u91cc\u5217\u51fa\u4e3b\u8981\u7684\u51e0\u79cd\u6bd4\u8f83\u5e38\u89c1\u7684\u9014\u5f84\u6765\u83b7\u53d6\u56fa\u4ef6\uff1a \u5b98\u7f51\u83b7\u53d6 \u786c\u4ef6\u83b7\u53d6 \u8bbe\u5907\u56fa\u4ef6\u66f4\u65b0\u94fe\u63a5\u4e2d\u83b7\u53d6 ...","title":"\u6982\u8ff0"},{"location":"firmware_security/firmware_obtain/update_captrue/","text":"111","title":"\u66f4\u65b0\u6293\u5305\u83b7\u53d6"},{"location":"firmware_security/firmware_obtain/website_download/","text":"\u6982\u5ff5 \u00b6 \u5bf9\u4e8e\u56fa\u4ef6\u83b7\u53d6\uff0c\u7b2c\u4e00\u79cd\u6700\u76f4\u63a5\u7684\u65b9\u6cd5\u5c31\u662f\u901a\u8fc7\u5b98\u7f51\u7684\u4e0b\u8f7d\u6e20\u9053\uff0c\u6765\u83b7\u53d6\u76f8\u5e94\u7684\u56fa\u4ef6\u6587\u4ef6\u3002\u9996\u5148\u627e\u5230\u5b98\u7f51\u7684\u7f51\u5740\uff0c\u6839\u636e\u5b98\u65b9\u63d0\u4f9b\u7684\u56fa\u4ef6\u4e0b\u8f7d\u94fe\u63a5\u8fdb\u884c\u4e0b\u8f7d\u3002 \u4e00\u4e9b\u6848\u4f8b \u00b6 1 . \u5728\u5b98\u7f51\u7684\u6280\u672f\u652f\u6301\u5904\u53ef\u4ee5\u4e0b\u8f7d\u5230\u5bf9\u5e94\u578b\u53f7\u3001\u5bf9\u5e94\u7248\u672c\u7684\u56fa\u4ef6\u3002\u5982 Tenda \u8def\u7531\u5668\u5b98\u7f51\uff1a TPLINK \u5b98\u7f51\uff1a 2 . \u5bf9\u4e8e\u67d0\u4e9b\u5382\u5546\u7684\u56fa\u4ef6\u662f\u7edf\u4e00\u653e\u5728\u67d0\u4e2a\u670d\u52a1\u5668\u76ee\u5f55\u4e0b\uff0c\u5982 DLINK \u7cfb\u5217\u56fa\u4ef6 \u3002 \u867d\u7136\u5b98\u65b9\u63d0\u4f9b\u7684\u4e0b\u8f7d\u94fe\u63a5\u83b7\u53d6\u56fa\u4ef6\u662f\u4e00\u4e2a\u5f88\u4fbf\u6377\u7684\u65b9\u5f0f\uff0c\u4f46\u662f\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\u5382\u5546\u53ef\u80fd\u4e0d\u63d0\u4f9b\u76f8\u5e94\u56fa\u4ef6\u7684\u4e0b\u8f7d\u94fe\u63a5\uff0c\u8fd9\u65f6\u5c31\u9700\u8981\u6211\u4eec\u60f3\u4e00\u4e9b\u5176\u4ed6\u7684\u65b9\u6cd5\u6765\u83b7\u53d6\u56fa\u4ef6\u3002 \u518d\u5982 draytek \u5382\u5546\uff1a \u6574\u7406\u7684\u4e00\u4e9b\u56fd\u5185\u8def\u7531\u5668\u5382\u5546\u7684\u56fa\u4ef6\u4e0b\u8f7d\u94fe\u63a5 \u00b6 \u540e\u7eed\u5c06\u4e0d\u65ad\u66f4\u65b0 TOTOLINK http://www.totolink.net/ FAST \u6781\u8def\u7531/hiwifi D-LINK TP-LINK MERCURY Tenda \u78ca\u79d1 \u7ef4\u76df http://www.wayos.com:8081/download/ \u827e\u6cf0 \u9510\u6377\u8def\u7531\u5668 \u98de\u9c7c\u661f newifi b-link \u534e\u7855 \u817e\u8fbe \u62d3\u5b9e netis \u534e\u7855","title":"\u5b98\u7f51\u4e0b\u8f7d"},{"location":"firmware_security/firmware_obtain/website_download/#_1","text":"\u5bf9\u4e8e\u56fa\u4ef6\u83b7\u53d6\uff0c\u7b2c\u4e00\u79cd\u6700\u76f4\u63a5\u7684\u65b9\u6cd5\u5c31\u662f\u901a\u8fc7\u5b98\u7f51\u7684\u4e0b\u8f7d\u6e20\u9053\uff0c\u6765\u83b7\u53d6\u76f8\u5e94\u7684\u56fa\u4ef6\u6587\u4ef6\u3002\u9996\u5148\u627e\u5230\u5b98\u7f51\u7684\u7f51\u5740\uff0c\u6839\u636e\u5b98\u65b9\u63d0\u4f9b\u7684\u56fa\u4ef6\u4e0b\u8f7d\u94fe\u63a5\u8fdb\u884c\u4e0b\u8f7d\u3002","title":"\u6982\u5ff5"},{"location":"firmware_security/firmware_obtain/website_download/#_2","text":"1 . \u5728\u5b98\u7f51\u7684\u6280\u672f\u652f\u6301\u5904\u53ef\u4ee5\u4e0b\u8f7d\u5230\u5bf9\u5e94\u578b\u53f7\u3001\u5bf9\u5e94\u7248\u672c\u7684\u56fa\u4ef6\u3002\u5982 Tenda \u8def\u7531\u5668\u5b98\u7f51\uff1a TPLINK \u5b98\u7f51\uff1a 2 . \u5bf9\u4e8e\u67d0\u4e9b\u5382\u5546\u7684\u56fa\u4ef6\u662f\u7edf\u4e00\u653e\u5728\u67d0\u4e2a\u670d\u52a1\u5668\u76ee\u5f55\u4e0b\uff0c\u5982 DLINK \u7cfb\u5217\u56fa\u4ef6 \u3002 \u867d\u7136\u5b98\u65b9\u63d0\u4f9b\u7684\u4e0b\u8f7d\u94fe\u63a5\u83b7\u53d6\u56fa\u4ef6\u662f\u4e00\u4e2a\u5f88\u4fbf\u6377\u7684\u65b9\u5f0f\uff0c\u4f46\u662f\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\u5382\u5546\u53ef\u80fd\u4e0d\u63d0\u4f9b\u76f8\u5e94\u56fa\u4ef6\u7684\u4e0b\u8f7d\u94fe\u63a5\uff0c\u8fd9\u65f6\u5c31\u9700\u8981\u6211\u4eec\u60f3\u4e00\u4e9b\u5176\u4ed6\u7684\u65b9\u6cd5\u6765\u83b7\u53d6\u56fa\u4ef6\u3002 \u518d\u5982 draytek \u5382\u5546\uff1a","title":"\u4e00\u4e9b\u6848\u4f8b"},{"location":"firmware_security/firmware_obtain/website_download/#_3","text":"\u540e\u7eed\u5c06\u4e0d\u65ad\u66f4\u65b0 TOTOLINK http://www.totolink.net/ FAST \u6781\u8def\u7531/hiwifi D-LINK TP-LINK MERCURY Tenda \u78ca\u79d1 \u7ef4\u76df http://www.wayos.com:8081/download/ \u827e\u6cf0 \u9510\u6377\u8def\u7531\u5668 \u98de\u9c7c\u661f newifi b-link \u534e\u7855 \u817e\u8fbe \u62d3\u5b9e netis \u534e\u7855","title":"\u6574\u7406\u7684\u4e00\u4e9b\u56fd\u5185\u8def\u7531\u5668\u5382\u5546\u7684\u56fa\u4ef6\u4e0b\u8f7d\u94fe\u63a5"},{"location":"hardware_security/","text":"\u6982\u8ff0 \u00b6 123","title":"\u6982\u8ff0"},{"location":"hardware_security/#_1","text":"123","title":"\u6982\u8ff0"},{"location":"tools_lib/","text":"\u6982\u8ff0 \u00b6 \u8be5\u5de5\u5177\u5e93\uff08Tool library\uff09\u7684\u5de5\u5177\u7ecf\u8fc7\u5b9e\u9a8c\u5ba4\u6210\u5458\u6574\u7406\u800c\u6210\u3002\u6db5\u76d6\u4e86\u786c\u4ef6\u5b89\u5168\u3001\u65e0\u7ebf\u7535\u5b89\u5168\u3001\u56fa\u4ef6\u5b89\u5168\u7b49\u76f8\u5173\u5de5\u5177\u3002 \u5efa\u7acb\u5de5\u5177\u5e93\u7684\u76ee\u7684\u662f\u5e2e\u52a9\u5927\u5bb6\u5728\u5b89\u5168\u7814\u7a76\u8fc7\u7a0b\u4e2d\uff0c\u53ef\u4ee5\u66f4\u65b9\u4fbf\u83b7\u53d6\u4e00\u4e9b\u6574\u5408\u540e\u6216\u8005\u56e0\u4e3a\u7f51\u7edc\u5ef6\u8fdf\u539f\u56e0\u4e0b\u8f7d\u4e0d\u5230\u7684\u5de5\u5177\uff0c\u540e\u7eed\u5de5\u5177\u5e93\u5c06\u4e0d\u65ad\u8865\u5145\u548c\u66f4\u65b0\u5b8c\u5584\u3002 \u5de5\u5177\u5e93\u7684\u94fe\u63a5 \u00b6 https://gitee.com/h4lo1/HatLab_Tools_Library \u56e0 github \u5728\u56fd\u5185\u8bbf\u95ee\u901f\u5ea6\u8f83\u6162\uff0c\u6240\u4ee5\u5c06\u5de5\u5177\u5e93\u6574\u5408\u3001\u8fc1\u79fb\u5230\u4e86 gitee \u4e0a\u3002 \u672c\u5730\u90e8\u7f72 \u00b6 git clone https://gitee.com/h4lo1/HatLab_Tools_Library","title":"\u6982\u8ff0"},{"location":"tools_lib/#_1","text":"\u8be5\u5de5\u5177\u5e93\uff08Tool library\uff09\u7684\u5de5\u5177\u7ecf\u8fc7\u5b9e\u9a8c\u5ba4\u6210\u5458\u6574\u7406\u800c\u6210\u3002\u6db5\u76d6\u4e86\u786c\u4ef6\u5b89\u5168\u3001\u65e0\u7ebf\u7535\u5b89\u5168\u3001\u56fa\u4ef6\u5b89\u5168\u7b49\u76f8\u5173\u5de5\u5177\u3002 \u5efa\u7acb\u5de5\u5177\u5e93\u7684\u76ee\u7684\u662f\u5e2e\u52a9\u5927\u5bb6\u5728\u5b89\u5168\u7814\u7a76\u8fc7\u7a0b\u4e2d\uff0c\u53ef\u4ee5\u66f4\u65b9\u4fbf\u83b7\u53d6\u4e00\u4e9b\u6574\u5408\u540e\u6216\u8005\u56e0\u4e3a\u7f51\u7edc\u5ef6\u8fdf\u539f\u56e0\u4e0b\u8f7d\u4e0d\u5230\u7684\u5de5\u5177\uff0c\u540e\u7eed\u5de5\u5177\u5e93\u5c06\u4e0d\u65ad\u8865\u5145\u548c\u66f4\u65b0\u5b8c\u5584\u3002","title":"\u6982\u8ff0"},{"location":"tools_lib/#_2","text":"https://gitee.com/h4lo1/HatLab_Tools_Library \u56e0 github \u5728\u56fd\u5185\u8bbf\u95ee\u901f\u5ea6\u8f83\u6162\uff0c\u6240\u4ee5\u5c06\u5de5\u5177\u5e93\u6574\u5408\u3001\u8fc1\u79fb\u5230\u4e86 gitee \u4e0a\u3002","title":"\u5de5\u5177\u5e93\u7684\u94fe\u63a5"},{"location":"tools_lib/#_3","text":"git clone https://gitee.com/h4lo1/HatLab_Tools_Library","title":"\u672c\u5730\u90e8\u7f72"},{"location":"tools_lib/env_building/","text":"\u4ea4\u53c9\u7f16\u8bd1\u73af\u5883\u5b89\u88c5 \u00b6 \u5305\u62ec mips\u3001mipsel\u3001armhf\u3001armel \u76f8\u5173\u811a\u672c\u89c1 gitee \u4ed3\u5e93\u6839\u8def\u5f84\u4e0b\u7684 env_building.sh \u811a\u672c\u3002","title":"Env building"},{"location":"tools_lib/env_building/#_1","text":"\u5305\u62ec mips\u3001mipsel\u3001armhf\u3001armel \u76f8\u5173\u811a\u672c\u89c1 gitee \u4ed3\u5e93\u6839\u8def\u5f84\u4e0b\u7684 env_building.sh \u811a\u672c\u3002","title":"\u4ea4\u53c9\u7f16\u8bd1\u73af\u5883\u5b89\u88c5"},{"location":"tools_lib/firmware_tools/","text":"\u73af\u5883\u642d\u5efa\u4ecb\u7ecd \u00b6 binwalk\uff1a \u00b6 git clone https://github.com/devttys0/binwalk.git cd binwalk sudo ./deps.sh sudo python ./setup.py install sudo apt-get install python-lzma sudo -H pip install git+https://github.com/ahupp/python-magic sudo -H pip install git+https://github.com/sviehb/jefferson firmadyne\uff1a \u00b6 git clone https://github.com/firmadyne/firmadyne cd firmadyne/ && sudo download.sh sudo -u postgres createuser -P firmadyne password: firmadyne sudo -u postgres createdb -O firmadyne firmware sudo -u postgres psql -d firmware < ./firmadyne/database/schema qemu-2.4.0: \u00b6 wget https://download.qemu.org/qemu-2.4.0.tar.xz tar xvf qemu-2.4.0.tar.xz && cd qemu-2.4.0/ ./configure --target-list=arm-softmmu,mips-softmmu,mipsel-softmmu --audio-drv-list=alsa,pa make -j8 sudo make install gdb-multiarch: \u00b6 sudo apt-get install gdb-multiarch gdbserver: \u00b6 https://github.com/hugsy/gdb-static IDA \u811a\u672c \u00b6 https://github.com/giantbranch/mipsAudit https://github.com/tigerpuma/idatool-devttys0- Ghidra \u00b6 https://www.nsa.gov/resources/everyone/ghidra/ qemu_system_arm \u00b6 https://people.debian.org/~aurel32/qemu/armhf/ firmwalker \u00b6 https://github.com/craigz28/firmwalker \u5de5\u5177\u5e93\u5305\u542b \u00b6 \u4ea4\u53c9\u7f16\u8bd1\u73af\u5883\u6e90\u7801 \u00b6 qemu \u6e90\u7801 \u00b6 qemu-2.10 qemu-2.5 qemu-trace \u00b6 qemu-system \u00b6 IDA \u63d2\u4ef6 \u00b6 mipsrop IDA_MIPS_EMU mipsAudit \u9759\u6001\u7f16\u8bd1\u7a0b\u5e8f\uff08\u5305\u542b mips\u3001mipsel\uff09 \u00b6 netcat busybox gdbserver \u4e00\u4e9b\u5382\u5546\u56fa\u4ef6 \u00b6 DLINK firmadyne \u6e90\u7801\uff08\u5305\u542b binary\uff09 \u00b6","title":"\u56fa\u4ef6\u5b89\u5168\u5de5\u5177"},{"location":"tools_lib/firmware_tools/#_1","text":"","title":"\u73af\u5883\u642d\u5efa\u4ecb\u7ecd"},{"location":"tools_lib/firmware_tools/#binwalk","text":"git clone https://github.com/devttys0/binwalk.git cd binwalk sudo ./deps.sh sudo python ./setup.py install sudo apt-get install python-lzma sudo -H pip install git+https://github.com/ahupp/python-magic sudo -H pip install git+https://github.com/sviehb/jefferson","title":"binwalk\uff1a"},{"location":"tools_lib/firmware_tools/#firmadyne","text":"git clone https://github.com/firmadyne/firmadyne cd firmadyne/ && sudo download.sh sudo -u postgres createuser -P firmadyne password: firmadyne sudo -u postgres createdb -O firmadyne firmware sudo -u postgres psql -d firmware < ./firmadyne/database/schema","title":"firmadyne\uff1a"},{"location":"tools_lib/firmware_tools/#qemu-240","text":"wget https://download.qemu.org/qemu-2.4.0.tar.xz tar xvf qemu-2.4.0.tar.xz && cd qemu-2.4.0/ ./configure --target-list=arm-softmmu,mips-softmmu,mipsel-softmmu --audio-drv-list=alsa,pa make -j8 sudo make install","title":"qemu-2.4.0:"},{"location":"tools_lib/firmware_tools/#gdb-multiarch","text":"sudo apt-get install gdb-multiarch","title":"gdb-multiarch:"},{"location":"tools_lib/firmware_tools/#gdbserver","text":"https://github.com/hugsy/gdb-static","title":"gdbserver:"},{"location":"tools_lib/firmware_tools/#ida","text":"https://github.com/giantbranch/mipsAudit https://github.com/tigerpuma/idatool-devttys0-","title":"IDA \u811a\u672c"},{"location":"tools_lib/firmware_tools/#ghidra","text":"https://www.nsa.gov/resources/everyone/ghidra/","title":"Ghidra"},{"location":"tools_lib/firmware_tools/#qemu_system_arm","text":"https://people.debian.org/~aurel32/qemu/armhf/","title":"qemu_system_arm"},{"location":"tools_lib/firmware_tools/#firmwalker","text":"https://github.com/craigz28/firmwalker","title":"firmwalker"},{"location":"tools_lib/firmware_tools/#_2","text":"","title":"\u5de5\u5177\u5e93\u5305\u542b"},{"location":"tools_lib/firmware_tools/#_3","text":"","title":"\u4ea4\u53c9\u7f16\u8bd1\u73af\u5883\u6e90\u7801"},{"location":"tools_lib/firmware_tools/#qemu","text":"qemu-2.10 qemu-2.5","title":"qemu \u6e90\u7801"},{"location":"tools_lib/firmware_tools/#qemu-trace","text":"","title":"qemu-trace"},{"location":"tools_lib/firmware_tools/#qemu-system","text":"","title":"qemu-system"},{"location":"tools_lib/firmware_tools/#ida_1","text":"mipsrop IDA_MIPS_EMU mipsAudit","title":"IDA \u63d2\u4ef6"},{"location":"tools_lib/firmware_tools/#mipsmipsel","text":"netcat busybox gdbserver","title":"\u9759\u6001\u7f16\u8bd1\u7a0b\u5e8f\uff08\u5305\u542b mips\u3001mipsel\uff09"},{"location":"tools_lib/firmware_tools/#_4","text":"DLINK","title":"\u4e00\u4e9b\u5382\u5546\u56fa\u4ef6"},{"location":"tools_lib/firmware_tools/#firmadyne-binary","text":"","title":"firmadyne \u6e90\u7801\uff08\u5305\u542b binary\uff09"},{"location":"wireless_security/bluetooth_security/base_intro/Active_Scanning_vs_Passive_Scanning/","text":"Sourcell@\u6d77\u7279\u5b9e\u9a8c\u5ba4 BLE (Bluetooth Low Energy) \u8bbe\u5907\u53ef\u4ee5\u901a\u8fc7\u626b\u63cf\u53d1\u73b0\u5468\u56f4\u7684\u5176\u4ed6 BLE \u8bbe\u5907\u3002\u5f53 BLE \u8bbe\u5907\u6267\u884c\u626b\u63cf\u65f6\u4fbf\u5904\u5728 scanning state\u3002\u8be5\u72b6\u6001\u662f BLE \u8bbe\u5907\u5728 LL (Link Layer) \u7684\u72b6\u6001\u4e4b\u4e00\u3002\u5b83\u4e0e\u5176\u4ed6\u51e0\u79cd LL \u72b6\u6001\u6784\u6210\u4e86\u5982\u4e0b\u72b6\u6001\u673a\uff1a \u5904\u4e8e scanning state \u7684 BLE \u8bbe\u5907\u88ab\u79f0\u4e3a scanner\u3002\u5bf9\u5e94\u7684\uff0c\u5f53 BLE \u8bbe\u5907\u60f3\u8ba9\u5176\u4ed6\u8bbe\u5907\u53d1\u73b0\u81ea\u5df1\u65f6\u4f1a\u5904\u5728 advertising state\u3002\u6b64\u65f6 BLE \u8bbe\u5907\u88ab\u79f0\u4e3a advertiser\u3002 Scanning Type \u00b6 BLE \u8bbe\u5907\u4e3b\u8981\u53ef\u6267\u884c\u4e24\u79cd\u626b\u63cf active scanning \u548c passive scanning\uff08\u66f4\u590d\u6742\u7684\u626b\u63cf\u60c5\u51b5\u53ef\u53c2\u8003 ref 2\uff09\u3002\u5177\u4f53\u4f7f\u7528\u4f55\u79cd\u626b\u63cf\u65b9\u5f0f\u7531 HCI_LE_Set_Scan_Parameters command \u63a7\u5236\u3002\u8be5\u547d\u4ee4\u4e2d\u6709\u4e00\u4e2a LE_Scan_Type \u53c2\u6570\uff0c\u5f53\u8bbe\u4e3a 0x00 \u65f6\u6267\u884c passive scanning\uff1a Bluetooth HCI Command - LE Set Scan Parameters Command Opcode: LE Set Scan Parameters (0x200b) Parameter Total Length: 7 Scan Type: Passive (0x00) Scan Interval: 16 (10 msec) Scan Window: 16 (10 msec) Own Address Type: Public Device Address (0x00) Scan Filter Policy: Accept all advertisements, except directed advertisements not addressed to this device (0x00) \u5f53\u8bbe\u4e3a 0x01 \u65f6\u6267\u884c active scanning\uff1a Bluetooth HCI Command - LE Set Scan Parameters Command Opcode: LE Set Scan Parameters (0x200b) Parameter Total Length: 7 Scan Type: Active (0x01) Scan Interval: 16 (10 msec) Scan Window: 16 (10 msec) Own Address Type: Public Device Address (0x00) Scan Filter Policy: Accept all advertisements, except directed advertisements not addressed to this device (0x00) [Response in frame: 2] [Command-Response Delta: 1.784ms] \u5176\u4ed6\u7684\u503c\u76ee\u524d\u5747\u88ab\u4fdd\u7559\u3002 HCI_LE_Set_Scan_Parameters command \u53ea\u662f\u914d\u7f6e\u4e86\u626b\u63cf\u7684\u53c2\u6570\uff0c\u8981\u771f\u6b63\u5f00\u59cb\u626b\u63cf\u8fd8\u9700\u8981\u53d1\u9001 HCI_LE_Set_Scan_Enable command\uff1a Bluetooth HCI Command - LE Set Scan Enable Command Opcode: LE Set Scan Enable (0x200c) Parameter Total Length: 2 Scan Enable: true (0x01) Filter Duplicates: true (0x01) Passive scanning \u7684\u6570\u636e\u6d41\u5982\u4e0b[3]\uff1a Active scanning \u7684\u6570\u636e\u6d41\u5982\u4e0b[4]\uff1a Active Scanning \u4e0e Passive Scanning \u7684\u9690\u853d\u6027 \u00b6 \u5bf9\u4e8e passive scanning\uff0c\u5b83\u4ec5\u5728 LL \u4e0a\u5b89\u9759\u5730\u63a5\u6536\u7a7a\u4e2d\u98d8\u8fc7\u7684\u5404\u79cd advertising PDUs\uff0c\u7edd\u4e0d\u4f1a\u4e3b\u52a8\u53d1\u9001\u5176\u4ed6\u6570\u636e\u3002\u56e0\u6b64 passive scanning \u5f88\u9690\u853d\uff0c\u4e0d\u4f1a\u66b4\u9732 scanner \u7684\u4efb\u4f55\u4fe1\u606f\u3002 \u5bf9\u4e8e active scanning\uff0c\u5b83\u9664\u4e86\u50cf passive scanning \u4e00\u6837\u63a5\u6536\u7a7a\u4e2d\u7684 advertising PDUs\uff0c\u8fd8\u4f1a\u4e3b\u52a8\u5411 advertiser \u53d1\u9001 SCAN_REQ PDU\uff0c\u7136\u540e\u63a5\u6536 advertiser \u54cd\u5e94\u7684 SCAN_RSP PDU\uff0c\u4ece\u800c\u83b7\u53d6 advertiser \u66f4\u591a\u7684\u4fe1\u606f\uff1a \u4e0d\u8fc7 SCAN_REQ PDU \u4f1a\u643a\u5e26 scanner \u7684 address\uff0c\u5373\u4e0a\u56fe\u4e2d\u7684 ScanA \u5b57\u6bb5\u3002\u8fd9\u53ef\u80fd\u4f1a\u66b4\u9732 scanner \u7684\u8eab\u4efd\u3002\u56e0\u6b64\u5728\u6267\u884c active scanning \u65f6\uff0c\u6211\u4eec\u6700\u597d\u4f7f\u7528 spooftooph \u4f2a\u9020\u81ea\u5df1\u7684 BD_ADDR\uff0c\u9632\u6b62\u771f\u5b9e BD_ADDR \u88ab\u66b4\u9732\u3002 \u89e3\u6790\u626b\u63cf\u7ed3\u679c \u00b6 \u4e0d\u8bba\u662f active scanning \u8fd8\u662f passive scanning\uff0c\u626b\u63cf\u7684\u7ed3\u679c\u5747\u4ee5 HCI_LE_Advertising_Report event \u7684\u5f62\u5f0f\u8fd4\u56de\u7ed9 host\u3002\u8be5 event \u643a\u5e26\u7684 Event_Type parameter \u6709\u5982\u4e0b 5 \u79cd\u53d6\u503c[5]\uff0c\u8bf4\u660e\u4e86\u626b\u63cf\u7ed3\u679c\u6765\u81ea\u4e8e\u54ea\u4e00\u79cd advertising PDU\uff1a Value Description 0x00 ADV_IND PDU 0x01 ADV_DIRECT_IND PDU 0x02 ADV_SCAN_IND PDU 0x03 ADV_NONCONN_IND PDU 0x04 SCAN_RSP PDU All other values RFU \u5bf9\u4e8e\u8fd4\u56de\u7684\u7ed3\u679c\uff0cpassive scanning \u4e0e active scanning \u7684\u533a\u522b\u4f53\u73b0\u5728 SCAN_RSP PDU \u4e0a\u3002Active scanning \u6709\u80fd\u529b\u8fd4\u56de SCAN_RSP PDU\uff0c\u800c passive scanning \u4e0d\u53ef\u80fd\u8fd4\u56de SCAN_RSP PDU\u3002 \u5177\u4f53\u626b\u63cf\u5f97\u5230\u7684\u6570\u636e\u5b58\u50a8\u5728 Data \u53c2\u6570\u4e2d\u3002\u8be5\u53c2\u6570\u4e5f\u6709\u534f\u8bae\u5b9a\u4e49\u7684\u683c\u5f0f\uff0c\u7b80\u5355\u7684\u8bf4\u5b83\u662f\u4e00\u4e2a AD (Advertising Data) structure \u6570\u7ec4\u3002AD structure \u7684\u683c\u5f0f\u5982\u4e0b[6]\uff1a +--------+-------------------+ | Length | Data | +--------+-------------------+ | AD Type | AD Data | +-------------------+ \u5176\u4e2d AD Type \u7684\u542b\u4e49\u7531 GAP (Generic Access Profile) \u5b9a\u4e49\u3002 \u8fd9\u91cc\u4e3e\u4e24\u4e2a\u4f8b\u5b50\u3002\u6bd4\u5982 passive scanning \u8fd4\u56de\u7684\u626b\u63cf\u7ed3\u679c\u5982\u4e0b\uff1a Bluetooth HCI Event - LE Meta Event Code: LE Meta (0x3e) Parameter Total Length: 30 Sub Event: LE Advertising Report (0x02) Num Reports: 1 Event Type: Connectable Undirected Advertising (0x00) Peer Address Type: Public Device Address (0x00) BD_ADDR: Espressi_9c:07:06 (24:0a:c4:9c:07:06) Data Length: 18 Advertising Data Flags Length: 2 Type: Flags (0x01) 1. .... = Reserved: 0x0 ...0 .... = Simultaneous LE and BR/EDR to Same Device Capable (Host): false (0x0) .... 0... = Simultaneous LE and BR/EDR to Same Device Capable (Controller): false (0x0) .... .1.. = BR/EDR Not Supported: true (0x1) .... ..1. = LE General Discoverable Mode: true (0x1) .... ...0 = LE Limited Discoverable Mode: false (0x0) Tx Power Level Length: 2 Type: Tx Power Level (0x0a) Power Level (dBm): -21 16-bit Service Class UUIDs Length: 3 Type: 16-bit Service Class UUIDs (0x03) UUID 16: Unknown (0x00ff) Device Name: BLECTF Length: 7 Type: Device Name (0x09) Device Name: BLECTF RSSI: -65dBm \u518d\u6bd4\u5982 Active scanning \u56e0 SCAN_RSP PDU \u8fd4\u56de\u626b\u63cf\u7ed3\u679c\u5982\u4e0b\uff1a Bluetooth HCI Event - LE Meta Event Code: LE Meta (0x3e) Parameter Total Length: 22 Sub Event: LE Advertising Report (0x02) Num Reports: 1 Event Type: Scan Response (0x04) Peer Address Type: Public Device Address (0x00) BD_ADDR: Espressi_9c:07:06 (24:0a:c4:9c:07:06) Data Length: 10 Advertising Data Flags Length: 2 Type: Flags (0x01) 1. .... = Reserved: 0x0 ...0 .... = Simultaneous LE and BR/EDR to Same Device Capable (Host): false (0x0) .... 0... = Simultaneous LE and BR/EDR to Same Device Capable (Controller): false (0x0) .... .1.. = BR/EDR Not Supported: true (0x1) .... ..1. = LE General Discoverable Mode: true (0x1) .... ...0 = LE Limited Discoverable Mode: false (0x0) Tx Power Level Length: 2 Type: Tx Power Level (0x0a) Power Level (dBm): -21 16-bit Service Class UUIDs Length: 3 Type: 16-bit Service Class UUIDs (0x03) UUID 16: Unknown (0x00ff) RSSI: -68dBm \u5b9e\u6218\u4e2d Active Scanning \u4e0d\u4e00\u5b9a\u6bd4 Passive Scanning \u66f4\u6709\u6548 \u00b6 \u5728\u60c5\u62a5\u6536\u96c6\u9636\u6bb5\uff0c\u6211\u4eec\u5f88\u5173\u5fc3\u76ee\u6807\u8bbe\u5907\u7684\u540d\u5b57\u3002\u4f46\u662f\u5382\u5546\u7ed9\u51fa\u8bbe\u5907\u540d\u79f0\u7684\u4f4d\u7f6e\u662f\u4e0d\u786e\u5b9a\u7684\u3002\u8bbe\u5907\u540d\u79f0\u53ef\u80fd\u4f4d\u4e8e advertising data \u4e5f\u53ef\u80fd\u4f4d\u4e8e scan response data\u3002\u56e0\u6b64\u6709\u65f6\u4f7f\u7528 passive scanning \u4e5f\u80fd\u83b7\u53d6\u76ee\u6807\u8bbe\u5907\u7684\u540d\u5b57\u3002 \u53e6\u5916\uff0c\u5382\u5546\u4e0d\u4e00\u5b9a\u4f7f\u7528 GAP \u5b9a\u4e49\u7684 AD Type 0x09 (Complete Local Name) \u6765\u5b58\u50a8\u8bbe\u5907\u7684\u540d\u5b57\u3002\u56e0\u4e3a GAP \u8fd8\u5b9a\u4e49\u4e86 AD Type 0xFF (Manufacturer Specific Data)\uff0c\u5382\u5546\u4e5f\u53ef\u80fd\u628a\u8bbe\u5907\u7684\u540d\u5b57\u653e\u5728\u5176\u4e2d\u5e76\u5b9a\u4e49\u81ea\u5df1\u7684\u89e3\u6790\u89c4\u5219\u3002 \u56e0\u6b64\u5728\u65e0\u6cd5\u4f2a\u88c5 BD_ADDR \u65f6\uff0c\u53ef\u4ee5\u76f4\u63a5\u8bd5\u8bd5 passive scanning \u80fd\u5426\u89e3\u51b3\u95ee\u9898\u3002 References \u00b6 BLUETOOTH CORE SPECIFICATION Version 5.2 | Vol 6, Part B page 2857, Figure 1.1: State diagram of the Link Layer state machine BLUETOOTH CORE SPECIFICATION Version 5.2 | Vol 6, Part D page 3114, 4 SCANNING STATE BLUETOOTH CORE SPECIFICATION Version 5.2 | Vol 6, Part D page 3114, 4.1 PASSIVE SCANNING BLUETOOTH CORE SPECIFICATION Version 5.2 | Vol 6, Part D page 3115, 4.2 ACTIVE SCANNING BLUETOOTH CORE SPECIFICATION Version 5.2 | Vol 4, Part E page 2382, 7.7.65.2 LE Advertising Report event BLUETOOTH CORE SPECIFICATION Version 5.2 | Vol 3, Part C page 1392, BLUETOOTH CORE SPECIFICATION Version 5.2 | Vol 3, Part C page 1392 Assigned numbers and GAP","title":"Active Scanning vs. Passive Scanning"},{"location":"wireless_security/bluetooth_security/base_intro/Active_Scanning_vs_Passive_Scanning/#scanning-type","text":"BLE \u8bbe\u5907\u4e3b\u8981\u53ef\u6267\u884c\u4e24\u79cd\u626b\u63cf active scanning \u548c passive scanning\uff08\u66f4\u590d\u6742\u7684\u626b\u63cf\u60c5\u51b5\u53ef\u53c2\u8003 ref 2\uff09\u3002\u5177\u4f53\u4f7f\u7528\u4f55\u79cd\u626b\u63cf\u65b9\u5f0f\u7531 HCI_LE_Set_Scan_Parameters command \u63a7\u5236\u3002\u8be5\u547d\u4ee4\u4e2d\u6709\u4e00\u4e2a LE_Scan_Type \u53c2\u6570\uff0c\u5f53\u8bbe\u4e3a 0x00 \u65f6\u6267\u884c passive scanning\uff1a Bluetooth HCI Command - LE Set Scan Parameters Command Opcode: LE Set Scan Parameters (0x200b) Parameter Total Length: 7 Scan Type: Passive (0x00) Scan Interval: 16 (10 msec) Scan Window: 16 (10 msec) Own Address Type: Public Device Address (0x00) Scan Filter Policy: Accept all advertisements, except directed advertisements not addressed to this device (0x00) \u5f53\u8bbe\u4e3a 0x01 \u65f6\u6267\u884c active scanning\uff1a Bluetooth HCI Command - LE Set Scan Parameters Command Opcode: LE Set Scan Parameters (0x200b) Parameter Total Length: 7 Scan Type: Active (0x01) Scan Interval: 16 (10 msec) Scan Window: 16 (10 msec) Own Address Type: Public Device Address (0x00) Scan Filter Policy: Accept all advertisements, except directed advertisements not addressed to this device (0x00) [Response in frame: 2] [Command-Response Delta: 1.784ms] \u5176\u4ed6\u7684\u503c\u76ee\u524d\u5747\u88ab\u4fdd\u7559\u3002 HCI_LE_Set_Scan_Parameters command \u53ea\u662f\u914d\u7f6e\u4e86\u626b\u63cf\u7684\u53c2\u6570\uff0c\u8981\u771f\u6b63\u5f00\u59cb\u626b\u63cf\u8fd8\u9700\u8981\u53d1\u9001 HCI_LE_Set_Scan_Enable command\uff1a Bluetooth HCI Command - LE Set Scan Enable Command Opcode: LE Set Scan Enable (0x200c) Parameter Total Length: 2 Scan Enable: true (0x01) Filter Duplicates: true (0x01) Passive scanning \u7684\u6570\u636e\u6d41\u5982\u4e0b[3]\uff1a Active scanning \u7684\u6570\u636e\u6d41\u5982\u4e0b[4]\uff1a","title":"Scanning Type"},{"location":"wireless_security/bluetooth_security/base_intro/Active_Scanning_vs_Passive_Scanning/#active-scanning-passive-scanning","text":"\u5bf9\u4e8e passive scanning\uff0c\u5b83\u4ec5\u5728 LL \u4e0a\u5b89\u9759\u5730\u63a5\u6536\u7a7a\u4e2d\u98d8\u8fc7\u7684\u5404\u79cd advertising PDUs\uff0c\u7edd\u4e0d\u4f1a\u4e3b\u52a8\u53d1\u9001\u5176\u4ed6\u6570\u636e\u3002\u56e0\u6b64 passive scanning \u5f88\u9690\u853d\uff0c\u4e0d\u4f1a\u66b4\u9732 scanner \u7684\u4efb\u4f55\u4fe1\u606f\u3002 \u5bf9\u4e8e active scanning\uff0c\u5b83\u9664\u4e86\u50cf passive scanning \u4e00\u6837\u63a5\u6536\u7a7a\u4e2d\u7684 advertising PDUs\uff0c\u8fd8\u4f1a\u4e3b\u52a8\u5411 advertiser \u53d1\u9001 SCAN_REQ PDU\uff0c\u7136\u540e\u63a5\u6536 advertiser \u54cd\u5e94\u7684 SCAN_RSP PDU\uff0c\u4ece\u800c\u83b7\u53d6 advertiser \u66f4\u591a\u7684\u4fe1\u606f\uff1a \u4e0d\u8fc7 SCAN_REQ PDU \u4f1a\u643a\u5e26 scanner \u7684 address\uff0c\u5373\u4e0a\u56fe\u4e2d\u7684 ScanA \u5b57\u6bb5\u3002\u8fd9\u53ef\u80fd\u4f1a\u66b4\u9732 scanner \u7684\u8eab\u4efd\u3002\u56e0\u6b64\u5728\u6267\u884c active scanning \u65f6\uff0c\u6211\u4eec\u6700\u597d\u4f7f\u7528 spooftooph \u4f2a\u9020\u81ea\u5df1\u7684 BD_ADDR\uff0c\u9632\u6b62\u771f\u5b9e BD_ADDR \u88ab\u66b4\u9732\u3002","title":"Active Scanning \u4e0e Passive Scanning \u7684\u9690\u853d\u6027"},{"location":"wireless_security/bluetooth_security/base_intro/Active_Scanning_vs_Passive_Scanning/#_1","text":"\u4e0d\u8bba\u662f active scanning \u8fd8\u662f passive scanning\uff0c\u626b\u63cf\u7684\u7ed3\u679c\u5747\u4ee5 HCI_LE_Advertising_Report event \u7684\u5f62\u5f0f\u8fd4\u56de\u7ed9 host\u3002\u8be5 event \u643a\u5e26\u7684 Event_Type parameter \u6709\u5982\u4e0b 5 \u79cd\u53d6\u503c[5]\uff0c\u8bf4\u660e\u4e86\u626b\u63cf\u7ed3\u679c\u6765\u81ea\u4e8e\u54ea\u4e00\u79cd advertising PDU\uff1a Value Description 0x00 ADV_IND PDU 0x01 ADV_DIRECT_IND PDU 0x02 ADV_SCAN_IND PDU 0x03 ADV_NONCONN_IND PDU 0x04 SCAN_RSP PDU All other values RFU \u5bf9\u4e8e\u8fd4\u56de\u7684\u7ed3\u679c\uff0cpassive scanning \u4e0e active scanning \u7684\u533a\u522b\u4f53\u73b0\u5728 SCAN_RSP PDU \u4e0a\u3002Active scanning \u6709\u80fd\u529b\u8fd4\u56de SCAN_RSP PDU\uff0c\u800c passive scanning \u4e0d\u53ef\u80fd\u8fd4\u56de SCAN_RSP PDU\u3002 \u5177\u4f53\u626b\u63cf\u5f97\u5230\u7684\u6570\u636e\u5b58\u50a8\u5728 Data \u53c2\u6570\u4e2d\u3002\u8be5\u53c2\u6570\u4e5f\u6709\u534f\u8bae\u5b9a\u4e49\u7684\u683c\u5f0f\uff0c\u7b80\u5355\u7684\u8bf4\u5b83\u662f\u4e00\u4e2a AD (Advertising Data) structure \u6570\u7ec4\u3002AD structure \u7684\u683c\u5f0f\u5982\u4e0b[6]\uff1a +--------+-------------------+ | Length | Data | +--------+-------------------+ | AD Type | AD Data | +-------------------+ \u5176\u4e2d AD Type \u7684\u542b\u4e49\u7531 GAP (Generic Access Profile) \u5b9a\u4e49\u3002 \u8fd9\u91cc\u4e3e\u4e24\u4e2a\u4f8b\u5b50\u3002\u6bd4\u5982 passive scanning \u8fd4\u56de\u7684\u626b\u63cf\u7ed3\u679c\u5982\u4e0b\uff1a Bluetooth HCI Event - LE Meta Event Code: LE Meta (0x3e) Parameter Total Length: 30 Sub Event: LE Advertising Report (0x02) Num Reports: 1 Event Type: Connectable Undirected Advertising (0x00) Peer Address Type: Public Device Address (0x00) BD_ADDR: Espressi_9c:07:06 (24:0a:c4:9c:07:06) Data Length: 18 Advertising Data Flags Length: 2 Type: Flags (0x01) 1. .... = Reserved: 0x0 ...0 .... = Simultaneous LE and BR/EDR to Same Device Capable (Host): false (0x0) .... 0... = Simultaneous LE and BR/EDR to Same Device Capable (Controller): false (0x0) .... .1.. = BR/EDR Not Supported: true (0x1) .... ..1. = LE General Discoverable Mode: true (0x1) .... ...0 = LE Limited Discoverable Mode: false (0x0) Tx Power Level Length: 2 Type: Tx Power Level (0x0a) Power Level (dBm): -21 16-bit Service Class UUIDs Length: 3 Type: 16-bit Service Class UUIDs (0x03) UUID 16: Unknown (0x00ff) Device Name: BLECTF Length: 7 Type: Device Name (0x09) Device Name: BLECTF RSSI: -65dBm \u518d\u6bd4\u5982 Active scanning \u56e0 SCAN_RSP PDU \u8fd4\u56de\u626b\u63cf\u7ed3\u679c\u5982\u4e0b\uff1a Bluetooth HCI Event - LE Meta Event Code: LE Meta (0x3e) Parameter Total Length: 22 Sub Event: LE Advertising Report (0x02) Num Reports: 1 Event Type: Scan Response (0x04) Peer Address Type: Public Device Address (0x00) BD_ADDR: Espressi_9c:07:06 (24:0a:c4:9c:07:06) Data Length: 10 Advertising Data Flags Length: 2 Type: Flags (0x01) 1. .... = Reserved: 0x0 ...0 .... = Simultaneous LE and BR/EDR to Same Device Capable (Host): false (0x0) .... 0... = Simultaneous LE and BR/EDR to Same Device Capable (Controller): false (0x0) .... .1.. = BR/EDR Not Supported: true (0x1) .... ..1. = LE General Discoverable Mode: true (0x1) .... ...0 = LE Limited Discoverable Mode: false (0x0) Tx Power Level Length: 2 Type: Tx Power Level (0x0a) Power Level (dBm): -21 16-bit Service Class UUIDs Length: 3 Type: 16-bit Service Class UUIDs (0x03) UUID 16: Unknown (0x00ff) RSSI: -68dBm","title":"\u89e3\u6790\u626b\u63cf\u7ed3\u679c"},{"location":"wireless_security/bluetooth_security/base_intro/Active_Scanning_vs_Passive_Scanning/#active-scanning-passive-scanning_1","text":"\u5728\u60c5\u62a5\u6536\u96c6\u9636\u6bb5\uff0c\u6211\u4eec\u5f88\u5173\u5fc3\u76ee\u6807\u8bbe\u5907\u7684\u540d\u5b57\u3002\u4f46\u662f\u5382\u5546\u7ed9\u51fa\u8bbe\u5907\u540d\u79f0\u7684\u4f4d\u7f6e\u662f\u4e0d\u786e\u5b9a\u7684\u3002\u8bbe\u5907\u540d\u79f0\u53ef\u80fd\u4f4d\u4e8e advertising data \u4e5f\u53ef\u80fd\u4f4d\u4e8e scan response data\u3002\u56e0\u6b64\u6709\u65f6\u4f7f\u7528 passive scanning \u4e5f\u80fd\u83b7\u53d6\u76ee\u6807\u8bbe\u5907\u7684\u540d\u5b57\u3002 \u53e6\u5916\uff0c\u5382\u5546\u4e0d\u4e00\u5b9a\u4f7f\u7528 GAP \u5b9a\u4e49\u7684 AD Type 0x09 (Complete Local Name) \u6765\u5b58\u50a8\u8bbe\u5907\u7684\u540d\u5b57\u3002\u56e0\u4e3a GAP \u8fd8\u5b9a\u4e49\u4e86 AD Type 0xFF (Manufacturer Specific Data)\uff0c\u5382\u5546\u4e5f\u53ef\u80fd\u628a\u8bbe\u5907\u7684\u540d\u5b57\u653e\u5728\u5176\u4e2d\u5e76\u5b9a\u4e49\u81ea\u5df1\u7684\u89e3\u6790\u89c4\u5219\u3002 \u56e0\u6b64\u5728\u65e0\u6cd5\u4f2a\u88c5 BD_ADDR \u65f6\uff0c\u53ef\u4ee5\u76f4\u63a5\u8bd5\u8bd5 passive scanning \u80fd\u5426\u89e3\u51b3\u95ee\u9898\u3002","title":"\u5b9e\u6218\u4e2d Active Scanning \u4e0d\u4e00\u5b9a\u6bd4 Passive Scanning \u66f4\u6709\u6548"},{"location":"wireless_security/bluetooth_security/base_intro/Active_Scanning_vs_Passive_Scanning/#references","text":"BLUETOOTH CORE SPECIFICATION Version 5.2 | Vol 6, Part B page 2857, Figure 1.1: State diagram of the Link Layer state machine BLUETOOTH CORE SPECIFICATION Version 5.2 | Vol 6, Part D page 3114, 4 SCANNING STATE BLUETOOTH CORE SPECIFICATION Version 5.2 | Vol 6, Part D page 3114, 4.1 PASSIVE SCANNING BLUETOOTH CORE SPECIFICATION Version 5.2 | Vol 6, Part D page 3115, 4.2 ACTIVE SCANNING BLUETOOTH CORE SPECIFICATION Version 5.2 | Vol 4, Part E page 2382, 7.7.65.2 LE Advertising Report event BLUETOOTH CORE SPECIFICATION Version 5.2 | Vol 3, Part C page 1392, BLUETOOTH CORE SPECIFICATION Version 5.2 | Vol 3, Part C page 1392 Assigned numbers and GAP","title":"References"},{"location":"wireless_security/bluetooth_security/base_intro/Class_of_Device/","text":"Sourcell@\u6d77\u7279\u5b9e\u9a8c\u5ba4 Class of device\uff0c\u7b80\u79f0 CoD\uff0c\u7528\u4e8e\u63cf\u8ff0\u4e00\u4e2a BR/EDR \u8bbe\u5907\u7684\u7c7b\u578b\u3002 \u672c\u5730\u8bbe\u5907\u53d1\u8d77 inquiry ( HCI_Inquiry command) \u540e\uff0c\u8fdc\u7aef\u5904\u4e8e inquiry scan \u72b6\u6001\u7684\u8bbe\u5907\u4f1a\u54cd\u5e94\u4e00\u4e9b\u57fa\u672c\u6570\u636e\u3002\u8fd9\u4e9b\u6570\u636e\u88ab controller \u5c01\u88c5\u5728 event \u4e2d\u8fd4\u56de\u7ed9 host\u3002CoD \u5219\u662f\u8fd9\u4e9b event \u4e2d\u7684\u4e00\u4e2a\u53c2\u6570\u3002\u6b64\u65f6\u5305\u542b\u53ef\u80fd CoD \u7684 event \u5982\u4e0b\uff1a HCI_Inquiry_Result event HCI_Inquiry_Result_with_RSSI event HCI_Extended_Inquiry_Result event \u53e6\u5916\u5f53\u672c\u5730\u8bbe\u5907\u6536\u5230\u8fdc\u7aef\u8bbe\u5907\u7684\u8fde\u63a5\u8bf7\u6c42\u65f6\uff0c\u5c06\u6536\u5230 HCI_Connection_Request event\u3002\u8be5 event \u4e5f\u4f1a\u643a\u5e26 CoD\u3002 \u89e3\u6790 CoD \u7ed3\u6784 \u00b6 CoD \u7684\u683c\u5f0f\u662f\u53ef\u53d8\u7684\uff0c\u5177\u4f53\u7684\u683c\u5f0f\u7531 Format Type \u5b57\u6bb5\u6307\u5b9a\u3002\u5176\u4e2d\u6700\u5e38\u89c1\u7684\u683c\u5f0f\u662f \"format #1\"\uff0c\u4e14\u5176\u4ed6\u683c\u5f0f\u6781\u5176\u7f55\u89c1\u3002\u6b64\u65f6 CoD \u662f\u4e00\u4e2a\u5927\u5c0f\u4e3a 3 bytes \u7684\u6570\u503c\uff0c\u5b83\u7684\u7ed3\u6784\u5982\u4e0b\u56fe\u6240\u793a\uff081 st byte \u4e3a\u6700\u9ad8\u5b57\u8282\uff09\uff1a \u4e0b\u9762\u5c06\u5206\u522b\u89e3\u91ca\u7ec4\u6210 CoD \u7684 3 \u4e2a\u4e3b\u8981\u5b57\u6bb5 Service Class, Major Device Class \u4e0e Minor Device Class\u3002 Service Class \u00b6 \u4e0b\u9762\u4e3a 0 \u7684\u4f4d\u88ab\u4fdd\u7559\u4f7f\u7528 Flag Description Example 1... .... 00. Information WEB-server, WAP-server .1.. .... 00. Telephony Cordless telephony, Modem, Headset service ..1. .... 00. Audio Speaker, Microphone, Headset service ...1 .... 00. Object Transfer v-Inbox, v-Folder .... 1... 00. Capturing Scanner, Microphone .... .1.. 00. Rendering Printing, Speaker .... ..1. 00. Networking LAN, Ad hoc .... ...1 00. Positioning Location identification .... .... 001 Limited Discoverable Mode Major Device Class \u00b6 Value Description Example 0b00000 Miscellaneous 0b00001 Computer Desktop, Notebook, PDA, Organizers 0b00010 Phone Cellular, Cordless, Payphone, Modem 0b00011 LAN /Network Access point 0b00100 Audio/Video Headset, Speaker, Stereo, Video display, VCR 0b00101 Peripheral (HID) Mouse, Joystick, Keyboards 0b00110 Imaging Printing, Scanner, Camera, Display 0b00111 Wearable 0b01000 Toy 0b01001 Health 0b11111 Uncategorized Others Reserved Minor Device Class \u00b6 \u8be5\u5b57\u6bb5\u867d\u7136\u4ec5\u5360\u7528 8 bits\uff0c\u4f46\u662f\u5f53 major device class \u4e0d\u540c\u65f6\uff0c\u6bcf\u4e2a bit \u7684\u542b\u4e49\u4e5f\u4e0d\u540c\u3002\u56e0\u6b64\u8be5\u5b57\u6bb5\u7684\u5b9a\u4e49\u5f88\u7e41\u6742\uff0c\u4e0d\u5728\u8fd9\u91cc\u8d58\u8ff0\u3002\u5177\u4f53\u53ef\u4ee5\u53c2\u8003 ref [1]\u3002 \u4e00\u4e2a\u89e3\u6790 CoD \u7684\u4f8b\u5b50 \u00b6 \u5f53 CoD \u4e3a 0x002540 \u65f6\u6709\uff1a 0... .... .... .... .... .... = Service Classes: Information: False .0.. .... .... .... .... .... = Service Classes: Telephony: False ..0. .... .... .... .... .... = Service Classes: Audio: False ...0 .... .... .... .... .... = Service Classes: Object Transfer: False .... 0... .... .... .... .... = Service Classes: Capturing: False .... .0.. .... .... .... .... = Service Classes: Rendering: False .... ..0. .... .... .... .... = Service Classes: Networking: False .... ...0 .... .... .... .... = Service Classes: Positioning: False .... .... 00.. .... .... .... = Service Classes: Reserved: 0x0 .... .... ..1. .... .... .... = Service Classes: Limited Discoverable Mode: True .... .... ...0 0101 .... .... = Major Device Class: Peripheral (HID) (0x05) .... .... .... .... 01.. .... = Minor Device Class: Keyboard (0x1) .... .... .... .... ..00 00.. = Minor Device Class: Uncategorized device (0x0) .... .... .... .... .... ..00 = Format Type: 0x0 CoD \u7684\u4f2a\u88c5 \u00b6 CoD \u5e76\u4e0d\u662f\u5199\u6b7b\u5728 controller \u4e2d\u7684\u6570\u636e\uff0c\u5b9e\u9645\u4e0a\u5b83\u88ab host \u7ba1\u7406\u3002Host \u53ef\u4ee5\u4f7f\u7528 HCI_Write_Class_of_Device command \u4fee\u6539\u672c\u5730\u8bbe\u5907\u7684\u7c7b\u578b\uff0c\u4ece\u800c\u8fbe\u5230\u4f2a\u88c5\u7684\u76ee\u7684\u3002\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\u53ef\u4ee5\u8bfb\u53d6\u6216\u4fee\u6539\u672c\u5730 BR/EDR \u8bbe\u5907\u7684\u7c7b\u578b\uff1a hciconfig hci0 class # hci0: Type: Primary Bus: USB # BD Address: 11:22:33:44:55:19 ACL MTU: 310:10 SCO MTU: 64:8 # Class: 0x0c0000 # Service Classes: Rendering, Capturing # Device Class: Miscellaneous, sudo hciconfig hci0 class 0x002540 hciconfig hci0 class # hci0: Type: Primary Bus: USB # BD Address: 11:22:33:44:55:19 ACL MTU: 310:10 SCO MTU: 64:8 # Class: 0x002540 # Service Classes: Unspecified # Device Class: Peripheral, Keyboard \u53e6\u5916 ref [2] \u662f\u4e00\u4e2a\u5728\u7ebf\u7684 CoD \u751f\u6210\u5668\uff0c\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u6839\u636e\u9009\u5b9a\u7684\u8bbe\u5907\u7c7b\u578b\u81ea\u52a8\u751f\u6210 CoD \u6570\u503c\u3002 References \u00b6 Assigned Numbers for Baseband Bluetooth Class of Device/Service (CoD) Generator BLUETOOTH CORE SPECIFICATION Version 5.1 | Vol 3, Part C page 2107, 3.2.4 Class of device","title":"Class of Device"},{"location":"wireless_security/bluetooth_security/base_intro/Class_of_Device/#cod","text":"CoD \u7684\u683c\u5f0f\u662f\u53ef\u53d8\u7684\uff0c\u5177\u4f53\u7684\u683c\u5f0f\u7531 Format Type \u5b57\u6bb5\u6307\u5b9a\u3002\u5176\u4e2d\u6700\u5e38\u89c1\u7684\u683c\u5f0f\u662f \"format #1\"\uff0c\u4e14\u5176\u4ed6\u683c\u5f0f\u6781\u5176\u7f55\u89c1\u3002\u6b64\u65f6 CoD \u662f\u4e00\u4e2a\u5927\u5c0f\u4e3a 3 bytes \u7684\u6570\u503c\uff0c\u5b83\u7684\u7ed3\u6784\u5982\u4e0b\u56fe\u6240\u793a\uff081 st byte \u4e3a\u6700\u9ad8\u5b57\u8282\uff09\uff1a \u4e0b\u9762\u5c06\u5206\u522b\u89e3\u91ca\u7ec4\u6210 CoD \u7684 3 \u4e2a\u4e3b\u8981\u5b57\u6bb5 Service Class, Major Device Class \u4e0e Minor Device Class\u3002","title":"\u89e3\u6790 CoD \u7ed3\u6784"},{"location":"wireless_security/bluetooth_security/base_intro/Class_of_Device/#service-class","text":"\u4e0b\u9762\u4e3a 0 \u7684\u4f4d\u88ab\u4fdd\u7559\u4f7f\u7528 Flag Description Example 1... .... 00. Information WEB-server, WAP-server .1.. .... 00. Telephony Cordless telephony, Modem, Headset service ..1. .... 00. Audio Speaker, Microphone, Headset service ...1 .... 00. Object Transfer v-Inbox, v-Folder .... 1... 00. Capturing Scanner, Microphone .... .1.. 00. Rendering Printing, Speaker .... ..1. 00. Networking LAN, Ad hoc .... ...1 00. Positioning Location identification .... .... 001 Limited Discoverable Mode","title":"Service Class"},{"location":"wireless_security/bluetooth_security/base_intro/Class_of_Device/#major-device-class","text":"Value Description Example 0b00000 Miscellaneous 0b00001 Computer Desktop, Notebook, PDA, Organizers 0b00010 Phone Cellular, Cordless, Payphone, Modem 0b00011 LAN /Network Access point 0b00100 Audio/Video Headset, Speaker, Stereo, Video display, VCR 0b00101 Peripheral (HID) Mouse, Joystick, Keyboards 0b00110 Imaging Printing, Scanner, Camera, Display 0b00111 Wearable 0b01000 Toy 0b01001 Health 0b11111 Uncategorized Others Reserved","title":"Major Device Class"},{"location":"wireless_security/bluetooth_security/base_intro/Class_of_Device/#minor-device-class","text":"\u8be5\u5b57\u6bb5\u867d\u7136\u4ec5\u5360\u7528 8 bits\uff0c\u4f46\u662f\u5f53 major device class \u4e0d\u540c\u65f6\uff0c\u6bcf\u4e2a bit \u7684\u542b\u4e49\u4e5f\u4e0d\u540c\u3002\u56e0\u6b64\u8be5\u5b57\u6bb5\u7684\u5b9a\u4e49\u5f88\u7e41\u6742\uff0c\u4e0d\u5728\u8fd9\u91cc\u8d58\u8ff0\u3002\u5177\u4f53\u53ef\u4ee5\u53c2\u8003 ref [1]\u3002","title":"Minor Device Class"},{"location":"wireless_security/bluetooth_security/base_intro/Class_of_Device/#cod_1","text":"\u5f53 CoD \u4e3a 0x002540 \u65f6\u6709\uff1a 0... .... .... .... .... .... = Service Classes: Information: False .0.. .... .... .... .... .... = Service Classes: Telephony: False ..0. .... .... .... .... .... = Service Classes: Audio: False ...0 .... .... .... .... .... = Service Classes: Object Transfer: False .... 0... .... .... .... .... = Service Classes: Capturing: False .... .0.. .... .... .... .... = Service Classes: Rendering: False .... ..0. .... .... .... .... = Service Classes: Networking: False .... ...0 .... .... .... .... = Service Classes: Positioning: False .... .... 00.. .... .... .... = Service Classes: Reserved: 0x0 .... .... ..1. .... .... .... = Service Classes: Limited Discoverable Mode: True .... .... ...0 0101 .... .... = Major Device Class: Peripheral (HID) (0x05) .... .... .... .... 01.. .... = Minor Device Class: Keyboard (0x1) .... .... .... .... ..00 00.. = Minor Device Class: Uncategorized device (0x0) .... .... .... .... .... ..00 = Format Type: 0x0","title":"\u4e00\u4e2a\u89e3\u6790 CoD \u7684\u4f8b\u5b50"},{"location":"wireless_security/bluetooth_security/base_intro/Class_of_Device/#cod_2","text":"CoD \u5e76\u4e0d\u662f\u5199\u6b7b\u5728 controller \u4e2d\u7684\u6570\u636e\uff0c\u5b9e\u9645\u4e0a\u5b83\u88ab host \u7ba1\u7406\u3002Host \u53ef\u4ee5\u4f7f\u7528 HCI_Write_Class_of_Device command \u4fee\u6539\u672c\u5730\u8bbe\u5907\u7684\u7c7b\u578b\uff0c\u4ece\u800c\u8fbe\u5230\u4f2a\u88c5\u7684\u76ee\u7684\u3002\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\u53ef\u4ee5\u8bfb\u53d6\u6216\u4fee\u6539\u672c\u5730 BR/EDR \u8bbe\u5907\u7684\u7c7b\u578b\uff1a hciconfig hci0 class # hci0: Type: Primary Bus: USB # BD Address: 11:22:33:44:55:19 ACL MTU: 310:10 SCO MTU: 64:8 # Class: 0x0c0000 # Service Classes: Rendering, Capturing # Device Class: Miscellaneous, sudo hciconfig hci0 class 0x002540 hciconfig hci0 class # hci0: Type: Primary Bus: USB # BD Address: 11:22:33:44:55:19 ACL MTU: 310:10 SCO MTU: 64:8 # Class: 0x002540 # Service Classes: Unspecified # Device Class: Peripheral, Keyboard \u53e6\u5916 ref [2] \u662f\u4e00\u4e2a\u5728\u7ebf\u7684 CoD \u751f\u6210\u5668\uff0c\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u6839\u636e\u9009\u5b9a\u7684\u8bbe\u5907\u7c7b\u578b\u81ea\u52a8\u751f\u6210 CoD \u6570\u503c\u3002","title":"CoD \u7684\u4f2a\u88c5"},{"location":"wireless_security/bluetooth_security/base_intro/Class_of_Device/#references","text":"Assigned Numbers for Baseband Bluetooth Class of Device/Service (CoD) Generator BLUETOOTH CORE SPECIFICATION Version 5.1 | Vol 3, Part C page 2107, 3.2.4 Class of device","title":"References"}]}